{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.0", "generated_at": "2026-01-31T04:31:32.608464Z", "invocation_id": "f88db288-db60-45ba-b53e-8355463cbc77", "invocation_started_at": "2026-01-31T04:31:31.118757Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.883692Z", "completed_at": "2026-01-31T04:31:31.894412Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.894936Z", "completed_at": "2026-01-31T04:31:31.894966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012505769729614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity", "compiled": true, "compiled_code": "\n\nWITH \n\ntransformed AS (\n                    SELECT \n                            activity_id,\n                            type,\n                            assigned_to_user,\n                            deal_id,\n                            done,\n                            CAST(due_to AS TIMESTAMP) AS due_to_dt,\n                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num \n\n                    FROM \"postgres\".\"public\".\"activity\"\n)\n\nSELECT \n       activity_id,\n       type,\n       assigned_to_user,\n       deal_id,\n       done,\n       due_to_dt\nFROM transformed\nWHERE row_num = 1", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.897668Z", "completed_at": "2026-01-31T04:31:31.902790Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.903313Z", "completed_at": "2026-01-31T04:31:31.903331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006963491439819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity_types", "compiled": true, "compiled_code": "\n\nWITH \n\ntransformed AS (\n                 SELECT \n                         id   AS activity_type_id,\n                         name,\n                         type,\n                         CASE \n                       \t\t WHEN name= 'Sales Call 1' THEN 'Step 2.1'\n                       \t\t WHEN name= 'Sales Call 2' THEN 'Step 3.1'\n                  \t     END \t\t\t\tAS funnel_step,\n                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active\n                            \n                  FROM \"postgres\".\"public\".\"activity_types\"\n)\n\nSELECT *\nFROM transformed", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.905864Z", "completed_at": "2026-01-31T04:31:31.909150Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.909656Z", "completed_at": "2026-01-31T04:31:31.909668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005068302154541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_changes", "compiled": true, "compiled_code": "\n\nWITH \n\ntransformed AS (\n                    SELECT \n                            deal_id,\n                            CAST(change_time AS TIMESTAMP) change_dt,\n                            changed_field_key,\n                            new_value,\n                            row_number() OVER (\n                                PARTITION BY deal_id, changed_field_key, new_value,  change_time) AS rn\n\n                    FROM \"postgres\".\"public\".\"deal_changes\"\n)\n\nSELECT \n      deal_id,\n      change_dt,\n      changed_field_key,\n      new_value\n\nFROM transformed\nWHERE rn = 1", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.912139Z", "completed_at": "2026-01-31T04:31:31.915368Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.915863Z", "completed_at": "2026-01-31T04:31:31.915874Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004989147186279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_fields", "compiled": true, "compiled_code": "\n\nWITH\n\nraw AS (\n        SELECT \n              id          AS field_id,\n              field_key,\n              name        AS field_name,\n              field_value_options\n\n        FROM \"postgres\".\"public\".\"fields\"\n)\n\n, base AS (\n            SELECT\n                  field_id,\n                  field_key,\n                  field_value_options\n                  \n            FROM raw\n            WHERE field_value_options IS NOT NULL\n)\n\n, exploded AS (\n                SELECT\n                      b.field_id,\n                      b.field_key,\n                      e.elem->>'id'    AS option_id,\n                      e.elem->>'label' AS option_label\n\n                FROM base b\n                CROSS JOIN lateral\n                    jsonb_array_elements(b.field_value_options) WITH ordinality AS e(elem, ord)\n)\n\n, transformed AS (\n                    SELECT\n                          r.field_id,\n                          r.field_key,\n                          r.field_name,\n                          CASE\n                              WHEN e.option_id ~ '^\\d+$' THEN e.option_id::int\n                              ELSE NULL\n                          END AS option_id,\n                          e.option_label\n                        \n                    FROM raw r\n                    LEFT JOIN exploded e    USING (field_id)\n)\nSELECT\n        *\nFROM transformed\nORDER BY field_id, \n         option_id", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_fields\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.919217Z", "completed_at": "2026-01-31T04:31:31.923500Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.924002Z", "completed_at": "2026-01-31T04:31:31.924013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006746530532836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_stages", "compiled": true, "compiled_code": "\n\nWITH \n\ntransformed AS (\n                    SELECT \n                            stage_id,\n                            stage_name,\n                            CASE \n\t                            WHEN stage_name= 'Lead Generation'              THEN 'Step 1'\n\t                            WHEN stage_name= 'Qualified lead'               THEN 'Step 2'\n\t                            WHEN stage_name= 'Needs Assessment'             THEN 'Step 3'\n\t                            WHEN stage_name= 'Proposal/Quote Preparation'   THEN 'Step 4'\n\t                            WHEN stage_name= 'Negotiation'                  THEN 'Step 5'\n\t                            WHEN stage_name= 'Closing'                      THEN 'Step 6'\n\t                            WHEN stage_name= 'Implementation/Onboarding'    THEN 'Step 7'\n\t                            WHEN stage_name= 'Follow-up/Customer Success'   THEN 'Step 8'\n\t                            WHEN stage_name= 'Renewal/Expansion'            THEN 'Step 9'\n                            END AS funnel_step\n\n                    FROM \"postgres\".\"public\".\"stages\"\n)\n\nSELECT *\nFROM transformed", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.926415Z", "completed_at": "2026-01-31T04:31:31.929531Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.930033Z", "completed_at": "2026-01-31T04:31:31.930044Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004820346832275391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.stg_users", "compiled": true, "compiled_code": "\n\nwith \n\ntransformed as (\n\n                SELECT \n                      id          as user_id,\n                      name        as user_name,\n                      email       as user_email,\n                      modified    as user_modified_at\n\n                FROM \"postgres\".\"public\".\"users\"\n)\n\nSELECT \n      *\nFROM transformed", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"stg_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.932483Z", "completed_at": "2026-01-31T04:31:31.933892Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.934370Z", "completed_at": "2026-01-31T04:31:31.934380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030884742736816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.enpal_assessment_project.funnel_steps", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.936599Z", "completed_at": "2026-01-31T04:31:31.947585Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.948151Z", "completed_at": "2026-01-31T04:31:31.948161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012613058090209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        done as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\n    group by done\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'True','False'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.950384Z", "completed_at": "2026-01-31T04:31:31.958586Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.959129Z", "completed_at": "2026-01-31T04:31:31.959139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009797096252441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.961437Z", "completed_at": "2026-01-31T04:31:31.965450Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.965978Z", "completed_at": "2026-01-31T04:31:31.965987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005633831024169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect assigned_to_user\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere assigned_to_user is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.968269Z", "completed_at": "2026-01-31T04:31:31.974019Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.974764Z", "completed_at": "2026-01-31T04:31:31.974775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00754857063293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.980698Z", "completed_at": "2026-01-31T04:31:31.986493Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.987003Z", "completed_at": "2026-01-31T04:31:31.987014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010555267333984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect done\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere done is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.989267Z", "completed_at": "2026-01-31T04:31:31.993128Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:31.993647Z", "completed_at": "2026-01-31T04:31:31.993657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005440711975097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect due_to_dt\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere due_to_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:31.995874Z", "completed_at": "2026-01-31T04:31:31.999884Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.000414Z", "completed_at": "2026-01-31T04:31:32.000425Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005586862564086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect type\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.002653Z", "completed_at": "2026-01-31T04:31:32.008823Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.009372Z", "completed_at": "2026-01-31T04:31:32.009382Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007782936096191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity\"\nwhere activity_id is not null\ngroup by activity_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.011633Z", "completed_at": "2026-01-31T04:31:32.014835Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.015359Z", "completed_at": "2026-01-31T04:31:32.015369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004800319671630859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_activites", "compiled": true, "compiled_code": "\n\nWITH \nbase AS (\n          SELECT \n                ac.activity_id,\n                ac.deal_id,\n                ac.type,\n                act.name,\n                act.funnel_step,\n                ac.assigned_to_user,\n                ac.due_to_dt,\n                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month\n                \n          FROM \"postgres\".\"pipedrive_analytics\".\"stg_activity\" ac\n          LEFT JOIN \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\" act ON ac.type = act.type\n          WHERE TRUE \n              AND ac.done\n              AND act.name IN ('Sales Call 1', 'Sales Call 2')\n)\n\nSELECT *\nFROM base", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_activites\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.017590Z", "completed_at": "2026-01-31T04:31:32.021472Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.022020Z", "completed_at": "2026-01-31T04:31:32.022030Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005522727966308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_active as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\n    group by is_active\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'True','False'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.024262Z", "completed_at": "2026-01-31T04:31:32.028137Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.028674Z", "completed_at": "2026-01-31T04:31:32.028684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005455970764160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere activity_type_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.030883Z", "completed_at": "2026-01-31T04:31:32.034833Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.035370Z", "completed_at": "2026-01-31T04:31:32.035380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005545139312744141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_active\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere is_active is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.037603Z", "completed_at": "2026-01-31T04:31:32.041686Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.042235Z", "completed_at": "2026-01-31T04:31:32.042245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005688190460205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.044435Z", "completed_at": "2026-01-31T04:31:32.049653Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.050187Z", "completed_at": "2026-01-31T04:31:32.050196Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0067996978759765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect type\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.052452Z", "completed_at": "2026-01-31T04:31:32.170480Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.171157Z", "completed_at": "2026-01-31T04:31:32.171172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11986160278320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    activity_type_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_activity_types\"\nwhere activity_type_id is not null\ngroup by activity_type_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.173663Z", "completed_at": "2026-01-31T04:31:32.187404Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.188047Z", "completed_at": "2026-01-31T04:31:32.188062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015596151351928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, change_dt, changed_field_key, new_value\n    from \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\n    group by deal_id, change_dt, changed_field_key, new_value\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.190494Z", "completed_at": "2026-01-31T04:31:32.194974Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.195586Z", "completed_at": "2026-01-31T04:31:32.195600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006215572357177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_dt\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere change_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.198070Z", "completed_at": "2026-01-31T04:31:32.202500Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.203048Z", "completed_at": "2026-01-31T04:31:32.203061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006237030029296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect changed_field_key\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere changed_field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.205354Z", "completed_at": "2026-01-31T04:31:32.209855Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.210441Z", "completed_at": "2026-01-31T04:31:32.210452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006160736083984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.212825Z", "completed_at": "2026-01-31T04:31:32.223197Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.223980Z", "completed_at": "2026-01-31T04:31:32.223993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012747764587402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_value\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\nwhere new_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.227269Z", "completed_at": "2026-01-31T04:31:32.232661Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.233217Z", "completed_at": "2026-01-31T04:31:32.233228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070383548736572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        field_id, option_id\n    from \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\n    group by field_id, option_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.235479Z", "completed_at": "2026-01-31T04:31:32.239547Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.240063Z", "completed_at": "2026-01-31T04:31:32.240073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0056400299072265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\nwhere field_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.242345Z", "completed_at": "2026-01-31T04:31:32.246493Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.247015Z", "completed_at": "2026-01-31T04:31:32.247025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0057525634765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_key\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\nwhere field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.249284Z", "completed_at": "2026-01-31T04:31:32.256747Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.257322Z", "completed_at": "2026-01-31T04:31:32.257333Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009109258651733398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect field_name\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_fields\"\nwhere field_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.259683Z", "completed_at": "2026-01-31T04:31:32.263579Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.264119Z", "completed_at": "2026-01-31T04:31:32.264130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0055544376373291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_stages", "compiled": true, "compiled_code": "\n\nWITH\nusers AS (\n\t\t\tSELECT \n\t\t\t\t  deal_id,\n\t\t\t\t   new_value :: INT AS user_id,\n\t\t\t\t   change_dt AS assigned_user_start,\n\t\t\t\t   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end\n\t\t\tFROM \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\"\n\t\t\tWHERE TRUE \n\t\t\t\tAND  changed_field_key= 'user_id'\n) \n, \nbase AS (\n         SELECT \n                dc.deal_id,\n                dc.change_dt,\n                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,\n                dc.new_value :: INT AS stage_id,\n                s.stage_name,\n                s.funnel_step,\n                u.user_id,\n                u.assigned_user_start,\n                u.assigned_user_end\n                   \n         FROM \"postgres\".\"pipedrive_analytics\".\"stg_deal_changes\" dc\n         LEFT JOIN \"postgres\".\"pipedrive_analytics\".\"stg_stages\" s       ON dc.new_value = CAST(s.stage_id AS TEXT)\n         LEFT JOIN users u                       ON dc.deal_id = u.deal_id \n\t\t\t\t\t                                AND dc.change_dt >= u.assigned_user_start\n\t\t\t\t\t                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)\n         WHERE TRUE \n            AND dc.changed_field_key= 'stage_id'\n)\n\nSELECT \n      *\nFROM base", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.266688Z", "completed_at": "2026-01-31T04:31:32.271668Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.272394Z", "completed_at": "2026-01-31T04:31:32.272406Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007050514221191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_stages\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.276082Z", "completed_at": "2026-01-31T04:31:32.283162Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.283937Z", "completed_at": "2026-01-31T04:31:32.283950Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009544849395751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.287481Z", "completed_at": "2026-01-31T04:31:32.294212Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.294939Z", "completed_at": "2026-01-31T04:31:32.294952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009165763854980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_name\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_stages\"\nwhere stage_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.298490Z", "completed_at": "2026-01-31T04:31:32.305643Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.306581Z", "completed_at": "2026-01-31T04:31:32.306593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009795665740966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_stages\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.310182Z", "completed_at": "2026-01-31T04:31:32.317169Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.317965Z", "completed_at": "2026-01-31T04:31:32.317977Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009541749954223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_email\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_email is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.321545Z", "completed_at": "2026-01-31T04:31:32.328555Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.329337Z", "completed_at": "2026-01-31T04:31:32.329349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009584188461303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.332888Z", "completed_at": "2026-01-31T04:31:32.339834Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.340635Z", "completed_at": "2026-01-31T04:31:32.340647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009418010711669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_modified_at\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_modified_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.344213Z", "completed_at": "2026-01-31T04:31:32.350793Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.351576Z", "completed_at": "2026-01-31T04:31:32.351588Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00905752182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_name\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.355120Z", "completed_at": "2026-01-31T04:31:32.364402Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.365175Z", "completed_at": "2026-01-31T04:31:32.365187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011726617813110352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"pipedrive_analytics\".\"stg_users\"\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.368751Z", "completed_at": "2026-01-31T04:31:32.373987Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.374788Z", "completed_at": "2026-01-31T04:31:32.374800Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007696390151977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_stages_anmly", "compiled": true, "compiled_code": "\n\nWITH \nstages AS (\n\t\t\tSELECT \n\t\t\t\t  *,\n\t\t\t\t  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,\n\t\t\t\t  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,\n\t\t\t\t  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn\n\t\t\t\t  \n\t\t\tFROM \"postgres\".\"pipedrive_analytics\".\"int_stages\" \t\t\t\n)\n\n, stages_anmly AS (\n\t\t\t\t\tSELECT \n\t\t\t\t\t\t   *,\n\t\t\t\t\t\t   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg\n\t\t\t\t\t\t\t\t\n\t\t\t\t\tFROM stages\n)\n\nSELECT *\nFROM stages_anmly", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_stages_anmly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.378705Z", "completed_at": "2026-01-31T04:31:32.383805Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.384380Z", "completed_at": "2026-01-31T04:31:32.384390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007508993148803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, change_dt, stage_id\n    from \"postgres\".\"pipedrive_analytics\".\"int_stages\"\n    group by deal_id, change_dt, stage_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.386595Z", "completed_at": "2026-01-31T04:31:32.390468Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.391001Z", "completed_at": "2026-01-31T04:31:32.391011Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00548553466796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_dt\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages\"\nwhere change_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.393226Z", "completed_at": "2026-01-31T04:31:32.397123Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.397661Z", "completed_at": "2026-01-31T04:31:32.397671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005494117736816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.399965Z", "completed_at": "2026-01-31T04:31:32.404050Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.404622Z", "completed_at": "2026-01-31T04:31:32.404632Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005702018737792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.406845Z", "completed_at": "2026-01-31T04:31:32.410691Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.411247Z", "completed_at": "2026-01-31T04:31:32.411257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005450248718261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.413462Z", "completed_at": "2026-01-31T04:31:32.417322Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.417854Z", "completed_at": "2026-01-31T04:31:32.417864Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005411863327026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.420008Z", "completed_at": "2026-01-31T04:31:32.423941Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.424502Z", "completed_at": "2026-01-31T04:31:32.424511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005513668060302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_name\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages\"\nwhere stage_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.426711Z", "completed_at": "2026-01-31T04:31:32.430109Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.430636Z", "completed_at": "2026-01-31T04:31:32.430647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004950284957885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_sales_funnel", "compiled": true, "compiled_code": "\n\nWITH \nactivities AS (\n\t\t   \t\tSELECT \n\t\t\t\t   \t   deal_id,\n\t\t\t\t\t   name\t\t\t\tAS kpi_name,\n\t\t\t\t\t   funnel_step,\n\t\t\t\t\t   assigned_to_user AS user_id,\n\t\t\t\t\t   due_to_dt\t\tAS change_dt,\n\t\t\t\t\t   month,\n\t\t\t\t\t   0 \t\t\t\tAS anmly_flg\n\t\t   \t\t\n\t\t\t\tFROM \"postgres\".\"pipedrive_analytics\".\"int_activites\"\n)\n, stages AS (\n\t\t\t  SELECT \n\t\t\t  \t\t deal_id,\n\t\t\t  \t\t stage_name\t\t\tAS kpi_name,\n\t\t\t\t\t funnel_step,\n\t\t\t\t\t user_id,\n\t\t\t\t\t change_dt,\n\t\t\t\t\t month,\n\t\t\t\t\t anmly_flg\n\t\t\t  FROM \"postgres\".\"pipedrive_analytics\".\"int_stages_anmly\"\n)\n\n,stg_funnel AS ( \n\t\t\t    SELECT * FROM activities \n\t\t\t    UNION ALL\n\t\t\t    SELECT * FROM stages\n)\n\n, int_funnel AS (\n\t\t\t\t  SELECT *,\n\t\t\t\t\t\t LAG(funnel_step) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,\n\t\t\t\t\t\t LAG(user_id)     OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user\n\t\t\t\t\t\t   \n\t\t\t\t  FROM stg_funnel\n)\n\n, final_funnel AS (\n\t\t\t\t\tSELECT *,\n\t\t\t\t\t\t   CASE \n\t\t\t\t\t\t   \t\tWHEN funnel_step= 'Step 2.1' AND COALESCE(prev_step, 'n') <> 'Step 2' AND user_id = prev_user THEN 1\n\t\t\t\t\t\t   \t\tWHEN funnel_step= 'Step 3.1' AND COALESCE(prev_step, 'n') <> 'Step 3' AND user_id = prev_user THEN 1\n\t\t\t\t\t\t\t\tELSE anmly_flg\n\t\t\t\t\t\t   END AS funnel_anmly_flg\n\t\t\t\t\tFROM int_funnel \n)\n\nSELECT *\nFROM final_funnel", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.434735Z", "completed_at": "2026-01-31T04:31:32.438576Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.439160Z", "completed_at": "2026-01-31T04:31:32.439170Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007281780242919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        anmly_flg as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"pipedrive_analytics\".\"int_stages_anmly\"\n    group by anmly_flg\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.441361Z", "completed_at": "2026-01-31T04:31:32.445262Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.445818Z", "completed_at": "2026-01-31T04:31:32.445829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005497455596923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect anmly_flg\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages_anmly\"\nwhere anmly_flg is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.448029Z", "completed_at": "2026-01-31T04:31:32.452155Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.452697Z", "completed_at": "2026-01-31T04:31:32.452707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005692481994628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect rn\nfrom \"postgres\".\"pipedrive_analytics\".\"int_stages_anmly\"\nwhere rn is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.454963Z", "completed_at": "2026-01-31T04:31:32.458205Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.458740Z", "completed_at": "2026-01-31T04:31:32.458750Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0048675537109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.int_step_month_matrix", "compiled": true, "compiled_code": "\n\nWITH\nall_unique_steps AS (\n                      SELECT\n                          kpi_name,\n                          funnel_step,\n                          step_order\n                      FROM \"postgres\".\"pipedrive_analytics\".\"funnel_steps\"\n)\n\n, all_months AS (\n                    SELECT DISTINCT month \n                    FROM \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\n                )\n\n, month_step_matrix AS (\n                         SELECT\n                               m.month,\n                               s.kpi_name,\n                               s.funnel_step\n                         FROM all_months m\n                         CROSS JOIN all_unique_steps s\n                       )\n\nSELECT *\nFROM month_step_matrix", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.461239Z", "completed_at": "2026-01-31T04:31:32.465286Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.465836Z", "completed_at": "2026-01-31T04:31:32.465846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005796670913696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        funnel_anmly_flg as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\n    group by funnel_anmly_flg\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.468108Z", "completed_at": "2026-01-31T04:31:32.476878Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.477485Z", "completed_at": "2026-01-31T04:31:32.477497Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010479927062988281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        deal_id, change_dt, kpi_name, funnel_step, user_id\n    from \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\n    group by deal_id, change_dt, kpi_name, funnel_step, user_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.479798Z", "completed_at": "2026-01-31T04:31:32.483785Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.484349Z", "completed_at": "2026-01-31T04:31:32.484359Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005635499954223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_dt\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere change_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.486556Z", "completed_at": "2026-01-31T04:31:32.490475Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.491030Z", "completed_at": "2026-01-31T04:31:32.491039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005554914474487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.493265Z", "completed_at": "2026-01-31T04:31:32.497432Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.498004Z", "completed_at": "2026-01-31T04:31:32.498014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0057795047760009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_anmly_flg\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere funnel_anmly_flg is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.500293Z", "completed_at": "2026-01-31T04:31:32.505574Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.506137Z", "completed_at": "2026-01-31T04:31:32.506147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006921529769897461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.508350Z", "completed_at": "2026-01-31T04:31:32.512216Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.512781Z", "completed_at": "2026-01-31T04:31:32.512791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005503654479980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.515017Z", "completed_at": "2026-01-31T04:31:32.518970Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.519514Z", "completed_at": "2026-01-31T04:31:32.519525Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005522489547729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.521917Z", "completed_at": "2026-01-31T04:31:32.526487Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.527297Z", "completed_at": "2026-01-31T04:31:32.527308Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0065577030181884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.531243Z", "completed_at": "2026-01-31T04:31:32.534963Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.535518Z", "completed_at": "2026-01-31T04:31:32.535528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006116151809692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.enpal_assessment_project.rep_sales_funnel_monthly", "compiled": true, "compiled_code": "\n\nWITH\nmonthly_data AS (\n                    SELECT\n                           month,\n                           kpi_name,\n                           funnel_step,\n                           COUNT(DISTINCT deal_id) AS deals_count\n                           \n                    FROM \"postgres\".\"pipedrive_analytics\".\"int_sales_funnel\"\n                    WHERE funnel_anmly_flg = 0\n                    GROUP BY \n                             month, \n                             kpi_name, \n                             funnel_step\n)\n\n, final AS (\n             SELECT\n                    ms.month,\n                    ms.kpi_name,\n                    ms.funnel_step,\n                    COALESCE(a.deals_count, 0) AS deals_count\n\n             FROM \"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\" ms\n             LEFT JOIN monthly_data a            ON ms.month = a.month\n                                                    AND ms.kpi_name = a.kpi_name\n                                                    AND ms.funnel_step = a.funnel_step\n\n                               \n           )\nSELECT \n        month,\n        kpi_name,\n        funnel_step,\n        deals_count\n        \nFROM final", "relation_name": "\"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.538059Z", "completed_at": "2026-01-31T04:31:32.547661Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.548259Z", "completed_at": "2026-01-31T04:31:32.548271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011481761932373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        funnel_step as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\"\n    group by funnel_step\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Step 1','Step 2','Step 2.1','Step 3','Step 3.1','Step 4','Step 5','Step 6','Step 7','Step 8','Step 9'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.550561Z", "completed_at": "2026-01-31T04:31:32.555470Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.556047Z", "completed_at": "2026-01-31T04:31:32.556058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006548404693603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        month, funnel_step\n    from \"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\"\n    group by month, funnel_step\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.558311Z", "completed_at": "2026-01-31T04:31:32.562321Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.562878Z", "completed_at": "2026-01-31T04:31:32.562889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005613565444946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.565160Z", "completed_at": "2026-01-31T04:31:32.569126Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.569679Z", "completed_at": "2026-01-31T04:31:32.569689Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005608797073364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.571924Z", "completed_at": "2026-01-31T04:31:32.575927Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.576492Z", "completed_at": "2026-01-31T04:31:32.576502Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005613088607788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"pipedrive_analytics\".\"int_step_month_matrix\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.578767Z", "completed_at": "2026-01-31T04:31:32.584644Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.585237Z", "completed_at": "2026-01-31T04:31:32.585248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007536649703979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        month, kpi_name\n    from \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\n    group by month, kpi_name\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.587464Z", "completed_at": "2026-01-31T04:31:32.591368Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.591932Z", "completed_at": "2026-01-31T04:31:32.591943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005521059036254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.594223Z", "completed_at": "2026-01-31T04:31:32.598250Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.598802Z", "completed_at": "2026-01-31T04:31:32.598813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0056536197662353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-31T04:31:32.601072Z", "completed_at": "2026-01-31T04:31:32.605179Z"}, {"name": "execute", "started_at": "2026-01-31T04:31:32.605922Z", "completed_at": "2026-01-31T04:31:32.605933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005917549133300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"pipedrive_analytics\".\"rep_sales_funnel_monthly\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.8226978778839111, "args": {"log_level_file": "debug", "print": true, "select": [], "profiles_dir": "/workspaces/dbt_enpal_assessment_mahmoud", "partial_parse": true, "state_modified_compare_vars": false, "write_json": true, "strict_mode": false, "introspect": true, "use_colors": true, "require_resource_names_without_spaces": true, "upload_to_artifacts_ingest_api": false, "send_anonymous_usage_stats": true, "favor_state": false, "log_level": "info", "populate_cache": true, "log_file_max_bytes": 10485760, "require_all_warnings_handled_by_warn_error": false, "use_fast_test_edges": false, "macro_debugging": false, "invocation_command": "dbt docs generate", "show_resource_report": false, "cache_selected_only": false, "validate_macro_args": false, "printer_width": 80, "state_modified_compare_more_unrendered_values": false, "exclude": [], "warn_error_options": {"error": [], "warn": [], "silence": []}, "which": "generate", "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": true, "indirect_selection": "eager", "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "log_path": "/workspaces/dbt_enpal_assessment_mahmoud/logs", "project_dir": "/workspaces/dbt_enpal_assessment_mahmoud", "log_format": "default", "compile": true, "require_nested_cumulative_type_params": false, "static_parser": true, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "partial_parse_file_diff": true, "use_colors_file": true, "quiet": false, "show_all_deprecations": false, "static": false, "version_check": true, "skip_nodes_if_on_run_start_fails": false, "vars": {}, "empty_catalog": false}}