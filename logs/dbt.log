[0m23:25:17.456695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7660f6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a763cfa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a763d1dee0>]}


============================== 23:25:17.461223 | 47d4ad2f-da8f-4929-9610-8780f21f50e5 ==============================
[0m23:25:17.461223 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:25:17.462003 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'invocation_command': 'dbt debug', 'debug': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'None', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m23:25:17.471947 [info ] [MainThread]: dbt version: 1.11.2
[0m23:25:17.472469 [info ] [MainThread]: python version: 3.12.1
[0m23:25:17.472974 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m23:25:17.473439 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m23:25:17.523141 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m23:25:17.524023 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m23:25:17.524754 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m23:25:17.525697 [info ] [MainThread]: adapter type: postgres
[0m23:25:17.526381 [info ] [MainThread]: adapter version: 1.10.0
[0m23:25:17.646119 [info ] [MainThread]: Configuration:
[0m23:25:17.646767 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:25:17.647306 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:25:17.647800 [info ] [MainThread]: Required dependencies:
[0m23:25:17.648319 [debug] [MainThread]: Executing "git --help"
[0m23:25:17.651379 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:25:17.651937 [debug] [MainThread]: STDERR: "b''"
[0m23:25:17.652382 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:25:17.653430 [info ] [MainThread]: Connection:
[0m23:25:17.654480 [info ] [MainThread]:   host: localhost
[0m23:25:17.655308 [info ] [MainThread]:   port: 5432
[0m23:25:17.656038 [info ] [MainThread]:   user: admin
[0m23:25:17.656843 [info ] [MainThread]:   database: postgres
[0m23:25:17.657538 [info ] [MainThread]:   schema: analytics
[0m23:25:17.658266 [info ] [MainThread]:   connect_timeout: 10
[0m23:25:17.658753 [info ] [MainThread]:   role: None
[0m23:25:17.659276 [info ] [MainThread]:   search_path: None
[0m23:25:17.660193 [info ] [MainThread]:   keepalives_idle: 0
[0m23:25:17.661167 [info ] [MainThread]:   sslmode: None
[0m23:25:17.661633 [info ] [MainThread]:   sslcert: None
[0m23:25:17.662127 [info ] [MainThread]:   sslkey: None
[0m23:25:17.662579 [info ] [MainThread]:   sslrootcert: None
[0m23:25:17.663137 [info ] [MainThread]:   application_name: dbt
[0m23:25:17.663623 [info ] [MainThread]:   retries: 1
[0m23:25:17.664379 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:25:17.763105 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:25:17.783725 [debug] [MainThread]: Using postgres connection "debug"
[0m23:25:17.784298 [debug] [MainThread]: On debug: select 1 as id
[0m23:25:17.784728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:17.801386 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m23:25:17.802519 [debug] [MainThread]: On debug: Close
[0m23:25:17.803086 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:25:17.803944 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:25:17.805865 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4113428, "process_in_blocks": "368", "process_kernel_time": 0.139812, "process_mem_max_rss": "117188", "process_out_blocks": "24", "process_user_time": 1.663767}
[0m23:25:17.806491 [debug] [MainThread]: Command `dbt debug` succeeded at 23:25:17.806381 after 0.41 seconds
[0m23:25:17.806997 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:25:17.807475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76463a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7664c6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a764a54320>]}
[0m23:25:17.808016 [debug] [MainThread]: Flushing usage events
[0m23:25:18.199280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:30.961222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a1e74ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a3d9a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a33d54f0>]}


============================== 23:31:30.966286 | 8b93e5de-781e-44ca-a187-e72334528bd5 ==============================
[0m23:31:30.966286 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:31:30.967423 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'empty': 'None', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m23:31:30.980646 [info ] [MainThread]: dbt version: 1.11.2
[0m23:31:30.981574 [info ] [MainThread]: python version: 3.12.1
[0m23:31:30.982351 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m23:31:30.983245 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m23:31:31.040553 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m23:31:31.041257 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m23:31:31.042035 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m23:31:31.042953 [info ] [MainThread]: adapter type: postgres
[0m23:31:31.043668 [info ] [MainThread]: adapter version: 1.10.0
[0m23:31:31.181831 [info ] [MainThread]: Configuration:
[0m23:31:31.182494 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:31:31.183046 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:31:31.183532 [info ] [MainThread]: Required dependencies:
[0m23:31:31.184048 [debug] [MainThread]: Executing "git --help"
[0m23:31:31.186156 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:31:31.186648 [debug] [MainThread]: STDERR: "b''"
[0m23:31:31.187209 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:31:31.187710 [info ] [MainThread]: Connection:
[0m23:31:31.188299 [info ] [MainThread]:   host: localhost
[0m23:31:31.189013 [info ] [MainThread]:   port: 5432
[0m23:31:31.189690 [info ] [MainThread]:   user: admin
[0m23:31:31.190388 [info ] [MainThread]:   database: postgres
[0m23:31:31.191059 [info ] [MainThread]:   schema: pipedrive_analytics
[0m23:31:31.191532 [info ] [MainThread]:   connect_timeout: 10
[0m23:31:31.192100 [info ] [MainThread]:   role: None
[0m23:31:31.192570 [info ] [MainThread]:   search_path: None
[0m23:31:31.193122 [info ] [MainThread]:   keepalives_idle: 0
[0m23:31:31.193813 [info ] [MainThread]:   sslmode: None
[0m23:31:31.194502 [info ] [MainThread]:   sslcert: None
[0m23:31:31.195172 [info ] [MainThread]:   sslkey: None
[0m23:31:31.195886 [info ] [MainThread]:   sslrootcert: None
[0m23:31:31.196540 [info ] [MainThread]:   application_name: dbt
[0m23:31:31.197178 [info ] [MainThread]:   retries: 1
[0m23:31:31.197823 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:31:31.300056 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:31:31.319603 [debug] [MainThread]: Using postgres connection "debug"
[0m23:31:31.320164 [debug] [MainThread]: On debug: select 1 as id
[0m23:31:31.320615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:31.331448 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m23:31:31.332490 [debug] [MainThread]: On debug: Close
[0m23:31:31.333022 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:31:31.334563 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:31:31.335902 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4506676, "process_in_blocks": "0", "process_kernel_time": 0.142359, "process_mem_max_rss": "117152", "process_out_blocks": "24", "process_user_time": 1.728225}
[0m23:31:31.336501 [debug] [MainThread]: Command `dbt debug` succeeded at 23:31:31.336396 after 0.45 seconds
[0m23:31:31.336970 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:31:31.337443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a0781910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a14b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a16c0ec0>]}
[0m23:31:31.337966 [debug] [MainThread]: Flushing usage events
[0m23:31:31.717590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:37.651089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead53e6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead5385670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead523f800>]}


============================== 23:31:37.654477 | 0d6592e9-dab5-4cc4-93f7-00ca11287703 ==============================
[0m23:31:37.654477 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:31:37.655341 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt parse', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True'}
[0m23:31:37.878460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead54142c0>]}
[0m23:31:37.954411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead523fec0>]}
[0m23:31:37.955393 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:31:38.110255 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:31:38.278355 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:31:38.279075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead2f8f200>]}
[0m23:31:39.292026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project.marts
- models.enpal_assessment_project.staging
[0m23:31:39.302939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead37388c0>]}
[0m23:31:39.306814 [info ] [MainThread]: Performance info: /workspaces/dbt_enpal_assessment_mahmoud/target/perf_info.json
[0m23:31:39.374941 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:31:39.382461 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:31:39.384445 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.7900465, "process_in_blocks": "120", "process_kernel_time": 0.16095, "process_mem_max_rss": "118112", "process_out_blocks": "1792", "process_user_time": 2.890674}
[0m23:31:39.385409 [debug] [MainThread]: Command `dbt parse` succeeded at 23:31:39.385251 after 1.79 seconds
[0m23:31:39.386248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead6b19820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead436c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead2bf2e40>]}
[0m23:31:39.387064 [debug] [MainThread]: Flushing usage events
[0m23:31:39.740923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:31.823257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fd8c4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fdbc6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fda04800>]}


============================== 23:32:31.826485 | 1aa96adc-a7a9-483b-9846-fb5586748e4f ==============================
[0m23:32:31.826485 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:32:31.827406 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud'}
[0m23:32:32.006771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fd052090>]}
[0m23:32:32.072073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1ffb3eae0>]}
[0m23:32:32.073056 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:32:32.173495 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:32:32.256063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:32.256575 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:32:32.257025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:32.262012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project.marts
- models.enpal_assessment_project.staging
[0m23:32:32.292180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fc556c30>]}
[0m23:32:32.370070 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:32:32.372421 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:32:32.386129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fbdac9b0>]}
[0m23:32:32.386718 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:32:32.387281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fde6a0c0>]}
[0m23:32:32.389071 [info ] [MainThread]: 
[0m23:32:32.389591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:32.390078 [info ] [MainThread]: 
[0m23:32:32.390746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:32.391737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:32:32.423112 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:32:32.423648 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:32:32.424117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:32.433238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:32:32.434619 [debug] [ThreadPool]: On list_postgres: Close
[0m23:32:32.435533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_analytics_pipedrive_analytics)
[0m23:32:32.436422 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_analytics_pipedrive_analytics"
"
[0m23:32:32.442048 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.442501 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_analytics_pipedrive_analytics"} */
create schema if not exists "pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.442945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:32.456013 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.013 seconds
[0m23:32:32.457183 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: COMMIT
[0m23:32:32.457646 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.458115 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: COMMIT
[0m23:32:32.465327 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m23:32:32.466056 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: Close
[0m23:32:32.470063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_analytics_pipedrive_analytics, now list_postgres_pipedrive_analytics_pipedrive_analytics)
[0m23:32:32.476346 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.476859 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics_pipedrive_analytics'
  
[0m23:32:32.477294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:32.488870 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:32:32.490215 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics_pipedrive_analytics: ROLLBACK
[0m23:32:32.490864 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics_pipedrive_analytics: Close
[0m23:32:32.495444 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:32.495987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:32:32.496456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:32.517528 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m23:32:32.518833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fa9ece60>]}
[0m23:32:32.519396 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:32.520021 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.520470 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:32.520911 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.521588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:32.522057 [debug] [MainThread]: On master: Close
[0m23:32:32.524772 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:32:32.525448 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics_pipedrive_analytics.test_model . [RUN]
[0m23:32:32.526136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m23:32:32.526639 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:32:32.536194 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:32:32.536997 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:32:32.573973 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:32:32.574895 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.575441 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m23:32:32.576002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:32.600082 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m23:32:32.606722 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.607382 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:32:32.610589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:32:32.630743 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:32:32.631303 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.631801 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:32:32.633883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:32:32.639993 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_backup"
[0m23:32:32.645100 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.645618 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop view if exists "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:32:32.647899 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:32:32.650401 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:32:32.652916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1ffa66870>]}
[0m23:32:32.653969 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics_pipedrive_analytics.test_model  [[32mCREATE VIEW[0m in 0.13s]
[0m23:32:32.654781 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:32:32.656023 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.656469 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:32.656922 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.657317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:32.665836 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m23:32:32.666312 [debug] [MainThread]: On master: Close
[0m23:32:32.666957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:32.667593 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:32:32.668348 [info ] [MainThread]: 
[0m23:32:32.669042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:32:32.669910 [debug] [MainThread]: Command end result
[0m23:32:32.690188 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:32:32.691810 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:32:32.699472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:32:32.699934 [info ] [MainThread]: 
[0m23:32:32.700533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:32.701025 [info ] [MainThread]: 
[0m23:32:32.701556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:32.702570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9375014, "process_in_blocks": "128", "process_kernel_time": 0.154271, "process_mem_max_rss": "124620", "process_out_blocks": "1840", "process_user_time": 2.132928}
[0m23:32:32.703218 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:32.703109 after 0.94 seconds
[0m23:32:32.703679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fd12e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fb907e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fda04800>]}
[0m23:32:32.704194 [debug] [MainThread]: Flushing usage events
[0m23:32:33.089298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:26.717293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc567dd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc567ddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc56a6fb00>]}


============================== 23:35:26.720531 | 172bfe4f-bcf9-4a5c-9143-9fecfeb84148 ==============================
[0m23:35:26.720531 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:35:26.721400 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'no_print': 'None'}
[0m23:35:26.896551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc5553b080>]}
[0m23:35:26.965331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc56396db0>]}
[0m23:35:26.966296 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:35:27.063223 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:35:27.164220 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:35:27.164935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc549a86b0>]}
[0m23:35:28.202386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project.staging
- models.enpal_assessment_project.marts
[0m23:35:28.212812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc555d88c0>]}
[0m23:35:28.276197 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:35:28.278419 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:35:28.291250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc555a8b90>]}
[0m23:35:28.291859 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:35:28.292417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc541fdc40>]}
[0m23:35:28.294233 [info ] [MainThread]: 
[0m23:35:28.294781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:28.295287 [info ] [MainThread]: 
[0m23:35:28.295977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:28.296987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:35:28.329339 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:35:28.329919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:35:28.330401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:28.341907 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m23:35:28.343387 [debug] [ThreadPool]: On list_postgres: Close
[0m23:35:28.344504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m23:35:28.345365 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m23:35:28.351077 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m23:35:28.351574 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m23:35:28.352024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:28.359124 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m23:35:28.360188 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m23:35:28.360682 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m23:35:28.361115 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m23:35:28.370207 [debug] [ThreadPool]: SQL status: COMMIT in 0.009 seconds
[0m23:35:28.370670 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m23:35:28.372185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m23:35:28.378538 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:35:28.379169 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m23:35:28.379600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:28.390266 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m23:35:28.391585 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m23:35:28.392218 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m23:35:28.398417 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:28.398981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:35:28.399490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:28.408494 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m23:35:28.409831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc528cb110>]}
[0m23:35:28.410422 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:28.411045 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.411517 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:28.412011 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.412685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:28.413146 [debug] [MainThread]: On master: Close
[0m23:35:28.415633 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:35:28.416495 [info ] [Thread-1 (]: 1 of 1 START sql view model public_pipedrive_analytics.test_model .............. [RUN]
[0m23:35:28.417199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m23:35:28.417705 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:35:28.426884 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:35:28.428511 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:35:28.490291 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:35:28.491549 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.492379 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m23:35:28.493185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:28.506969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:35:28.513713 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.514287 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:35:28.515167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:28.528609 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:35:28.529165 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.529655 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:35:28.531951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:28.538087 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m23:35:28.543221 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.543745 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop view if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:35:28.544551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:35:28.546989 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:35:28.549252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc58a72870>]}
[0m23:35:28.550217 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_pipedrive_analytics.test_model ......... [[32mCREATE VIEW[0m in 0.13s]
[0m23:35:28.551065 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:35:28.552293 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.552772 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:28.553231 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.553637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:28.561929 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m23:35:28.562440 [debug] [MainThread]: On master: Close
[0m23:35:28.563061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:28.563725 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:35:28.564400 [info ] [MainThread]: 
[0m23:35:28.565109 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m23:35:28.566057 [debug] [MainThread]: Command end result
[0m23:35:28.588677 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:35:28.591667 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:35:28.600739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:35:28.601477 [info ] [MainThread]: 
[0m23:35:28.602485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:28.603916 [info ] [MainThread]: 
[0m23:35:28.604991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:35:28.606639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9479434, "process_in_blocks": "0", "process_kernel_time": 0.170661, "process_mem_max_rss": "128112", "process_out_blocks": "2720", "process_user_time": 3.106844}
[0m23:35:28.607618 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:28.607440 after 1.95 seconds
[0m23:35:28.608224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc56488fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc5673e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc5633f590>]}
[0m23:35:28.608986 [debug] [MainThread]: Flushing usage events
[0m23:35:29.019378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:10.942826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1966eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1a292930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1a84e2a0>]}


============================== 23:38:10.946219 | 96586b0b-e4c1-4a78-9140-ecf0decb0d38 ==============================
[0m23:38:10.946219 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:38:10.947288 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m23:38:11.117276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1850b410>]}
[0m23:38:11.182120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac18fdf3b0>]}
[0m23:38:11.183103 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:38:11.281452 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:38:11.356006 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:38:11.356694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac18d87cb0>]}
[0m23:38:12.365852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac16fab890>]}
[0m23:38:12.426938 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:38:12.428838 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:38:12.442400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac16b99ee0>]}
[0m23:38:12.443411 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:38:12.444221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac17771070>]}
[0m23:38:12.446700 [info ] [MainThread]: 
[0m23:38:12.447405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:12.448031 [info ] [MainThread]: 
[0m23:38:12.448872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:12.450370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:38:12.495691 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:38:12.496692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:38:12.497508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:12.532077 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m23:38:12.537778 [debug] [ThreadPool]: On list_postgres: Close
[0m23:38:12.539835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m23:38:12.550152 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:38:12.551049 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:38:12.551877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:12.567668 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m23:38:12.570276 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:38:12.571238 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:38:12.581647 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:12.582578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:38:12.583442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:12.600248 [debug] [MainThread]: SQL status: SELECT 2 in 0.017 seconds
[0m23:38:12.603534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1774c470>]}
[0m23:38:12.604429 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:12.605366 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.606126 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:12.606870 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.607755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:38:12.608492 [debug] [MainThread]: On master: Close
[0m23:38:12.613513 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:38:12.614563 [info ] [Thread-1 (]: 1 of 1 START sql table model public.test_model ................................. [RUN]
[0m23:38:12.615507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.enpal_assessment_project.test_model)
[0m23:38:12.616319 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:38:12.630026 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:38:12.631483 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:38:12.684739 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:38:12.686440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.687374 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:38:12.688293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:12.713011 [debug] [Thread-1 (]: SQL status: SELECT 9158 in 0.025 seconds
[0m23:38:12.732512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.733420 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public"."test_model__dbt_tmp" rename to "test_model"
[0m23:38:12.734867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:38:12.758736 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:38:12.759650 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.760508 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:38:12.770883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:38:12.781126 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."test_model__dbt_backup"
[0m23:38:12.789531 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.790383 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public"."test_model__dbt_backup" cascade
[0m23:38:12.796190 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:38:12.802547 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:38:12.805245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1b02abd0>]}
[0m23:38:12.812055 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.test_model ............................ [[32mSELECT 9158[0m in 0.19s]
[0m23:38:12.813217 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:38:12.815255 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.816198 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:12.817198 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.818700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:12.830094 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m23:38:12.830817 [debug] [MainThread]: On master: Close
[0m23:38:12.831654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:12.834385 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:38:12.835139 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:38:12.838105 [info ] [MainThread]: 
[0m23:38:12.838885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:38:12.841269 [debug] [MainThread]: Command end result
[0m23:38:12.879834 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:38:12.884424 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:38:12.901360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:38:12.904277 [info ] [MainThread]: 
[0m23:38:12.905135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:12.907433 [info ] [MainThread]: 
[0m23:38:12.909770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:38:12.911610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0592227, "process_in_blocks": "0", "process_kernel_time": 0.165818, "process_mem_max_rss": "128428", "process_out_blocks": "2720", "process_user_time": 3.188471}
[0m23:38:12.912553 [debug] [MainThread]: Command `dbt run` succeeded at 23:38:12.912390 after 2.06 seconds
[0m23:38:12.915081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac18954ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1b27ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac17b5fda0>]}
[0m23:38:12.916064 [debug] [MainThread]: Flushing usage events
[0m23:38:13.331706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:26.465014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c3400ecdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f2612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c3400ed0a0>]}


============================== 23:39:26.468325 | 5dd10940-421f-486c-b94f-4d55b4c6711c ==============================
[0m23:39:26.468325 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:39:26.469173 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False'}
[0m23:39:26.631672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c3400ed070>]}
[0m23:39:26.697243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c34005a090>]}
[0m23:39:26.698181 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:39:26.798593 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:39:26.886587 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:39:26.887395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f98fe00>]}
[0m23:39:27.904915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f22b980>]}
[0m23:39:27.971931 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:39:27.974376 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:39:27.987229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33d7a14f0>]}
[0m23:39:27.987841 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:39:27.988405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33d331790>]}
[0m23:39:27.990306 [info ] [MainThread]: 
[0m23:39:27.990855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:27.991342 [info ] [MainThread]: 
[0m23:39:27.992112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:27.993572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:39:28.030624 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:39:28.031460 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:39:28.032231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:28.046035 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m23:39:28.048478 [debug] [ThreadPool]: On list_postgres: Close
[0m23:39:28.050705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_analytics)
[0m23:39:28.051607 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_analytics"
"
[0m23:39:28.058104 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m23:39:28.058565 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_analytics"} */
create schema if not exists "pipedrive_analytics"
[0m23:39:28.059023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:28.066117 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m23:39:28.067833 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m23:39:28.068672 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m23:39:28.069348 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m23:39:28.075582 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m23:39:28.076361 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: Close
[0m23:39:28.079095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_analytics, now list_postgres_pipedrive_analytics)
[0m23:39:28.091206 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:39:28.094394 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m23:39:28.098337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:28.116908 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:39:28.119277 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m23:39:28.120054 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m23:39:28.131968 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:28.132803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:39:28.133653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:28.152781 [debug] [MainThread]: SQL status: SELECT 2 in 0.019 seconds
[0m23:39:28.157758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33c2e6090>]}
[0m23:39:28.158785 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:28.159773 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.162696 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:28.163425 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.167504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:39:28.168276 [debug] [MainThread]: On master: Close
[0m23:39:28.177706 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:39:28.178673 [info ] [Thread-1 (]: 1 of 1 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m23:39:28.179433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m23:39:28.179977 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:39:28.187910 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:39:28.188802 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:39:28.235145 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:39:28.236146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.236700 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:39:28.237216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:28.249293 [debug] [Thread-1 (]: SQL status: SELECT 9158 in 0.012 seconds
[0m23:39:28.258611 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.259170 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:39:28.260085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:39:28.275970 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:39:28.276516 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.277024 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:39:28.285971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:39:28.292163 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m23:39:28.297238 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.297761 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:39:28.298587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:39:28.301045 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:39:28.303308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33d789760>]}
[0m23:39:28.304299 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 9158[0m in 0.12s]
[0m23:39:28.305153 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:39:28.306417 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.306891 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:28.307324 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.307736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:28.316142 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m23:39:28.316613 [debug] [MainThread]: On master: Close
[0m23:39:28.317249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:28.317901 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:39:28.318513 [info ] [MainThread]: 
[0m23:39:28.319212 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m23:39:28.320224 [debug] [MainThread]: Command end result
[0m23:39:28.341257 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:39:28.343006 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:39:28.348418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:39:28.348865 [info ] [MainThread]: 
[0m23:39:28.349455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:28.349977 [info ] [MainThread]: 
[0m23:39:28.350506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:39:28.351540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9486055, "process_in_blocks": "0", "process_kernel_time": 0.150254, "process_mem_max_rss": "128268", "process_out_blocks": "2728", "process_user_time": 3.117526}
[0m23:39:28.352165 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:28.352056 after 1.95 seconds
[0m23:39:28.352632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f2cbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f22bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f24cbf0>]}
[0m23:39:28.353198 [debug] [MainThread]: Flushing usage events
[0m23:39:28.750512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:44.863039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581951eccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581951c69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758192564bc0>]}


============================== 00:19:44.867753 | 8afda2a8-f700-4b53-88de-a2cbb4a0e668 ==============================
[0m00:19:44.867753 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:19:44.868637 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:44.878904 [info ] [MainThread]: dbt version: 1.11.2
[0m00:19:44.879759 [info ] [MainThread]: python version: 3.12.1
[0m00:19:44.880357 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m00:19:44.881010 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m00:19:44.972333 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m00:19:44.973041 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m00:19:44.973687 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m00:19:44.974619 [info ] [MainThread]: adapter type: postgres
[0m00:19:44.975285 [info ] [MainThread]: adapter version: 1.10.0
[0m00:19:45.096430 [info ] [MainThread]: Configuration:
[0m00:19:45.097187 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:19:45.097743 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:19:45.098262 [info ] [MainThread]: Required dependencies:
[0m00:19:45.098779 [debug] [MainThread]: Executing "git --help"
[0m00:19:45.101064 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:19:45.101659 [debug] [MainThread]: STDERR: "b''"
[0m00:19:45.102260 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:19:45.102968 [info ] [MainThread]: Connection:
[0m00:19:45.103666 [info ] [MainThread]:   host: localhost
[0m00:19:45.104220 [info ] [MainThread]:   port: 5432
[0m00:19:45.104739 [info ] [MainThread]:   user: admin
[0m00:19:45.105383 [info ] [MainThread]:   database: postgres
[0m00:19:45.106057 [info ] [MainThread]:   schema: pipedrive_analytics
[0m00:19:45.106715 [info ] [MainThread]:   connect_timeout: 10
[0m00:19:45.107380 [info ] [MainThread]:   role: None
[0m00:19:45.108045 [info ] [MainThread]:   search_path: None
[0m00:19:45.108646 [info ] [MainThread]:   keepalives_idle: 0
[0m00:19:45.109239 [info ] [MainThread]:   sslmode: None
[0m00:19:45.109704 [info ] [MainThread]:   sslcert: None
[0m00:19:45.110356 [info ] [MainThread]:   sslkey: None
[0m00:19:45.111021 [info ] [MainThread]:   sslrootcert: None
[0m00:19:45.111697 [info ] [MainThread]:   application_name: dbt
[0m00:19:45.112373 [info ] [MainThread]:   retries: 1
[0m00:19:45.113417 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:19:45.206279 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:19:45.229110 [debug] [MainThread]: Using postgres connection "debug"
[0m00:19:45.229985 [debug] [MainThread]: On debug: select 1 as id
[0m00:19:45.230587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:45.262657 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m00:19:45.264673 [debug] [MainThread]: On debug: Close
[0m00:19:45.265499 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:19:45.266385 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:19:45.267993 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.47054848, "process_in_blocks": "3704", "process_kernel_time": 0.167043, "process_mem_max_rss": "117268", "process_out_blocks": "24", "process_user_time": 1.745006}
[0m00:19:45.269112 [debug] [MainThread]: Command `dbt debug` succeeded at 00:19:45.268941 after 0.47 seconds
[0m00:19:45.269880 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:19:45.270656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581924fe600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758191b951c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75819237a000>]}
[0m00:19:45.271511 [debug] [MainThread]: Flushing usage events
[0m00:19:45.663212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:10.533334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd96f3e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd976d73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd974d6b40>]}


============================== 00:29:10.536995 | 9238e66d-a3d1-4a1a-a21a-0726f1a462b4 ==============================
[0m00:29:10.536995 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:29:10.537920 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'empty': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select tag:pipedrive', 'fail_fast': 'False'}
[0m00:29:10.710815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9238e66d-a3d1-4a1a-a21a-0726f1a462b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd95d3aab0>]}
[0m00:29:10.782327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9238e66d-a3d1-4a1a-a21a-0726f1a462b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd9703e450>]}
[0m00:29:10.783431 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:29:10.891806 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:29:10.995231 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:29:10.996102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9238e66d-a3d1-4a1a-a21a-0726f1a462b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd951986b0>]}
[0m00:29:11.992660 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_users' (models/staging/stg_users.sql) depends on a source named 'pipedrive.users' which was not found
[0m00:29:11.994202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5232502, "process_in_blocks": "8", "process_kernel_time": 0.170189, "process_mem_max_rss": "116372", "process_out_blocks": "16", "process_user_time": 2.955928}
[0m00:29:11.994940 [debug] [MainThread]: Command `dbt run` failed at 00:29:11.994818 after 1.52 seconds
[0m00:29:11.995498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd96f3e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd949de090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd94ddc200>]}
[0m00:29:11.996063 [debug] [MainThread]: Flushing usage events
[0m00:29:12.378033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:39.002285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2e217f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de816780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dedb8380>]}


============================== 00:31:39.006637 | c627d3e4-c341-4575-845f-135ba4d39f32 ==============================
[0m00:31:39.006637 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:31:39.007574 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:pipedrive', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'static_parser': 'True', 'no_print': 'None'}
[0m00:31:39.174399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de10c7d0>]}
[0m00:31:39.240904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2e06653a0>]}
[0m00:31:39.241931 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:31:39.349888 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:31:39.443564 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:31:39.444345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de987cb0>]}
[0m00:31:40.834717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de141400>]}
[0m00:31:41.099638 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:31:41.103359 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:31:41.145986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dc774320>]}
[0m00:31:41.147128 [info ] [MainThread]: Found 1 model, 6 sources, 464 macros
[0m00:31:41.147984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dd373f50>]}
[0m00:31:41.150760 [info ] [MainThread]: 
[0m00:31:41.157921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:41.159322 [info ] [MainThread]: 
[0m00:31:41.162858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:41.164680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:31:41.226117 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:31:41.232738 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:31:41.234020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:41.256226 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m00:31:41.261123 [debug] [ThreadPool]: On list_postgres: Close
[0m00:31:41.269859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m00:31:41.280683 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:31:41.281780 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:31:41.282716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:41.305743 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m00:31:41.309279 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:31:41.310515 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:31:41.322328 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:41.323482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:41.324559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:41.342578 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m00:31:41.345187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2daba9ee0>]}
[0m00:31:41.346302 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:41.347376 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.348074 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:41.348729 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.349946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:41.350783 [debug] [MainThread]: On master: Close
[0m00:31:41.357702 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m00:31:41.358855 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_users ...................... [RUN]
[0m00:31:41.361467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_users)
[0m00:31:41.362362 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m00:31:41.378815 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m00:31:41.380019 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m00:31:41.446176 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m00:31:41.447691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.448625 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with 

transformed as (

                SELECT 
                      id          as user_id,
                      name        as user_name,
                      email       as user_email,
                      modified    as user_modified_at

                FROM "postgres"."public"."users"
)

SELECT 
      *
FROM transformed
  );
[0m00:31:41.449470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:41.462616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m00:31:41.474983 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.476138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m00:31:41.477768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:41.502636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m00:31:41.503841 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.504850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m00:31:41.517701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m00:31:41.528991 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_users__dbt_backup"
[0m00:31:41.538335 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.539512 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m00:31:41.541058 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:31:41.545284 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m00:31:41.550533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2da996540>]}
[0m00:31:41.552711 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_users ................. [[32mCREATE VIEW[0m in 0.19s]
[0m00:31:41.554096 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m00:31:41.556121 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.557087 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:41.557884 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.558646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:41.569840 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m00:31:41.570959 [debug] [MainThread]: On master: Close
[0m00:31:41.574272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:41.575218 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:31:41.576059 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m00:31:41.576916 [info ] [MainThread]: 
[0m00:31:41.577767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m00:31:41.579289 [debug] [MainThread]: Command end result
[0m00:31:41.618139 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:31:41.621407 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:31:41.630965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:31:41.631916 [info ] [MainThread]: 
[0m00:31:41.632889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:41.633745 [info ] [MainThread]: 
[0m00:31:41.634614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:31:41.636320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.691725, "process_in_blocks": "0", "process_kernel_time": 0.179661, "process_mem_max_rss": "128116", "process_out_blocks": "2776", "process_user_time": 3.536642}
[0m00:31:41.637361 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:41.637205 after 2.69 seconds
[0m00:31:41.638255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2e0a44bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dc3ff2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2da9b7650>]}
[0m00:31:41.639174 [debug] [MainThread]: Flushing usage events
[0m00:31:42.047746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:57.567251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35e9c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35016900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c33a26ea0>]}


============================== 00:55:57.570416 | 171f3fc9-dfa4-481c-b3ff-cd7f36b27efb ==============================
[0m00:55:57.570416 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:55:57.571298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:57.746785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35d5deb0>]}
[0m00:55:57.807947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3421f5f0>]}
[0m00:55:57.808946 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:55:57.973647 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:55:58.086016 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:55:58.086837 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:55:58.087337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c33c03890>]}
[0m00:55:59.083421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c329691c0>]}
[0m00:55:59.161327 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:55:59.173258 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:55:59.281829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3159d1f0>]}
[0m00:55:59.282777 [info ] [MainThread]: Found 2 models, 6 sources, 434 macros
[0m00:55:59.283648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35b0eff0>]}
[0m00:55:59.286238 [info ] [MainThread]: 
[0m00:55:59.287697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:59.288738 [info ] [MainThread]: 
[0m00:55:59.290105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:59.291885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:55:59.342545 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:55:59.343305 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:55:59.343770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:59.352736 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m00:55:59.354158 [debug] [ThreadPool]: On list_postgres: Close
[0m00:55:59.359125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:55:59.365038 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:55:59.365468 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:55:59.365893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:59.373626 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m00:55:59.374522 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:55:59.375317 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:55:59.379591 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m00:55:59.381965 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:55:59.382854 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:55:59.393415 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.394183 [debug] [MainThread]: On master: BEGIN
[0m00:55:59.394828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:59.406318 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:55:59.407067 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.407989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:55:59.412531 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m00:55:59.414325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35b0fb60>]}
[0m00:55:59.415224 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:59.416142 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.416611 [debug] [MainThread]: On master: BEGIN
[0m00:55:59.417374 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:55:59.418080 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.418731 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.419422 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.419991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:59.420596 [debug] [MainThread]: On master: Close
[0m00:55:59.423931 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.425435 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity_types ............. [RUN]
[0m00:55:59.426785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m00:55:59.427684 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.439743 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.440773 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.490854 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.491952 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.492502 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m00:55:59.492997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:59.501089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m00:55:59.501949 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.502509 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
                 )
SELECT *
FROM transformed
  );
[0m00:55:59.504731 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m00:55:59.512253 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.512780 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m00:55:59.513677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:59.527870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m00:55:59.528406 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.528892 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m00:55:59.537297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m00:55:59.543526 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m00:55:59.548538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.549070 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m00:55:59.549931 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:55:59.552405 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m00:55:59.555392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35d5ce90>]}
[0m00:55:59.556200 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity_types ........ [[32mCREATE VIEW[0m in 0.13s]
[0m00:55:59.557149 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.558756 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.559512 [debug] [MainThread]: On master: BEGIN
[0m00:55:59.560219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:59.568853 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:55:59.569536 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.570170 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.570607 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.571216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:59.571659 [debug] [MainThread]: On master: Close
[0m00:55:59.572344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:59.573162 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity_types' was properly closed.
[0m00:55:59.573871 [info ] [MainThread]: 
[0m00:55:59.575531 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:55:59.581203 [debug] [MainThread]: Command end result
[0m00:55:59.649782 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:55:59.653392 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:55:59.663726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:55:59.664724 [info ] [MainThread]: 
[0m00:55:59.666280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:59.668191 [info ] [MainThread]: 
[0m00:55:59.669361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:55:59.671345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1650198, "process_in_blocks": "1376", "process_kernel_time": 0.207173, "process_mem_max_rss": "140928", "process_out_blocks": "2632", "process_user_time": 4.315776}
[0m00:55:59.672474 [debug] [MainThread]: Command `cli run` succeeded at 00:55:59.672311 after 2.17 seconds
[0m00:55:59.673563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c33fc7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c334a2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c359f9070>]}
[0m00:55:59.674772 [debug] [MainThread]: Flushing usage events
[0m00:56:00.077187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:50.693108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fc2342f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbb3b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbc9ff50>]}


============================== 20:24:50.696290 | e72eadf5-d389-4597-8e4c-1eb392a02cf2 ==============================
[0m20:24:50.696290 [info ] [MainThread]: Running with dbt=1.10.0
[0m20:24:50.697942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:50.929303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e72eadf5-d389-4597-8e4c-1eb392a02cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbec2030>]}
[0m20:24:50.941513 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:24:50.957880 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:24:50.959550 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3214577, "process_in_blocks": "400", "process_kernel_time": 0.15386, "process_mem_max_rss": "117088", "process_out_blocks": "16", "process_user_time": 2.514717}
[0m20:24:50.960555 [debug] [MainThread]: Command `cli deps` succeeded at 20:24:50.960365 after 0.32 seconds
[0m20:24:50.961322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fb6ed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fb5c40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbec1970>]}
[0m20:24:50.962206 [debug] [MainThread]: Flushing usage events
[0m20:24:51.373837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:12.040289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80ae929ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80aef87200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80ae8945f0>]}


============================== 21:41:12.043711 | 80b9a54b-9b42-435c-b0d6-57c75aeb1e05 ==============================
[0m21:41:12.043711 [info ] [MainThread]: Running with dbt=1.10.0
[0m21:41:12.044785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:41:12.182589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80b9a54b-9b42-435c-b0d6-57c75aeb1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80af132bd0>]}
[0m21:41:12.207868 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:41:12.227410 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:41:12.230378 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2538539, "process_in_blocks": "400", "process_kernel_time": 0.174642, "process_mem_max_rss": "116924", "process_out_blocks": "8", "process_user_time": 2.45797}
[0m21:41:12.232099 [debug] [MainThread]: Command `cli deps` succeeded at 21:41:12.231904 after 0.26 seconds
[0m21:41:12.233004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80b0dcae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80af001910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80ae347aa0>]}
[0m21:41:12.234085 [debug] [MainThread]: Flushing usage events
[0m21:41:12.650710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:01.066365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f790eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f76b6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7c1e480>]}


============================== 23:29:01.097965 | cf8ae08a-6f11-4436-93cd-649c3b0e5222 ==============================
[0m23:29:01.097965 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:29:01.100687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:01.284688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7017dd0>]}
[0m23:29:01.353613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f75d14f0>]}
[0m23:29:01.354678 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:29:01.699252 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m23:29:01.809017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:29:01.809986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:29:01.872133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7e6b770>]}
[0m23:29:02.005889 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:29:02.035036 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:29:02.063292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f4d02ae0>]}
[0m23:29:02.064063 [info ] [MainThread]: Found 6 models, 6 sources, 434 macros
[0m23:29:02.064692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7017260>]}
[0m23:29:02.067278 [info ] [MainThread]: 
[0m23:29:02.067963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:02.068471 [info ] [MainThread]: 
[0m23:29:02.069286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:02.075004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:29:02.112717 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:29:02.113371 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:29:02.113862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:02.124438 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m23:29:02.126168 [debug] [ThreadPool]: On list_postgres: Close
[0m23:29:02.128443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m23:29:02.135854 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:29:02.136488 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m23:29:02.136989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:02.144640 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:29:02.145683 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:29:02.146183 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m23:29:02.168994 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.022 seconds
[0m23:29:02.171698 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m23:29:02.172947 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m23:29:02.187722 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.189504 [debug] [MainThread]: On master: BEGIN
[0m23:29:02.190471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:02.234021 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m23:29:02.234900 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.244470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:29:02.257832 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m23:29:02.267839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f614bbf0>]}
[0m23:29:02.277636 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:02.288161 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.290787 [debug] [MainThread]: On master: BEGIN
[0m23:29:02.308850 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:29:02.309778 [debug] [MainThread]: On master: COMMIT
[0m23:29:02.312478 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.317795 [debug] [MainThread]: On master: COMMIT
[0m23:29:02.328817 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:29:02.330258 [debug] [MainThread]: On master: Close
[0m23:29:02.369646 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m23:29:02.372918 [info ] [Thread-1 (]: 1 of 6 START sql view model pipedrive_analytics.stg_activity ................... [RUN]
[0m23:29:02.383452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m23:29:02.384457 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m23:29:02.450828 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m23:29:02.453777 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m23:29:02.621676 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m23:29:02.624852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.625798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m23:29:02.626733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.645686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:29:02.646711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.647666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt 

                    FROM "postgres"."public"."activity"
)

SELECT *
FROM transformed
  );
[0m23:29:02.675559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m23:29:02.682835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.683477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m23:29:02.684578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.701868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:29:02.702578 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.703112 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:29:02.705577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:29:02.712519 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m23:29:02.718551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.719184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m23:29:02.720092 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:02.722840 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m23:29:02.727604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f989d6d0>]}
[0m23:29:02.728611 [info ] [Thread-1 (]: 1 of 6 OK created sql view model pipedrive_analytics.stg_activity .............. [[32mCREATE VIEW[0m in 0.34s]
[0m23:29:02.729480 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m23:29:02.730075 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.730793 [info ] [Thread-1 (]: 2 of 6 START sql view model pipedrive_analytics.stg_activity_types ............. [RUN]
[0m23:29:02.731499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m23:29:02.732022 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.735885 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.737090 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.743336 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.744988 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.745976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m23:29:02.746683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.754243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:29:02.755149 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.755677 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
)

SELECT *
FROM transformed
  );
[0m23:29:02.758079 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:02.761973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.762769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m23:29:02.764523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.767882 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.768446 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m23:29:02.769588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.775041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m23:29:02.775666 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.776149 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m23:29:02.778151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:29:02.782162 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m23:29:02.783818 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.784798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m23:29:02.787211 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:29:02.789042 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m23:29:02.789936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3eac320>]}
[0m23:29:02.791158 [info ] [Thread-1 (]: 2 of 6 OK created sql view model pipedrive_analytics.stg_activity_types ........ [[32mCREATE VIEW[0m in 0.06s]
[0m23:29:02.792238 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.793089 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.793795 [info ] [Thread-1 (]: 3 of 6 START sql view model pipedrive_analytics.stg_deal_changes ............... [RUN]
[0m23:29:02.794489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m23:29:02.795049 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.800345 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.801863 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.806979 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.807942 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.808488 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m23:29:02.808969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.816522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:29:02.817312 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.817864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            deal_id,
                            CAST(change_time AS TIMESTAMP) change_dt,
                            changed_field_key,
                            new_value

                    FROM "postgres"."public"."deal_changes"
)

SELECT 
      *
FROM transformed
  );
[0m23:29:02.822547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:29:02.827385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.828096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:29:02.829170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.831021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:29:02.831584 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.832060 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:29:02.833597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:02.838441 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m23:29:02.841069 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.843991 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m23:29:02.847759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:29:02.851185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:29:02.854262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3f34050>]}
[0m23:29:02.855799 [info ] [Thread-1 (]: 3 of 6 OK created sql view model pipedrive_analytics.stg_deal_changes .......... [[32mCREATE VIEW[0m in 0.06s]
[0m23:29:02.857273 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.858232 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m23:29:02.859320 [info ] [Thread-1 (]: 4 of 6 START sql view model pipedrive_analytics.stg_fields ..................... [RUN]
[0m23:29:02.860222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m23:29:02.860764 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m23:29:02.866782 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m23:29:02.867683 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m23:29:02.871568 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m23:29:02.872413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.872949 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m23:29:02.873389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.881153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:02.881915 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.882455 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp"
    
    
  as (
    

WITH

raw AS (
        SELECT 
              id          AS field_id,
              field_key,
              name        AS field_name,
              field_value_options

        FROM "postgres"."public"."fields"
)

, base AS (
            SELECT
                  field_id,
                  field_key,
                  field_value_options
                  
            FROM raw
            WHERE field_value_options IS NOT NULL
)

, exploded AS (
                SELECT
                      b.field_id,
                      b.field_key,
                      e.elem->>'id'    AS option_id,
                      e.elem->>'label' AS option_label

                FROM base b
                CROSS JOIN lateral
                    jsonb_array_elements(b.field_value_options) WITH ordinality AS e(elem, ord)
)

, transformed AS (
                    SELECT
                          r.field_id,
                          r.field_key,
                          r.field_name,
                          CASE
                              WHEN e.option_id ~ '^\d+$' THEN e.option_id::int
                              ELSE NULL
                          END AS option_id,
                          e.option_label
                        
                    FROM raw r
                    LEFT JOIN exploded e    USING (field_id)
)
SELECT
        *
FROM transformed
ORDER BY field_id, 
         option_id
  );
[0m23:29:02.892940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:29:02.896803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.897447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m23:29:02.898654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.900500 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m23:29:02.901053 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.901515 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m23:29:02.903425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:02.907352 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_fields__dbt_backup"
[0m23:29:02.909235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.910165 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m23:29:02.911314 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:02.912920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m23:29:02.913747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3ed3890>]}
[0m23:29:02.914869 [info ] [Thread-1 (]: 4 of 6 OK created sql view model pipedrive_analytics.stg_fields ................ [[32mCREATE VIEW[0m in 0.05s]
[0m23:29:02.915895 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m23:29:02.916739 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m23:29:02.917431 [info ] [Thread-1 (]: 5 of 6 START sql view model pipedrive_analytics.stg_stages ..................... [RUN]
[0m23:29:02.918085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m23:29:02.918587 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m23:29:02.924837 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m23:29:02.926470 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m23:29:02.934878 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m23:29:02.935783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.936305 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m23:29:02.936772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.945043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:02.945964 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.946990 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            stage_id,
                            stage_name

                    FROM "postgres"."public"."stages"
)

SELECT *
FROM transformed
  );
[0m23:29:02.949340 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:02.954568 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.955619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m23:29:02.956969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:29:02.959898 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m23:29:02.960608 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.961127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m23:29:02.962902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:02.966081 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_stages__dbt_backup"
[0m23:29:02.967191 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.967779 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m23:29:02.968673 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:02.970202 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m23:29:02.971030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3ee8d70>]}
[0m23:29:02.972197 [info ] [Thread-1 (]: 5 of 6 OK created sql view model pipedrive_analytics.stg_stages ................ [[32mCREATE VIEW[0m in 0.05s]
[0m23:29:02.973437 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m23:29:02.974111 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m23:29:02.974778 [info ] [Thread-1 (]: 6 of 6 START sql view model pipedrive_analytics.stg_users ...................... [RUN]
[0m23:29:02.975430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m23:29:02.975913 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m23:29:02.979574 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m23:29:02.980730 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m23:29:02.986975 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m23:29:02.988299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:02.989190 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m23:29:02.989976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.999107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:29:02.999924 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.000461 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with 

transformed as (

                SELECT 
                      id          as user_id,
                      name        as user_name,
                      email       as user_email,
                      modified    as user_modified_at

                FROM "postgres"."public"."users"
)

SELECT 
      *
FROM transformed
  );
[0m23:29:03.002616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:03.007616 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.008574 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m23:29:03.010008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:03.015128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.015801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m23:29:03.016893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:03.019021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m23:29:03.019585 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.020063 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m23:29:03.021442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:03.024210 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_users__dbt_backup"
[0m23:29:03.025757 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.026640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m23:29:03.031446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:29:03.034098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m23:29:03.035296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3f8fa70>]}
[0m23:29:03.038093 [info ] [Thread-1 (]: 6 of 6 OK created sql view model pipedrive_analytics.stg_users ................. [[32mCREATE VIEW[0m in 0.06s]
[0m23:29:03.039243 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m23:29:03.041229 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:03.042030 [debug] [MainThread]: On master: BEGIN
[0m23:29:03.042863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:03.053467 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:29:03.054241 [debug] [MainThread]: On master: COMMIT
[0m23:29:03.054784 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:03.055213 [debug] [MainThread]: On master: COMMIT
[0m23:29:03.055888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:03.056338 [debug] [MainThread]: On master: Close
[0m23:29:03.057020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:03.057721 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:29:03.058287 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m23:29:03.059008 [info ] [MainThread]: 
[0m23:29:03.059745 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m23:29:03.061562 [debug] [MainThread]: Command end result
[0m23:29:03.091954 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:29:03.095266 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:29:03.105410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:29:03.106274 [info ] [MainThread]: 
[0m23:29:03.107351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:03.108026 [info ] [MainThread]: 
[0m23:29:03.108922 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m23:29:03.111825 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.101913, "process_in_blocks": "1400", "process_kernel_time": 0.297424, "process_mem_max_rss": "138180", "process_out_blocks": "1992", "process_user_time": 4.514724}
[0m23:29:03.113282 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:03.113083 after 2.10 seconds
[0m23:29:03.114375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7687020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f9032a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7aef170>]}
[0m23:29:03.115324 [debug] [MainThread]: Flushing usage events
[0m23:29:03.610456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:59.540477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05a4e1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05a4e2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a059d2a8a0>]}


============================== 23:56:59.544041 | 265e6e10-1232-490c-9223-aab05ef08256 ==============================
[0m23:56:59.544041 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:56:59.545006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:59.731518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a059772f90>]}
[0m23:56:59.797085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a059b99070>]}
[0m23:56:59.798132 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:56:59.961869 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m23:57:00.070973 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:57:00.071686 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m23:57:00.072274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a058750140>]}
[0m23:57:01.155881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05778ec30>]}
[0m23:57:01.232644 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:57:01.246584 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:57:01.267710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057f7f7d0>]}
[0m23:57:01.268742 [info ] [MainThread]: Found 6 models, 6 sources, 434 macros
[0m23:57:01.269492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057b56150>]}
[0m23:57:01.272486 [info ] [MainThread]: 
[0m23:57:01.273308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:01.274132 [info ] [MainThread]: 
[0m23:57:01.275907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:01.277624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:57:01.344216 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:57:01.345451 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:57:01.346357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:01.360450 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m23:57:01.363336 [debug] [ThreadPool]: On list_postgres: Close
[0m23:57:01.377362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m23:57:01.397447 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:57:01.400450 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m23:57:01.401192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:01.443178 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m23:57:01.445631 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:57:01.446486 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m23:57:01.463816 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:57:01.472579 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m23:57:01.474366 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m23:57:01.484407 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.485508 [debug] [MainThread]: On master: BEGIN
[0m23:57:01.486344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:01.499435 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:57:01.500464 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.501375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:57:01.513024 [debug] [MainThread]: SQL status: SELECT 6 in 0.011 seconds
[0m23:57:01.515891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057b69070>]}
[0m23:57:01.517029 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:01.518185 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.519018 [debug] [MainThread]: On master: BEGIN
[0m23:57:01.521043 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:57:01.521971 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.522757 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.523835 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.524892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:01.525896 [debug] [MainThread]: On master: Close
[0m23:57:01.538782 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m23:57:01.540929 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity ................... [RUN]
[0m23:57:01.542279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m23:57:01.543151 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m23:57:01.556637 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m23:57:01.560417 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m23:57:01.655717 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m23:57:01.657872 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.660031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m23:57:01.662891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:01.694051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m23:57:01.700414 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.706020 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt,
                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num 

                    FROM "postgres"."public"."activity"
)

SELECT *
FROM transformed
WHERE row_num = 1
  );
[0m23:57:01.734952 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m23:57:01.749231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.752205 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m23:57:01.755906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:57:01.765030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.766127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m23:57:01.767923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:01.802184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:57:01.803310 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.804295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:57:01.806661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:57:01.819141 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m23:57:01.833479 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.834628 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m23:57:01.838872 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:57:01.843490 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m23:57:01.849066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0561d9b80>]}
[0m23:57:01.850502 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity .............. [[32mCREATE VIEW[0m in 0.30s]
[0m23:57:01.852615 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m23:57:01.854781 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.855599 [debug] [MainThread]: On master: BEGIN
[0m23:57:01.856268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:01.867976 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m23:57:01.869111 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.869878 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.870597 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.871547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:01.872293 [debug] [MainThread]: On master: Close
[0m23:57:01.873208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:01.873924 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m23:57:01.877023 [info ] [MainThread]: 
[0m23:57:01.877916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:57:01.879279 [debug] [MainThread]: Command end result
[0m23:57:01.943113 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:57:01.954971 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:57:01.983755 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:57:01.984591 [info ] [MainThread]: 
[0m23:57:01.985455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:01.988245 [info ] [MainThread]: 
[0m23:57:01.989245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:57:01.991000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.514063, "process_in_blocks": "152", "process_kernel_time": 0.254356, "process_mem_max_rss": "140904", "process_out_blocks": "2712", "process_user_time": 4.679761}
[0m23:57:01.992037 [debug] [MainThread]: Command `cli run` succeeded at 23:57:01.991864 after 2.52 seconds
[0m23:57:01.992941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05c18ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05a403470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057b9e510>]}
[0m23:57:01.993861 [debug] [MainThread]: Flushing usage events
[0m23:57:02.427709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:55.999973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e74ef2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7726b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e750c7b30>]}


============================== 00:00:56.003338 | dfb3a460-c937-4583-932b-6d7d9e60b4e1 ==============================
[0m00:00:56.003338 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:00:56.004258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:00:56.185410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e73ef77a0>]}
[0m00:00:56.251018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e76ca2120>]}
[0m00:00:56.252417 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:00:56.450394 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:00:56.558636 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:00:56.559478 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:00:56.560216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e733eeb70>]}
[0m00:00:58.728103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e72726f00>]}
[0m00:00:58.808688 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:00:58.821903 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:00:58.843557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7333d430>]}
[0m00:00:58.844568 [info ] [MainThread]: Found 6 models, 6 sources, 434 macros
[0m00:00:58.845368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e733a1520>]}
[0m00:00:58.849327 [info ] [MainThread]: 
[0m00:00:58.850729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:58.851980 [info ] [MainThread]: 
[0m00:00:58.853026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:58.855647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:00:58.914696 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:00:58.916197 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:00:58.917135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:58.929331 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m00:00:58.930964 [debug] [ThreadPool]: On list_postgres: Close
[0m00:00:58.937070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:00:58.943452 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:00:58.944075 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:00:58.944546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:58.952103 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m00:00:58.952895 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:00:58.953364 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:00:58.956547 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m00:00:58.958379 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:00:58.959278 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:00:58.967303 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.967854 [debug] [MainThread]: On master: BEGIN
[0m00:00:58.968260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:58.975652 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:00:58.976239 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.976774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:00:58.980969 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m00:00:58.982752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e72f11cd0>]}
[0m00:00:58.983891 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:58.986024 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.986618 [debug] [MainThread]: On master: BEGIN
[0m00:00:58.987446 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:58.988352 [debug] [MainThread]: On master: COMMIT
[0m00:00:58.988876 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.989313 [debug] [MainThread]: On master: COMMIT
[0m00:00:58.989985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:58.990446 [debug] [MainThread]: On master: Close
[0m00:00:58.994624 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m00:00:58.995465 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity ................... [RUN]
[0m00:00:58.996415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m00:00:58.997683 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m00:00:59.009752 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m00:00:59.010743 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m00:00:59.057424 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m00:00:59.058428 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.058971 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m00:00:59.059417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:59.069730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:00:59.070383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.070920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt,
                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num 

                    FROM "postgres"."public"."activity"
)

SELECT 
       activity_id,
       type,
       assigned_to_user,
       deal_id,
       done,
       due_to_dt
FROM transformed
WHERE row_num = 1
  );
[0m00:00:59.074413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:00:59.086776 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.087404 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m00:00:59.088491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:59.093489 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.094372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m00:00:59.095886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:59.118635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m00:00:59.119672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.120480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m00:00:59.124886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:00:59.141289 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m00:00:59.147670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.148619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m00:00:59.150850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:00:59.153739 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m00:00:59.157340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7702f3e0>]}
[0m00:00:59.159434 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity .............. [[32mCREATE VIEW[0m in 0.16s]
[0m00:00:59.162056 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m00:00:59.165820 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:59.166732 [debug] [MainThread]: On master: BEGIN
[0m00:00:59.167691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:59.177862 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:00:59.178454 [debug] [MainThread]: On master: COMMIT
[0m00:00:59.178903 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:59.179294 [debug] [MainThread]: On master: COMMIT
[0m00:00:59.180375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:59.180906 [debug] [MainThread]: On master: Close
[0m00:00:59.181649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:59.182277 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m00:00:59.182893 [info ] [MainThread]: 
[0m00:00:59.183900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m00:00:59.184859 [debug] [MainThread]: Command end result
[0m00:00:59.225247 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:00:59.228917 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:00:59.238869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:00:59.239731 [info ] [MainThread]: 
[0m00:00:59.240623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:59.241391 [info ] [MainThread]: 
[0m00:00:59.242177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:00:59.243885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.299033, "process_in_blocks": "0", "process_kernel_time": 0.263759, "process_mem_max_rss": "140888", "process_out_blocks": "2712", "process_user_time": 5.097704}
[0m00:00:59.244898 [debug] [MainThread]: Command `cli run` succeeded at 00:00:59.244732 after 3.30 seconds
[0m00:00:59.245734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e754160f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e74785220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7013a270>]}
[0m00:00:59.246600 [debug] [MainThread]: Flushing usage events
[0m00:00:59.628059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:19.772816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f78e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b273374d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f7b7cb0>]}


============================== 00:27:19.776362 | ec42bc8c-843b-46bb-9353-4bc6fdc47d20 ==============================
[0m00:27:19.776362 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:27:19.777254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:27:19.961724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2731200080>]}
[0m00:27:20.026160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2730fb18e0>]}
[0m00:27:20.027190 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:27:20.191506 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:27:20.271008 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:27:20.271714 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:27:20.272242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f09d640>]}
[0m00:27:21.451893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272c9afe00>]}
[0m00:27:21.587994 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:27:21.601781 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:27:21.622585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272cda4f50>]}
[0m00:27:21.623648 [info ] [MainThread]: Found 7 models, 6 sources, 434 macros
[0m00:27:21.624448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272c9c6600>]}
[0m00:27:21.627300 [info ] [MainThread]: 
[0m00:27:21.628200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:27:21.628946 [info ] [MainThread]: 
[0m00:27:21.629932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:27:21.631886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:27:21.693649 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:27:21.694628 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:27:21.695463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:21.713284 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m00:27:21.716309 [debug] [ThreadPool]: On list_postgres: Close
[0m00:27:21.729653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:27:21.741323 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:27:21.742146 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:27:21.742836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:27:21.754550 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:27:21.755368 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:27:21.756127 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:27:21.761031 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m00:27:21.763669 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:27:21.764853 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:27:21.776106 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.776960 [debug] [MainThread]: On master: BEGIN
[0m00:27:21.777681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:27:21.790389 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:27:21.793599 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.794662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:27:21.802962 [debug] [MainThread]: SQL status: SELECT 6 in 0.007 seconds
[0m00:27:21.807340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272d9c85c0>]}
[0m00:27:21.808375 [debug] [MainThread]: On master: ROLLBACK
[0m00:27:21.809548 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.810417 [debug] [MainThread]: On master: BEGIN
[0m00:27:21.812798 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:27:21.813631 [debug] [MainThread]: On master: COMMIT
[0m00:27:21.814398 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.815119 [debug] [MainThread]: On master: COMMIT
[0m00:27:21.816133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:27:21.816870 [debug] [MainThread]: On master: Close
[0m00:27:21.827358 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m00:27:21.828668 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_activites .................. [RUN]
[0m00:27:21.829741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_activites)
[0m00:27:21.830782 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m00:27:21.844251 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m00:27:21.845725 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m00:27:21.908060 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activites"
[0m00:27:21.909990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.910984 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: BEGIN
[0m00:27:21.911843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:21.925844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:27:21.926811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.928090 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */

  create view "postgres"."pipedrive_analytics"."int_activites__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
          SELECT 
                ac.activity_id,
                ac.deal_id,
                ac.type,
                act.name,
                ac.assigned_to_user,
                ac.due_to_dt,
                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month
                
          FROM "postgres"."pipedrive_analytics"."stg_activity" ac
          LEFT JOIN "postgres"."pipedrive_analytics"."stg_activity_types" act ON ac.type = act.type
          WHERE TRUE 
              AND ac.done
              AND act.name IN ('Sales Call 1', 'Sales Call 2')
)

SELECT *
FROM base
  );
[0m00:27:21.942143 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m00:27:21.960273 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.961312 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
alter table "postgres"."pipedrive_analytics"."int_activites__dbt_tmp" rename to "int_activites"
[0m00:27:21.962921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:27:21.994026 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m00:27:21.995097 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.995998 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m00:27:21.998797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:27:22.014918 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_activites__dbt_backup"
[0m00:27:22.024448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:22.025570 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
drop view if exists "postgres"."pipedrive_analytics"."int_activites__dbt_backup" cascade
[0m00:27:22.027055 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:27:22.031427 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: Close
[0m00:27:22.037519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b27311d7110>]}
[0m00:27:22.039009 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_activites ............. [[32mCREATE VIEW[0m in 0.21s]
[0m00:27:22.040361 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m00:27:22.042347 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:22.043214 [debug] [MainThread]: On master: BEGIN
[0m00:27:22.043961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:27:22.056597 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:27:22.057607 [debug] [MainThread]: On master: COMMIT
[0m00:27:22.058406 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:22.059171 [debug] [MainThread]: On master: COMMIT
[0m00:27:22.060196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:27:22.060985 [debug] [MainThread]: On master: Close
[0m00:27:22.064624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:22.065431 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_activites' was properly closed.
[0m00:27:22.066192 [info ] [MainThread]: 
[0m00:27:22.070100 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m00:27:22.071695 [debug] [MainThread]: Command end result
[0m00:27:22.110304 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:27:22.114678 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:27:22.124279 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:27:22.125188 [info ] [MainThread]: 
[0m00:27:22.126104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:27:22.126878 [info ] [MainThread]: 
[0m00:27:22.127662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:27:22.129407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4120617, "process_in_blocks": "0", "process_kernel_time": 0.293556, "process_mem_max_rss": "140936", "process_out_blocks": "2744", "process_user_time": 4.679981}
[0m00:27:22.130497 [debug] [MainThread]: Command `cli run` succeeded at 00:27:22.130327 after 2.41 seconds
[0m00:27:22.131323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272eedf200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f1645c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272c9ad8b0>]}
[0m00:27:22.132233 [debug] [MainThread]: Flushing usage events
[0m00:27:22.542978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:48.041026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dd1f0>]}


============================== 00:33:48.044778 | b426fa81-ba91-4f43-8654-e99ff81eeb4b ==============================
[0m00:33:48.044778 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:33:48.045971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:33:48.209685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b426fa81-ba91-4f43-8654-e99ff81eeb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f05c8c0>]}
[0m00:33:48.228109 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:33:48.229504 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:33:48.231386 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.25253686, "process_in_blocks": "176", "process_kernel_time": 0.160936, "process_mem_max_rss": "116552", "process_out_blocks": "8", "process_user_time": 2.788907}
[0m00:33:48.232368 [debug] [MainThread]: Command `cli deps` succeeded at 00:33:48.232193 after 0.25 seconds
[0m00:33:48.233352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f7ac200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8de930>]}
[0m00:33:48.234433 [debug] [MainThread]: Flushing usage events
[0m00:33:48.653479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:43.174940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6d7bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd90f3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd731cfb0>]}


============================== 00:44:43.178428 | 66aaae8c-3f3e-4a44-bd10-09aff369e985 ==============================
[0m00:44:43.178428 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:44:43.179398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:44:43.392231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd57e6300>]}
[0m00:44:43.456946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6c95130>]}
[0m00:44:43.457991 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:44:43.647403 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:44:43.728007 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:44:43.728737 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:44:43.729349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6d78fb0>]}
[0m00:44:45.002045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd43faf00>]}
[0m00:44:45.163960 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:44:45.179571 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:44:45.204151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd4b17560>]}
[0m00:44:45.205154 [info ] [MainThread]: Found 7 models, 6 sources, 434 macros
[0m00:44:45.205920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd4bb9310>]}
[0m00:44:45.208631 [info ] [MainThread]: 
[0m00:44:45.209393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:44:45.210061 [info ] [MainThread]: 
[0m00:44:45.211013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:44:45.212433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:44:45.272320 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:44:45.273240 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:44:45.274026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:45.288719 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m00:44:45.291230 [debug] [ThreadPool]: On list_postgres: Close
[0m00:44:45.302104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:44:45.312920 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:44:45.313782 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:44:45.314459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:45.327079 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.327984 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:44:45.328741 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:44:45.333997 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m00:44:45.336925 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:44:45.338085 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:44:45.351024 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.351877 [debug] [MainThread]: On master: BEGIN
[0m00:44:45.352597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:45.364915 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.365808 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.366641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:44:45.372405 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m00:44:45.375862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd47b71a0>]}
[0m00:44:45.376892 [debug] [MainThread]: On master: ROLLBACK
[0m00:44:45.377903 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.378616 [debug] [MainThread]: On master: BEGIN
[0m00:44:45.379891 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:44:45.380590 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.381277 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.382153 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.383118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:44:45.383831 [debug] [MainThread]: On master: Close
[0m00:44:45.390087 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.391411 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_deal_changes ............... [RUN]
[0m00:44:45.392430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_deal_changes)
[0m00:44:45.393280 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.406663 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.407954 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.480067 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.481521 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.484135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m00:44:45.484960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:45.497128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.498234 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.499135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            deal_id,
                            CAST(change_time AS TIMESTAMP) change_dt,
                            changed_field_key,
                            new_value,
                            row_number() OVER (
                                PARTITION BY deal_id, changed_field_key, new_value,  change_time) AS rn

                    FROM "postgres"."public"."deal_changes"
)

SELECT 
      deal_id,
      change_dt,
      changed_field_key,
      new_value

FROM transformed
WHERE rn = 1
  );
[0m00:44:45.503094 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:44:45.514973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.516135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m00:44:45.517875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:45.523967 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.525059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m00:44:45.526764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:45.556871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m00:44:45.558036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.559077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m00:44:45.569412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m00:44:45.581451 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m00:44:45.591458 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.592714 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m00:44:45.595722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:44:45.600465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m00:44:45.603672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd8eaecc0>]}
[0m00:44:45.605246 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_deal_changes .......... [[32mCREATE VIEW[0m in 0.21s]
[0m00:44:45.606736 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.608931 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.609869 [debug] [MainThread]: On master: BEGIN
[0m00:44:45.610775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:44:45.623179 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.624210 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.625136 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.625954 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.627073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:44:45.627923 [debug] [MainThread]: On master: Close
[0m00:44:45.629944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:45.632387 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_changes' was properly closed.
[0m00:44:45.633513 [info ] [MainThread]: 
[0m00:44:45.634395 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m00:44:45.635794 [debug] [MainThread]: Command end result
[0m00:44:45.686004 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:44:45.695746 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:44:45.711247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:44:45.712273 [info ] [MainThread]: 
[0m00:44:45.713304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:45.716077 [info ] [MainThread]: 
[0m00:44:45.717025 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:44:45.719022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6012967, "process_in_blocks": "0", "process_kernel_time": 0.272472, "process_mem_max_rss": "140920", "process_out_blocks": "2744", "process_user_time": 4.729489}
[0m00:44:45.720026 [debug] [MainThread]: Command `cli run` succeeded at 00:44:45.719852 after 2.60 seconds
[0m00:44:45.720788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6d13bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6700da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6700a70>]}
[0m00:44:45.721493 [debug] [MainThread]: Flushing usage events
[0m00:44:46.138933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:42.451849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb875739040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb87575f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8758a6ea0>]}


============================== 01:16:42.455061 | 411f645b-9631-478e-b3b1-4a206d142d32 ==============================
[0m01:16:42.455061 [info ] [MainThread]: Running with dbt=1.10.0
[0m01:16:42.456001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:16:42.631343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8745f1850>]}
[0m01:16:42.701370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8751b2ed0>]}
[0m01:16:42.702838 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:16:42.883870 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m01:16:42.995132 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:16:42.995915 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m01:16:42.996469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8739f7bc0>]}
[0m01:16:44.051292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8731b0170>]}
[0m01:16:44.124791 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:16:44.134773 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:16:44.151288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8735b5d90>]}
[0m01:16:44.151987 [info ] [MainThread]: Found 8 models, 6 sources, 434 macros
[0m01:16:44.153125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb873554c80>]}
[0m01:16:44.156418 [info ] [MainThread]: 
[0m01:16:44.157492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:44.158185 [info ] [MainThread]: 
[0m01:16:44.159169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:16:44.160719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:16:44.253008 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:16:44.254038 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:16:44.254920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:44.268831 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m01:16:44.271255 [debug] [ThreadPool]: On list_postgres: Close
[0m01:16:44.282020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:16:44.292245 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:16:44.293097 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:16:44.293817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:44.306386 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:16:44.307266 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:16:44.307975 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:16:44.312772 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m01:16:44.315521 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:16:44.316610 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:16:44.333128 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.334718 [debug] [MainThread]: On master: BEGIN
[0m01:16:44.336652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:44.349212 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:16:44.350099 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.351982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:16:44.358306 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m01:16:44.361653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8731bf5f0>]}
[0m01:16:44.362565 [debug] [MainThread]: On master: ROLLBACK
[0m01:16:44.363550 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.364184 [debug] [MainThread]: On master: BEGIN
[0m01:16:44.366060 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:16:44.368840 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.369517 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.370179 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.371081 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:16:44.371768 [debug] [MainThread]: On master: Close
[0m01:16:44.379607 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m01:16:44.381801 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages ..................... [RUN]
[0m01:16:44.382827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages)
[0m01:16:44.384606 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m01:16:44.401755 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m01:16:44.403249 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m01:16:44.511201 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m01:16:44.512494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.516504 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m01:16:44.517201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:44.531589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:16:44.532589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.533937 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m01:16:44.537767 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:16:44.551644 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.553155 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m01:16:44.554825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:16:44.580918 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m01:16:44.581867 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.584403 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m01:16:44.590219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:16:44.613284 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m01:16:44.635918 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.636838 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m01:16:44.640460 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:16:44.650922 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m01:16:44.657159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb87797b1a0>]}
[0m01:16:44.659721 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages ................ [[32mCREATE VIEW[0m in 0.27s]
[0m01:16:44.661605 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m01:16:44.663515 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.665619 [debug] [MainThread]: On master: BEGIN
[0m01:16:44.666702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:44.686599 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:16:44.689721 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.690566 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.691350 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.694048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:16:44.696698 [debug] [MainThread]: On master: Close
[0m01:16:44.697639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:44.698502 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages' was properly closed.
[0m01:16:44.701005 [info ] [MainThread]: 
[0m01:16:44.701842 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m01:16:44.705557 [debug] [MainThread]: Command end result
[0m01:16:44.762705 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:16:44.766814 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:16:44.776912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m01:16:44.778145 [info ] [MainThread]: 
[0m01:16:44.779032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:44.779905 [info ] [MainThread]: 
[0m01:16:44.780681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:16:44.782359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.385294, "process_in_blocks": "0", "process_kernel_time": 0.243272, "process_mem_max_rss": "140924", "process_out_blocks": "2752", "process_user_time": 4.401736}
[0m01:16:44.783378 [debug] [MainThread]: Command `cli run` succeeded at 01:16:44.783220 after 2.39 seconds
[0m01:16:44.784180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8751b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8735cb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8735c8bc0>]}
[0m01:16:44.785055 [debug] [MainThread]: Flushing usage events
[0m01:16:45.194689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:37.874199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d68e0d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d68757440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d68e0d4f0>]}


============================== 22:59:37.877363 | 08ea783d-3c9f-41cf-ae1b-59fb5b11f43c ==============================
[0m22:59:37.877363 [info ] [MainThread]: Running with dbt=1.10.0
[0m22:59:37.878407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:59:38.002234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08ea783d-3c9f-41cf-ae1b-59fb5b11f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d6af4a030>]}
[0m22:59:38.013877 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:38.016383 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:38.018165 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19751708, "process_in_blocks": "1312", "process_kernel_time": 0.149058, "process_mem_max_rss": "116824", "process_out_blocks": "8", "process_user_time": 2.58567}
[0m22:59:38.019598 [debug] [MainThread]: Command `cli deps` succeeded at 22:59:38.019434 after 0.20 seconds
[0m22:59:38.020327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d687b2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d685ea2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d685ea270>]}
[0m22:59:38.021090 [debug] [MainThread]: Flushing usage events
[0m22:59:38.423097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:18.694705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b777b758e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b7774b5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b7774b67e0>]}


============================== 23:59:18.697823 | d500efd5-1076-4c4d-935c-3bdbf121cdd6 ==============================
[0m23:59:18.697823 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:59:18.698805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m23:59:18.856813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd500efd5-1076-4c4d-935c-3bdbf121cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b777a225d0>]}
[0m23:59:18.871874 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:59:18.873009 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:59:18.875940 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.23499177, "process_in_blocks": "328", "process_kernel_time": 0.15578, "process_mem_max_rss": "116772", "process_out_blocks": "16", "process_user_time": 2.459538}
[0m23:59:18.876874 [debug] [MainThread]: Command `cli deps` succeeded at 23:59:18.876715 after 0.24 seconds
[0m23:59:18.877702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b777b758e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b7771e30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b779215b50>]}
[0m23:59:18.878381 [debug] [MainThread]: Flushing usage events
[0m23:59:19.281812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:37.211734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca16bb6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca1681bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca164dd7f0>]}


============================== 00:29:37.214992 | 929eea1d-dd15-493d-a1d9-e183326e4ea0 ==============================
[0m00:29:37.214992 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:29:37.215939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m00:29:37.399161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca14f9f110>]}
[0m00:29:37.472200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca181105c0>]}
[0m00:29:37.473229 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:29:37.775871 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:29:37.854066 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:29:37.854899 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:29:37.855648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca161fc830>]}
[0m00:29:38.939630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca13b9c260>]}
[0m00:29:39.006849 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:29:39.025806 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:29:39.043484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca14359190>]}
[0m00:29:39.044474 [info ] [MainThread]: Found 8 models, 6 sources, 434 macros
[0m00:29:39.045617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca13f729c0>]}
[0m00:29:39.048316 [info ] [MainThread]: 
[0m00:29:39.049109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:39.049855 [info ] [MainThread]: 
[0m00:29:39.052868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:39.054255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:29:39.112121 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:29:39.113070 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:29:39.113788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:39.142645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m00:29:39.145342 [debug] [ThreadPool]: On list_postgres: Close
[0m00:29:39.155120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:29:39.164870 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:29:39.165603 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:29:39.166267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:39.177680 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:29:39.178553 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:29:39.179371 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:29:39.200487 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m00:29:39.205324 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:29:39.209372 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:29:39.220498 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.221416 [debug] [MainThread]: On master: BEGIN
[0m00:29:39.222185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:39.235473 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:29:39.237138 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.238051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:29:39.246709 [debug] [MainThread]: SQL status: SELECT 10 in 0.008 seconds
[0m00:29:39.250466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca12634e90>]}
[0m00:29:39.251416 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:39.252414 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.253182 [debug] [MainThread]: On master: BEGIN
[0m00:29:39.254304 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:29:39.255028 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.255750 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.256458 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.257313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:39.258035 [debug] [MainThread]: On master: Close
[0m00:29:39.264374 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m00:29:39.265465 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages ..................... [RUN]
[0m00:29:39.266473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages)
[0m00:29:39.267307 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m00:29:39.281797 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m00:29:39.284725 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m00:29:39.355176 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m00:29:39.357814 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.358858 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m00:29:39.359737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:39.371211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:29:39.372016 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.372886 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH
users AS (
			SELECT 
				  deal_id,
				   new_value :: INT AS user_id,
				   change_dt AS assigned_user_start,
				   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end
			FROM "postgres"."pipedrive_analytics"."stg_deal_changes"
			WHERE TRUE 
				AND  changed_field_key= 'user_id'
) 
, 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name,
                u.user_id,
                u.assigned_user_start,
                u.assigned_user_end
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         LEFT JOIN users u                       ON dc.deal_id = u.deal_id 
					                                AND dc.change_dt >= u.assigned_user_start
					                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m00:29:39.448150 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.074 seconds
[0m00:29:39.458654 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.459484 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages" rename to "int_stages__dbt_backup"
[0m00:29:39.460909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:29:39.466178 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.466955 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m00:29:39.468335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:29:39.496342 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m00:29:39.497441 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.498360 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m00:29:39.501864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:29:39.512285 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m00:29:39.521023 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.521877 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m00:29:39.525717 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m00:29:39.529723 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m00:29:39.536232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca18332000>]}
[0m00:29:39.537472 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages ................ [[32mCREATE VIEW[0m in 0.27s]
[0m00:29:39.538684 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m00:29:39.540555 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.541372 [debug] [MainThread]: On master: BEGIN
[0m00:29:39.542128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:39.553077 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:29:39.553786 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.554488 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.555175 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.555942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:39.556638 [debug] [MainThread]: On master: Close
[0m00:29:39.557467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:39.558090 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages' was properly closed.
[0m00:29:39.560925 [info ] [MainThread]: 
[0m00:29:39.561671 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:29:39.562969 [debug] [MainThread]: Command end result
[0m00:29:39.627266 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:29:39.635901 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:29:39.646916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:29:39.647685 [info ] [MainThread]: 
[0m00:29:39.648988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:39.649678 [info ] [MainThread]: 
[0m00:29:39.650400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:29:39.651925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.49394, "process_in_blocks": "1368", "process_kernel_time": 0.257279, "process_mem_max_rss": "141360", "process_out_blocks": "2760", "process_user_time": 4.377741}
[0m00:29:39.652854 [debug] [MainThread]: Command `cli run` succeeded at 00:29:39.652697 after 2.50 seconds
[0m00:29:39.653634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca161ffbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca15b6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca1681ba40>]}
[0m00:29:39.654410 [debug] [MainThread]: Flushing usage events
[0m00:29:40.076824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:38.409626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5d7bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec6359d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5d7bec0>]}


============================== 01:18:38.412961 | 3f79b6aa-6445-4046-816d-d547ab8fa236 ==============================
[0m01:18:38.412961 [info ] [MainThread]: Running with dbt=1.10.0
[0m01:18:38.414010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:38.620804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec47b7aa0>]}
[0m01:18:38.682522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec56ca2d0>]}
[0m01:18:38.683514 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:18:38.860529 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m01:18:38.967013 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:18:38.967881 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m01:18:38.968654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5dad8b0>]}
[0m01:18:40.022823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec2b094c0>]}
[0m01:18:40.090184 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:18:40.101423 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:18:40.114590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec37b2c30>]}
[0m01:18:40.115486 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m01:18:40.116211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5b31f70>]}
[0m01:18:40.118890 [info ] [MainThread]: 
[0m01:18:40.119632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:40.120298 [info ] [MainThread]: 
[0m01:18:40.121182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:40.123181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:18:40.183904 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:18:40.184838 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:18:40.185616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:40.213319 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m01:18:40.215913 [debug] [ThreadPool]: On list_postgres: Close
[0m01:18:40.225664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:18:40.235608 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:18:40.236357 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:18:40.237059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:40.248349 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:18:40.249090 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:18:40.249847 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:18:40.254082 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m01:18:40.256598 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:18:40.257532 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:18:40.268835 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.269601 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.270295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:40.287138 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:18:40.288855 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.289752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:18:40.294877 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m01:18:40.298607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec20688f0>]}
[0m01:18:40.299487 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:40.300437 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.301135 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.302232 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:18:40.302857 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.303487 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.304074 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.305012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:40.305681 [debug] [MainThread]: On master: Close
[0m01:18:40.310902 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.311907 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages_anmly ............... [RUN]
[0m01:18:40.312776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages_anmly)
[0m01:18:40.313552 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.325558 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.326781 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.383441 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.384957 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.385928 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: BEGIN
[0m01:18:40.386732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:40.397797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:18:40.398606 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.399417 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */

  create view "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp"
    
    
  as (
    

WITH 
stages AS (
			SELECT 
				  *,
				  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
				  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,
				  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn
				  
			FROM "postgres"."pipedrive_analytics"."int_stages" 			
)

, stages_anmly AS (
					SELECT 
						   *,
						   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg
								
					FROM stages
)

SELECT *
FROM stages_anmly
  );
[0m01:18:40.416450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m01:18:40.442383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.445516 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
alter table "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp" rename to "int_stages_anmly"
[0m01:18:40.449083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:40.494211 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m01:18:40.495824 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.496755 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m01:18:40.499453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:18:40.510355 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup"
[0m01:18:40.518977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.519871 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup" cascade
[0m01:18:40.521143 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:18:40.525125 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: Close
[0m01:18:40.527840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec7ec2ea0>]}
[0m01:18:40.531551 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages_anmly .......... [[32mCREATE VIEW[0m in 0.21s]
[0m01:18:40.532727 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.534566 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.535454 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.536287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:40.546973 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:18:40.547796 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.548595 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.549347 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.550266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:40.551044 [debug] [MainThread]: On master: Close
[0m01:18:40.551950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:40.554608 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages_anmly' was properly closed.
[0m01:18:40.555471 [info ] [MainThread]: 
[0m01:18:40.556272 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:18:40.557615 [debug] [MainThread]: Command end result
[0m01:18:40.609934 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:18:40.614123 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:18:40.624160 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m01:18:40.625039 [info ] [MainThread]: 
[0m01:18:40.625964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:40.626724 [info ] [MainThread]: 
[0m01:18:40.627548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:18:40.629927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2824123, "process_in_blocks": "112", "process_kernel_time": 0.245118, "process_mem_max_rss": "141204", "process_out_blocks": "2768", "process_user_time": 4.22879}
[0m01:18:40.631518 [debug] [MainThread]: Command `cli run` succeeded at 01:18:40.631352 after 2.28 seconds
[0m01:18:40.632401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5c45820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5daddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec64d5970>]}
[0m01:18:40.633281 [debug] [MainThread]: Flushing usage events
[0m01:18:41.070183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:06:51.910178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3cf13740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3d5cb0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3d01d5b0>]}


============================== 02:06:51.913866 | fa9dace0-643c-4c1a-841c-7c58d3be74fa ==============================
[0m02:06:51.913866 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:06:51.914738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:06:52.095234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3efb7ce0>]}
[0m02:06:52.156677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3bb5c920>]}
[0m02:06:52.157657 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:06:52.317421 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:06:52.393319 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:06:52.393978 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:06:52.394555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3cea18b0>]}
[0m02:06:54.079072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3a7c9fd0>]}
[0m02:06:54.259520 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:06:54.269602 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:06:54.282840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3abbb890>]}
[0m02:06:54.283458 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:06:54.284007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3a757800>]}
[0m02:06:54.286204 [info ] [MainThread]: 
[0m02:06:54.287084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:06:54.287844 [info ] [MainThread]: 
[0m02:06:54.288552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:06:54.289679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:06:54.340737 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:06:54.341774 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:06:54.342669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:54.356749 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:06:54.359264 [debug] [ThreadPool]: On list_postgres: Close
[0m02:06:54.372388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:06:54.378871 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:06:54.379419 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:06:54.379820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:54.386823 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:06:54.387315 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:06:54.387783 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:06:54.390653 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m02:06:54.392153 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:06:54.392799 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:06:54.399203 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.399666 [debug] [MainThread]: On master: BEGIN
[0m02:06:54.400079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:54.407199 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:06:54.407674 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.408168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:06:54.411429 [debug] [MainThread]: SQL status: SELECT 11 in 0.003 seconds
[0m02:06:54.413698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3af733b0>]}
[0m02:06:54.414259 [debug] [MainThread]: On master: ROLLBACK
[0m02:06:54.414878 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.415337 [debug] [MainThread]: On master: BEGIN
[0m02:06:54.416284 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:06:54.416881 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.417662 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.418597 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.419520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:06:54.420044 [debug] [MainThread]: On master: Close
[0m02:06:54.423601 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.424267 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity_types ............. [RUN]
[0m02:06:54.424967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m02:06:54.425561 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.435183 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.436010 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.468241 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.469156 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.469753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:06:54.470240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:54.477453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:06:54.477965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.478499 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE 
                       		 WHEN name= 'Sales Call 1' THEN 'Step 2.1'
                       		 WHEN name= 'Sales Call 2' THEN 'Step 3.1'
                  	     END 				AS funnel_step,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
)

SELECT *
FROM transformed
  );
[0m02:06:54.480720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m02:06:54.486837 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.487350 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:06:54.488242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:06:54.491244 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.491729 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:06:54.492576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:06:54.508086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:06:54.508683 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.509177 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:06:54.520560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m02:06:54.529796 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:06:54.535192 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.535773 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:06:54.538054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m02:06:54.540544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:06:54.544007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3d59fda0>]}
[0m02:06:54.544785 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity_types ........ [[32mCREATE VIEW[0m in 0.12s]
[0m02:06:54.545705 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.547212 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.547943 [debug] [MainThread]: On master: BEGIN
[0m02:06:54.548729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:06:54.557602 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:06:54.558397 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.559144 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.559901 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.560828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:06:54.561582 [debug] [MainThread]: On master: Close
[0m02:06:54.564472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:54.565169 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity_types' was properly closed.
[0m02:06:54.566174 [info ] [MainThread]: 
[0m02:06:54.566979 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:06:54.568277 [debug] [MainThread]: Command end result
[0m02:06:54.607981 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:06:54.611643 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:06:54.622290 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:06:54.623300 [info ] [MainThread]: 
[0m02:06:54.624704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:06:54.625768 [info ] [MainThread]: 
[0m02:06:54.626836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:06:54.628994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7797508, "process_in_blocks": "32", "process_kernel_time": 0.252017, "process_mem_max_rss": "141020", "process_out_blocks": "2784", "process_user_time": 4.867717}
[0m02:06:54.630173 [debug] [MainThread]: Command `cli run` succeeded at 02:06:54.630001 after 2.78 seconds
[0m02:06:54.631507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3cef4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3b3f97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3b7371d0>]}
[0m02:06:54.632444 [debug] [MainThread]: Flushing usage events
[0m02:06:55.016018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:07:50.797980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3187464c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3185d6c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31869fec30>]}


============================== 02:07:50.801202 | fa2d7884-76cf-4421-9982-433fec852894 ==============================
[0m02:07:50.801202 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:07:50.802131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:07:51.074805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31851e4b30>]}
[0m02:07:51.143364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31867195e0>]}
[0m02:07:51.144431 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:07:51.302816 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:07:51.378372 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:07:51.379026 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:07:51.379606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3186400fb0>]}
[0m02:07:52.515070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a318390d3a0>]}
[0m02:07:52.601923 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:07:52.618361 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:07:52.640599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31849f4aa0>]}
[0m02:07:52.641587 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:07:52.643392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a318393d4f0>]}
[0m02:07:52.646237 [info ] [MainThread]: 
[0m02:07:52.649333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:07:52.649986 [info ] [MainThread]: 
[0m02:07:52.652415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:07:52.654292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:07:52.718626 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:07:52.719525 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:07:52.720297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:52.734551 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:07:52.736848 [debug] [ThreadPool]: On list_postgres: Close
[0m02:07:52.746034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:07:52.755378 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:07:52.756090 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:07:52.756765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:52.767795 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m02:07:52.768528 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:07:52.769261 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:07:52.773269 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m02:07:52.775753 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:07:52.776684 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:07:52.789272 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.790033 [debug] [MainThread]: On master: BEGIN
[0m02:07:52.790690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:07:52.801689 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:07:52.802417 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.803265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:07:52.808144 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m02:07:52.811453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31845b94c0>]}
[0m02:07:52.812335 [debug] [MainThread]: On master: ROLLBACK
[0m02:07:52.813306 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.814001 [debug] [MainThread]: On master: BEGIN
[0m02:07:52.815174 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:07:52.815872 [debug] [MainThread]: On master: COMMIT
[0m02:07:52.816611 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.817332 [debug] [MainThread]: On master: COMMIT
[0m02:07:52.818205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:52.818897 [debug] [MainThread]: On master: Close
[0m02:07:52.824252 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m02:07:52.825295 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_activites .................. [RUN]
[0m02:07:52.826266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_activites)
[0m02:07:52.827101 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m02:07:52.839503 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m02:07:52.840878 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m02:07:52.926913 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activites"
[0m02:07:52.928542 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.929461 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: BEGIN
[0m02:07:52.930278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:52.941647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:07:52.942446 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.943293 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */

  create view "postgres"."pipedrive_analytics"."int_activites__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
          SELECT 
                ac.activity_id,
                ac.deal_id,
                ac.type,
                act.name,
                act.funnel_step,
                ac.assigned_to_user,
                ac.due_to_dt,
                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month
                
          FROM "postgres"."pipedrive_analytics"."stg_activity" ac
          LEFT JOIN "postgres"."pipedrive_analytics"."stg_activity_types" act ON ac.type = act.type
          WHERE TRUE 
              AND ac.done
              AND act.name IN ('Sales Call 1', 'Sales Call 2')
)

SELECT *
FROM base
  );
[0m02:07:52.947750 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m02:07:52.958246 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.959085 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
alter table "postgres"."pipedrive_analytics"."int_activites__dbt_tmp" rename to "int_activites"
[0m02:07:52.961964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:07:52.986911 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m02:07:52.987893 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.988762 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m02:07:52.990455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:07:53.000648 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_activites__dbt_backup"
[0m02:07:53.012075 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:53.012975 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
drop view if exists "postgres"."pipedrive_analytics"."int_activites__dbt_backup" cascade
[0m02:07:53.014287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:07:53.018194 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: Close
[0m02:07:53.021104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3188536240>]}
[0m02:07:53.024847 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_activites ............. [[32mCREATE VIEW[0m in 0.19s]
[0m02:07:53.026063 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m02:07:53.027853 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:53.028603 [debug] [MainThread]: On master: BEGIN
[0m02:07:53.029334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:53.040307 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:07:53.041058 [debug] [MainThread]: On master: COMMIT
[0m02:07:53.041837 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:53.042569 [debug] [MainThread]: On master: COMMIT
[0m02:07:53.043420 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:53.044088 [debug] [MainThread]: On master: Close
[0m02:07:53.044892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:53.047653 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_activites' was properly closed.
[0m02:07:53.048478 [info ] [MainThread]: 
[0m02:07:53.049260 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:07:53.050594 [debug] [MainThread]: Command end result
[0m02:07:53.087365 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:07:53.090438 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:07:53.099203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:07:53.099983 [info ] [MainThread]: 
[0m02:07:53.100843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:07:53.101576 [info ] [MainThread]: 
[0m02:07:53.102348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:07:53.103925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.36406, "process_in_blocks": "0", "process_kernel_time": 0.239998, "process_mem_max_rss": "140828", "process_out_blocks": "2784", "process_user_time": 4.404617}
[0m02:07:53.104880 [debug] [MainThread]: Command `cli run` succeeded at 02:07:53.104722 after 2.37 seconds
[0m02:07:53.105704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3186401430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31869c5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31869c54c0>]}
[0m02:07:53.106520 [debug] [MainThread]: Flushing usage events
[0m02:07:53.509679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:41.950926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d91419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d8f54710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11db468aa0>]}


============================== 02:09:41.954184 | dbea45df-6047-4c94-95f8-67984ed3a8f7 ==============================
[0m02:09:41.954184 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:09:41.955026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:09:42.124335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11db225370>]}
[0m02:09:42.185609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11daf5cce0>]}
[0m02:09:42.186627 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:09:42.378424 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:09:42.455396 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:09:42.456092 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:09:42.456627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d90e6d50>]}
[0m02:09:43.541674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d6dfd520>]}
[0m02:09:43.617619 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:09:43.634430 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:09:43.672011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d817da60>]}
[0m02:09:43.675767 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:09:43.678404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d7508710>]}
[0m02:09:43.683400 [info ] [MainThread]: 
[0m02:09:43.684429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:43.685697 [info ] [MainThread]: 
[0m02:09:43.687600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:09:43.696350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:09:43.784193 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:09:43.786260 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:09:43.786994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:43.800839 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:09:43.803049 [debug] [ThreadPool]: On list_postgres: Close
[0m02:09:43.810334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:09:43.825995 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:09:43.826775 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:09:43.829199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:43.840197 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m02:09:43.840848 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:09:43.841562 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:09:43.850060 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m02:09:43.853153 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:09:43.854371 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:09:43.871341 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.872074 [debug] [MainThread]: On master: BEGIN
[0m02:09:43.872764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:43.896056 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m02:09:43.896982 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.899052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:09:43.911303 [debug] [MainThread]: SQL status: SELECT 11 in 0.010 seconds
[0m02:09:43.921658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d71967b0>]}
[0m02:09:43.925562 [debug] [MainThread]: On master: ROLLBACK
[0m02:09:43.927922 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.929596 [debug] [MainThread]: On master: BEGIN
[0m02:09:43.932784 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:09:43.934335 [debug] [MainThread]: On master: COMMIT
[0m02:09:43.936287 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.937003 [debug] [MainThread]: On master: COMMIT
[0m02:09:43.939513 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:09:43.940263 [debug] [MainThread]: On master: Close
[0m02:09:43.952597 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:09:43.955207 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_stages ..................... [RUN]
[0m02:09:43.960621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_stages)
[0m02:09:43.962510 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:09:43.998169 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:09:44.003937 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:09:44.085736 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:09:44.087559 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.088535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:09:44.089452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:44.111478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:09:44.113050 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.116127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            stage_id,
                            stage_name,
                            CASE 
	                            WHEN stage_name= 'Lead Generation'              THEN 'Step 1'
	                            WHEN stage_name= 'Qualified lead'               THEN 'Step 2'
	                            WHEN stage_name= 'Needs Assessment'             THEN 'Step 3'
	                            WHEN stage_name= 'Proposal/Quote Preparation'   THEN 'Step 4'
	                            WHEN stage_name= 'Negotiation'                  THEN 'Step 5'
	                            WHEN stage_name= 'Closing'                      THEN 'Step 6'
	                            WHEN stage_name= 'Implementation/Onboarding'    THEN 'Step 7'
	                            WHEN stage_name= 'Follow-up/Customer Success'   THEN 'Step 8'
	                            WHEN stage_name= 'Renewal/Expansion'            THEN 'Step 9'
                            END AS funnel_step

                    FROM "postgres"."public"."stages"
)

SELECT *
FROM transformed
  );
[0m02:09:44.130520 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m02:09:44.149003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.150040 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:09:44.151606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:09:44.156900 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.157752 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:09:44.159201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:09:44.236085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:09:44.242598 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.244673 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:09:44.261833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m02:09:44.275643 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:09:44.284339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.285259 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:09:44.292173 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m02:09:44.296186 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:09:44.300960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11db224650>]}
[0m02:09:44.302850 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_stages ................ [[32mCREATE VIEW[0m in 0.34s]
[0m02:09:44.304058 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:09:44.305915 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:44.306701 [debug] [MainThread]: On master: BEGIN
[0m02:09:44.307431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:44.319424 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m02:09:44.320378 [debug] [MainThread]: On master: COMMIT
[0m02:09:44.321155 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:44.321873 [debug] [MainThread]: On master: COMMIT
[0m02:09:44.322749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:09:44.323511 [debug] [MainThread]: On master: Close
[0m02:09:44.328781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:44.330309 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_stages' was properly closed.
[0m02:09:44.331082 [info ] [MainThread]: 
[0m02:09:44.331866 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m02:09:44.333179 [debug] [MainThread]: Command end result
[0m02:09:44.379504 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:09:44.382756 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:09:44.392158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:09:44.393036 [info ] [MainThread]: 
[0m02:09:44.394384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:44.395093 [info ] [MainThread]: 
[0m02:09:44.395880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:09:44.397508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5025914, "process_in_blocks": "0", "process_kernel_time": 0.243996, "process_mem_max_rss": "141328", "process_out_blocks": "2792", "process_user_time": 4.269932}
[0m02:09:44.398461 [debug] [MainThread]: Command `cli run` succeeded at 02:09:44.398301 after 2.50 seconds
[0m02:09:44.399285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11da3b6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11da3b4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11da3b6cc0>]}
[0m02:09:44.400099 [debug] [MainThread]: Flushing usage events
[0m02:09:44.818560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:10:43.883146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a46b64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a42e97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a441eb10>]}


============================== 02:10:43.886333 | a956d90f-63d5-4fc1-a5bd-a85f3fef0013 ==============================
[0m02:10:43.886333 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:10:43.887259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:10:44.081466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a5e77770>]}
[0m02:10:44.143658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a362ffe0>]}
[0m02:10:44.144648 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:10:44.325182 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:10:44.401765 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:10:44.402464 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:10:44.403043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a2cd2fc0>]}
[0m02:10:45.646788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a196a480>]}
[0m02:10:45.775540 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:10:45.788038 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:10:45.807739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a2163950>]}
[0m02:10:45.808705 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:10:45.809458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a19ec1d0>]}
[0m02:10:45.812114 [info ] [MainThread]: 
[0m02:10:45.812902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:10:45.813666 [info ] [MainThread]: 
[0m02:10:45.814692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:10:45.816189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:10:45.873253 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:10:45.874238 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:10:45.875084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:10:45.888915 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:10:45.891295 [debug] [ThreadPool]: On list_postgres: Close
[0m02:10:45.900580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:10:45.914680 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:10:45.917136 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:10:45.917872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:10:45.937155 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m02:10:45.939422 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:10:45.942271 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:10:45.949499 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m02:10:45.952136 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:10:45.953275 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:10:45.963231 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.963912 [debug] [MainThread]: On master: BEGIN
[0m02:10:45.964593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:10:45.975758 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:10:45.976495 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.977265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:10:45.982409 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m02:10:45.985464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a21cbc80>]}
[0m02:10:45.986299 [debug] [MainThread]: On master: ROLLBACK
[0m02:10:45.987360 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.988085 [debug] [MainThread]: On master: BEGIN
[0m02:10:45.989258 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:10:45.989955 [debug] [MainThread]: On master: COMMIT
[0m02:10:45.990703 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.991418 [debug] [MainThread]: On master: COMMIT
[0m02:10:45.992311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:10:45.993030 [debug] [MainThread]: On master: Close
[0m02:10:45.998553 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m02:10:45.999624 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages ..................... [RUN]
[0m02:10:46.000613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages)
[0m02:10:46.001472 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m02:10:46.015077 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m02:10:46.016158 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m02:10:46.077154 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m02:10:46.078849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.079715 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m02:10:46.080935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:10:46.095145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m02:10:46.095998 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.096905 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH
users AS (
			SELECT 
				  deal_id,
				   new_value :: INT AS user_id,
				   change_dt AS assigned_user_start,
				   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end
			FROM "postgres"."pipedrive_analytics"."stg_deal_changes"
			WHERE TRUE 
				AND  changed_field_key= 'user_id'
) 
, 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name,
                s.funnel_step,
                u.user_id,
                u.assigned_user_start,
                u.assigned_user_end
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         LEFT JOIN users u                       ON dc.deal_id = u.deal_id 
					                                AND dc.change_dt >= u.assigned_user_start
					                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m02:10:46.101646 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m02:10:46.119162 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.120026 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m02:10:46.121508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:10:46.146960 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m02:10:46.150035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.150857 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m02:10:46.152479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:10:46.162766 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m02:10:46.171155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.171958 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m02:10:46.173137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:10:46.177171 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m02:10:46.182789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a5e768d0>]}
[0m02:10:46.183978 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages ................ [[32mCREATE VIEW[0m in 0.18s]
[0m02:10:46.185148 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m02:10:46.187011 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:46.187800 [debug] [MainThread]: On master: BEGIN
[0m02:10:46.188586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:10:46.202243 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m02:10:46.202972 [debug] [MainThread]: On master: COMMIT
[0m02:10:46.203679 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:46.204339 [debug] [MainThread]: On master: COMMIT
[0m02:10:46.205145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:10:46.205874 [debug] [MainThread]: On master: Close
[0m02:10:46.206781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:10:46.209745 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages' was properly closed.
[0m02:10:46.210564 [info ] [MainThread]: 
[0m02:10:46.211304 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:10:46.212547 [debug] [MainThread]: Command end result
[0m02:10:46.245992 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:10:46.249071 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:10:46.259198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:10:46.259904 [info ] [MainThread]: 
[0m02:10:46.260679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:10:46.261391 [info ] [MainThread]: 
[0m02:10:46.262061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:10:46.263598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4340403, "process_in_blocks": "0", "process_kernel_time": 0.256713, "process_mem_max_rss": "140816", "process_out_blocks": "2792", "process_user_time": 4.533612}
[0m02:10:46.264577 [debug] [MainThread]: Command `cli run` succeeded at 02:10:46.264366 after 2.44 seconds
[0m02:10:46.265452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a35d4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a3d3e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a4390170>]}
[0m02:10:46.266184 [debug] [MainThread]: Flushing usage events
[0m02:10:46.681115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:11:11.518694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c9195b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c907bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c997b230>]}


============================== 02:11:11.523570 | 85eabc3f-437d-4b76-9872-eb4f4a239696 ==============================
[0m02:11:11.523570 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:11:11.525056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:11:11.706047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb57f170>]}
[0m02:11:11.780290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb35cd70>]}
[0m02:11:11.781724 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:11:11.950732 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:11:12.053999 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:11:12.054732 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:11:12.055293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c75fb170>]}
[0m02:11:13.213488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c6deeea0>]}
[0m02:11:13.334071 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:11:13.348081 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:11:13.367923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c81b1760>]}
[0m02:11:13.368985 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:11:13.369810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c9f08620>]}
[0m02:11:13.373676 [info ] [MainThread]: 
[0m02:11:13.374475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:11:13.375210 [info ] [MainThread]: 
[0m02:11:13.376195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:11:13.377691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:11:13.432978 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:11:13.434011 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:11:13.434833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:13.449459 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m02:11:13.451845 [debug] [ThreadPool]: On list_postgres: Close
[0m02:11:13.461145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:11:13.470923 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:11:13.471753 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:11:13.472529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:13.490558 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m02:11:13.491736 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:11:13.492455 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:11:13.505410 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m02:11:13.511151 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:11:13.514546 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:11:13.529559 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.532357 [debug] [MainThread]: On master: BEGIN
[0m02:11:13.534350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:11:13.554719 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m02:11:13.557508 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.558447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:11:13.568836 [debug] [MainThread]: SQL status: SELECT 10 in 0.007 seconds
[0m02:11:13.575702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c81b0770>]}
[0m02:11:13.576576 [debug] [MainThread]: On master: ROLLBACK
[0m02:11:13.581375 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.582090 [debug] [MainThread]: On master: BEGIN
[0m02:11:13.585652 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:11:13.586429 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.589324 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.590002 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.590975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:13.591695 [debug] [MainThread]: On master: Close
[0m02:11:13.594748 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.595719 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages_anmly ............... [RUN]
[0m02:11:13.596574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages_anmly)
[0m02:11:13.597406 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.610327 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.611689 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.668620 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.670431 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.671315 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: BEGIN
[0m02:11:13.672146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:13.683229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:11:13.683973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.684778 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */

  create view "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp"
    
    
  as (
    

WITH 
stages AS (
			SELECT 
				  *,
				  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
				  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,
				  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn
				  
			FROM "postgres"."pipedrive_analytics"."int_stages" 			
)

, stages_anmly AS (
					SELECT 
						   *,
						   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg
								
					FROM stages
)

SELECT *
FROM stages_anmly
  );
[0m02:11:13.688733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m02:11:13.699328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.700161 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
alter table "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp" rename to "int_stages_anmly"
[0m02:11:13.701611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:11:13.725262 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m02:11:13.726180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.727053 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m02:11:13.732537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m02:11:13.744884 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup"
[0m02:11:13.753466 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.754416 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup" cascade
[0m02:11:13.755747 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:11:13.759757 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: Close
[0m02:11:13.762311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb57e2a0>]}
[0m02:11:13.763544 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages_anmly .......... [[32mCREATE VIEW[0m in 0.16s]
[0m02:11:13.764732 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.766531 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.767319 [debug] [MainThread]: On master: BEGIN
[0m02:11:13.768053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:11:13.778576 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:11:13.779382 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.780112 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.780879 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.781749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:13.782510 [debug] [MainThread]: On master: Close
[0m02:11:13.785242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:13.785982 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages_anmly' was properly closed.
[0m02:11:13.786782 [info ] [MainThread]: 
[0m02:11:13.787654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:11:13.789007 [debug] [MainThread]: Command end result
[0m02:11:13.825894 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:11:13.828763 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:11:13.837706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:11:13.838384 [info ] [MainThread]: 
[0m02:11:13.839132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:11:13.840019 [info ] [MainThread]: 
[0m02:11:13.840835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:11:13.842419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4022744, "process_in_blocks": "0", "process_kernel_time": 0.245161, "process_mem_max_rss": "141204", "process_out_blocks": "2792", "process_user_time": 4.359097}
[0m02:11:13.843398 [debug] [MainThread]: Command `cli run` succeeded at 02:11:13.843243 after 2.40 seconds
[0m02:11:13.844250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c9195b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c8cdd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb7c26c0>]}
[0m02:11:13.845079 [debug] [MainThread]: Flushing usage events
[0m02:11:14.225711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:27.963692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069442f89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706944e460c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706944e46390>]}


============================== 02:37:27.966817 | cfa85106-6fbe-4d04-82cf-078156565999 ==============================
[0m02:37:27.966817 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:37:27.967726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m02:37:28.138540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069464c0410>]}
[0m02:37:28.200136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069440732f0>]}
[0m02:37:28.201136 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:37:28.356509 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:37:28.432140 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:37:28.432828 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:37:28.433368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069421cbc50>]}
[0m02:37:29.396044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706941978c80>]}
[0m02:37:29.564772 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:37:29.575474 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:37:29.591559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069419e97f0>]}
[0m02:37:29.592349 [info ] [MainThread]: Found 11 models, 6 sources, 434 macros
[0m02:37:29.593086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069419d87a0>]}
[0m02:37:29.595836 [info ] [MainThread]: 
[0m02:37:29.596550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:37:29.597077 [info ] [MainThread]: 
[0m02:37:29.597875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:37:29.599314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:37:29.646229 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:37:29.646823 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:37:29.647275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:29.656515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m02:37:29.658848 [debug] [ThreadPool]: On list_postgres: Close
[0m02:37:29.666696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:37:29.672895 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:37:29.673342 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:37:29.673739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:29.680498 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:37:29.680957 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:37:29.681420 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:37:29.684125 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m02:37:29.685587 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:37:29.686182 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:37:29.692764 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.693181 [debug] [MainThread]: On master: BEGIN
[0m02:37:29.693610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:37:29.700263 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:37:29.700727 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.701203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:37:29.704429 [debug] [MainThread]: SQL status: SELECT 11 in 0.003 seconds
[0m02:37:29.706633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70694626e030>]}
[0m02:37:29.707159 [debug] [MainThread]: On master: ROLLBACK
[0m02:37:29.707798 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.708205 [debug] [MainThread]: On master: BEGIN
[0m02:37:29.708902 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:37:29.709337 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.709763 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.710152 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.710695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:37:29.711091 [debug] [MainThread]: On master: Close
[0m02:37:29.713521 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.714232 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_sales_funnel ............... [RUN]
[0m02:37:29.714916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_sales_funnel)
[0m02:37:29.715424 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.726359 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.727763 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.784885 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.786671 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.787675 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: BEGIN
[0m02:37:29.788529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:37:29.800318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:37:29.801099 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.801923 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */

  create view "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp"
    
    
  as (
    

WITH 
avtivities AS (
		   		SELECT 
				   	   deal_id,
					   name				AS kpi_name,
					   funnel_step,
					   assigned_to_user AS user_id,
					   due_to_dt		AS change_dt,
					   month,
					   0 				AS anmly_flg
		   		
				FROM "postgres"."pipedrive_analytics"."int_activites"
)
, stages AS (
			  SELECT 
			  		 deal_id,
			  		 stage_name			AS kpi_name,
					 funnel_step,
					 user_id,
					 change_dt,
					 month,
					 anmly_flg
			  FROM "postgres"."pipedrive_analytics"."int_stages_anmly"
)

,stg_funnel AS ( 
			    SELECT * FROM avtivities 
			    UNION ALL
			    SELECT * FROM stages
)

, int_funnel AS (
				  SELECT *,
						 LAG(funnel_step) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
						 LAG(user_id)     OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user
						   
				  FROM stg_funnel
)

, final_funnel AS (
					SELECT *,
						   CASE 
						   		WHEN funnel_step= 'Step 2.1' AND COALESCE(prev_step, 'n') <> 'Step 2' AND user_id = prev_user THEN 1
						   		WHEN funnel_step= 'Step 3.1' AND COALESCE(prev_step, 'n') <> 'Step 3' AND user_id = prev_user THEN 1
								ELSE anmly_flg
						   END AS funnel_anmly_flg
					FROM int_funnel 
)

SELECT *
FROM final_funnel
  );
[0m02:37:29.807878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m02:37:29.818529 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.819036 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
alter table "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp" rename to "int_sales_funnel"
[0m02:37:29.819994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:37:29.834608 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m02:37:29.835124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.835608 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m02:37:29.836919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:37:29.842801 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup"
[0m02:37:29.847932 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.848455 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
drop view if exists "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup" cascade
[0m02:37:29.849266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:37:29.851692 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: Close
[0m02:37:29.853920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70694649b3b0>]}
[0m02:37:29.854982 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_sales_funnel .......... [[32mCREATE VIEW[0m in 0.14s]
[0m02:37:29.856110 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.857845 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.858537 [debug] [MainThread]: On master: BEGIN
[0m02:37:29.859155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:37:29.874292 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m02:37:29.875136 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.875889 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.877500 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.878411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:37:29.880942 [debug] [MainThread]: On master: Close
[0m02:37:29.881674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:29.882356 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_sales_funnel' was properly closed.
[0m02:37:29.882999 [info ] [MainThread]: 
[0m02:37:29.883958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m02:37:29.885130 [debug] [MainThread]: Command end result
[0m02:37:29.930729 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:37:29.934708 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:37:29.942331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:37:29.943046 [info ] [MainThread]: 
[0m02:37:29.943992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:37:29.945095 [info ] [MainThread]: 
[0m02:37:29.946027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:37:29.947828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.064913, "process_in_blocks": "0", "process_kernel_time": 0.261554, "process_mem_max_rss": "140932", "process_out_blocks": "2832", "process_user_time": 4.276371}
[0m02:37:29.949573 [debug] [MainThread]: Command `cli run` succeeded at 02:37:29.949407 after 2.07 seconds
[0m02:37:29.950429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069440b6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706941d7d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706943f90800>]}
[0m02:37:29.951300 [debug] [MainThread]: Flushing usage events
[0m02:37:30.317980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:40:52.827772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b423f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b28dd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b529f6e0>]}


============================== 02:40:52.830902 | fb409331-9dc6-48eb-957d-3b354f172c9a ==============================
[0m02:40:52.830902 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:40:52.831793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:40:53.002557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b1b159a0>]}
[0m02:40:53.065507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b359f230>]}
[0m02:40:53.066512 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:40:53.236195 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:40:53.314656 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:40:53.315335 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:40:53.316020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b2f39ee0>]}
[0m02:40:54.266911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b07694f0>]}
[0m02:40:54.424296 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:40:54.436148 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:40:54.452444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b072d0a0>]}
[0m02:40:54.453364 [info ] [MainThread]: Found 12 models, 6 sources, 434 macros
[0m02:40:54.454098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b4e3deb0>]}
[0m02:40:54.457630 [info ] [MainThread]: 
[0m02:40:54.458564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:40:54.459549 [info ] [MainThread]: 
[0m02:40:54.460722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:54.462568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:40:54.523667 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:40:54.524639 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:40:54.525367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:54.538198 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m02:40:54.540581 [debug] [ThreadPool]: On list_postgres: Close
[0m02:40:54.548802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:40:54.554610 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:40:54.555066 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:40:54.555517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:54.562349 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:40:54.562820 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:40:54.563285 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:40:54.566059 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m02:40:54.567559 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:40:54.568149 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:40:54.574811 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.575247 [debug] [MainThread]: On master: BEGIN
[0m02:40:54.575660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:40:54.582677 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:40:54.583141 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.583649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:40:54.586968 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m02:40:54.589520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b0ffe750>]}
[0m02:40:54.590461 [debug] [MainThread]: On master: ROLLBACK
[0m02:40:54.592453 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.594404 [debug] [MainThread]: On master: BEGIN
[0m02:40:54.595662 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:40:54.596337 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.596991 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.597784 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.598392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:54.598814 [debug] [MainThread]: On master: Close
[0m02:40:54.601362 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.602063 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_step_month_matrix .......... [RUN]
[0m02:40:54.602771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_step_month_matrix)
[0m02:40:54.603291 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.612908 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.613641 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.650587 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.651494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.652273 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: BEGIN
[0m02:40:54.653006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:40:54.662163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:40:54.662682 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.663229 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */

  create view "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp"
    
    
  as (
    

WITH
all_unique_steps AS (
                        SELECT 
                               * 
                        FROM (
                                VALUES
                                    ('Lead Generation',              'Step 1'),
                                    ('Qualified lead',               'Step 2'),
                                    ('Sales Call 1',                 'Step 2.1'),
                                    ('Needs Assessment',             'Step 3'),
                                    ('Sales Call 2',                 'Step 3.1'),
                                    ('Proposal/Quote Preparation',   'Step 4'),
                                    ('Negotiation',                  'Step 5'),
                                    ('Closing',                      'Step 6'),
                                    ('Implementation/Onboarding',    'Step 7'),
                                    ('Follow-up/Customer Success',   'Step 8'),
                                    ('Renewal/Expansion',            'Step 9')
                             ) AS t (kpi_name, funnel_step)
                        )
, all_months AS (
                    SELECT DISTINCT month 
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                )

, month_step_matrix AS (
                         SELECT
                               m.month,
                               s.kpi_name,
                               s.funnel_step
                         FROM all_months m
                         CROSS JOIN all_unique_steps s
                       )

SELECT *
FROM month_step_matrix
  );
[0m02:40:54.665538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m02:40:54.671566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.672067 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
alter table "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp" rename to "int_step_month_matrix"
[0m02:40:54.673002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:40:54.687440 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m02:40:54.687960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.688446 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m02:40:54.689869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:40:54.695743 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup"
[0m02:40:54.700842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.701384 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
drop view if exists "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup" cascade
[0m02:40:54.702162 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:40:54.704605 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: Close
[0m02:40:54.706861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4af134410>]}
[0m02:40:54.707845 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_step_month_matrix ..... [[32mCREATE VIEW[0m in 0.10s]
[0m02:40:54.708704 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.710139 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.710821 [debug] [MainThread]: On master: BEGIN
[0m02:40:54.711499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:54.719842 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m02:40:54.720363 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.720815 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.721242 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.721816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:54.722260 [debug] [MainThread]: On master: Close
[0m02:40:54.722845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:54.723501 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_step_month_matrix' was properly closed.
[0m02:40:54.724132 [info ] [MainThread]: 
[0m02:40:54.724775 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m02:40:54.726088 [debug] [MainThread]: Command end result
[0m02:40:54.774418 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:40:54.777892 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:40:54.785959 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:40:54.786726 [info ] [MainThread]: 
[0m02:40:54.788050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:40:54.789154 [info ] [MainThread]: 
[0m02:40:54.790135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:40:54.792361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.030923, "process_in_blocks": "0", "process_kernel_time": 0.292027, "process_mem_max_rss": "141204", "process_out_blocks": "2872", "process_user_time": 4.667476}
[0m02:40:54.793284 [debug] [MainThread]: Command `cli run` succeeded at 02:40:54.793102 after 2.03 seconds
[0m02:40:54.794038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b2f77980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b3f0c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b77ead50>]}
[0m02:40:54.795360 [debug] [MainThread]: Flushing usage events
[0m02:40:55.178148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:48:15.999566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4da32390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ee51d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ed6ed20>]}


============================== 02:48:16.002713 | 022690b6-b293-4075-a0d7-4a0105928eab ==============================
[0m02:48:16.002713 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:48:16.003610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:48:16.199763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4d3b6630>]}
[0m02:48:16.318156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ee9bd70>]}
[0m02:48:16.319656 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:48:16.497768 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:48:16.573564 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:48:16.574319 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:48:16.575131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4d9f8920>]}
[0m02:48:17.704042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4d5978c0>]}
[0m02:48:17.895057 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:48:17.907446 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:48:17.926467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4b7e2f90>]}
[0m02:48:17.927376 [info ] [MainThread]: Found 12 models, 6 sources, 434 macros
[0m02:48:17.928053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4b343c20>]}
[0m02:48:17.930589 [info ] [MainThread]: 
[0m02:48:17.931265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:48:17.931886 [info ] [MainThread]: 
[0m02:48:17.932740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:48:17.934055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:48:17.988760 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:48:17.989577 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:48:17.990287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:18.004485 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:48:18.007011 [debug] [ThreadPool]: On list_postgres: Close
[0m02:48:18.016887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:48:18.026846 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:48:18.027550 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:48:18.028182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:18.039477 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m02:48:18.040340 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:48:18.041191 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:48:18.045823 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m02:48:18.048525 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:48:18.049516 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:48:18.060962 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.061811 [debug] [MainThread]: On master: BEGIN
[0m02:48:18.062550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:48:18.076551 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m02:48:18.077362 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.078288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:48:18.083676 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m02:48:18.088434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4b340d70>]}
[0m02:48:18.089342 [debug] [MainThread]: On master: ROLLBACK
[0m02:48:18.090315 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.091027 [debug] [MainThread]: On master: BEGIN
[0m02:48:18.092060 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:48:18.092737 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.093509 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.094208 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.095141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:48:18.095876 [debug] [MainThread]: On master: Close
[0m02:48:18.101397 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.102530 [info ] [Thread-1 (]: 1 of 1 START sql table model pipedrive_analytics.rep_sales_funnel_monthly ...... [RUN]
[0m02:48:18.103495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m02:48:18.104325 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.117830 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.119398 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.184528 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.188599 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.189514 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m02:48:18.190352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:48:18.210820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:48:18.211633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.212726 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

WITH
monthly_data AS (
                    SELECT
                           month,
                           kpi_name,
                           funnel_step,
                           COUNT(DISTINCT deal_id) AS deals_count
                           
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                    WHERE funnel_anmly_flg = 0
                    GROUP BY 
                             month, 
                             kpi_name, 
                             funnel_step
)

, final AS (
             SELECT
                    ms.month,
                    ms.kpi_name,
                    ms.funnel_step,
                    COALESCE(a.deals_count, 0) AS deals_count

             FROM "postgres"."pipedrive_analytics"."int_step_month_matrix" ms
             LEFT JOIN monthly_data a            ON ms.month = a.month
                                                    AND ms.kpi_name = a.kpi_name
                               
           )
SELECT *
FROM final
  );
  
[0m02:48:18.482745 [debug] [Thread-1 (]: SQL status: SELECT 154 in 0.269 seconds
[0m02:48:18.500681 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.501673 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m02:48:18.503189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:48:18.526698 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m02:48:18.527674 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.528674 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m02:48:18.530574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:48:18.540727 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m02:48:18.549474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.550359 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m02:48:18.551703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:48:18.555634 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m02:48:18.561315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d49e752e0>]}
[0m02:48:18.563604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pipedrive_analytics.rep_sales_funnel_monthly . [[32mSELECT 154[0m in 0.45s]
[0m02:48:18.564987 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.566822 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.567605 [debug] [MainThread]: On master: BEGIN
[0m02:48:18.568331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:48:18.579593 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:48:18.580335 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.581060 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.581884 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.583907 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:48:18.584661 [debug] [MainThread]: On master: Close
[0m02:48:18.587934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:48:18.588649 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m02:48:18.589408 [info ] [MainThread]: 
[0m02:48:18.590164 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m02:48:18.591494 [debug] [MainThread]: Command end result
[0m02:48:18.642582 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:48:18.648702 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:48:18.676067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:48:18.676852 [info ] [MainThread]: 
[0m02:48:18.677663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:48:18.678343 [info ] [MainThread]: 
[0m02:48:18.679100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:48:18.682677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7363362, "process_in_blocks": "0", "process_kernel_time": 0.260381, "process_mem_max_rss": "141424", "process_out_blocks": "2872", "process_user_time": 4.398666}
[0m02:48:18.689547 [debug] [MainThread]: Command `cli run` succeeded at 02:48:18.689382 after 2.74 seconds
[0m02:48:18.690257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ddb10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4db8bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4e120410>]}
[0m02:48:18.690954 [debug] [MainThread]: Flushing usage events
[0m02:48:19.128726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:08.917951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e426ec42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e428240560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4275059a0>]}


============================== 23:53:08.921745 | db62dc50-0777-4aa9-9cf9-8e4adbfb2771 ==============================
[0m23:53:08.921745 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:53:08.922806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:09.080227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db62dc50-0777-4aa9-9cf9-8e4adbfb2771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e428f3f6e0>]}
[0m23:53:09.093473 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:09.094762 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:09.096571 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2346284, "process_in_blocks": "368", "process_kernel_time": 0.16949, "process_mem_max_rss": "116760", "process_out_blocks": "8", "process_user_time": 2.716836}
[0m23:53:09.097686 [debug] [MainThread]: Command `cli deps` succeeded at 23:53:09.097478 after 0.24 seconds
[0m23:53:09.098427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e426d1c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e427e89010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e426cc1070>]}
[0m23:53:09.099257 [debug] [MainThread]: Flushing usage events
[0m23:53:09.490513 [debug] [MainThread]: An error was encountered while trying to flush usage events
