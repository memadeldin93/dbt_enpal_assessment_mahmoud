[0m23:25:17.456695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7660f6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a763cfa360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a763d1dee0>]}


============================== 23:25:17.461223 | 47d4ad2f-da8f-4929-9610-8780f21f50e5 ==============================
[0m23:25:17.461223 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:25:17.462003 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'invocation_command': 'dbt debug', 'debug': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'None', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m23:25:17.471947 [info ] [MainThread]: dbt version: 1.11.2
[0m23:25:17.472469 [info ] [MainThread]: python version: 3.12.1
[0m23:25:17.472974 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m23:25:17.473439 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m23:25:17.523141 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m23:25:17.524023 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m23:25:17.524754 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m23:25:17.525697 [info ] [MainThread]: adapter type: postgres
[0m23:25:17.526381 [info ] [MainThread]: adapter version: 1.10.0
[0m23:25:17.646119 [info ] [MainThread]: Configuration:
[0m23:25:17.646767 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:25:17.647306 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:25:17.647800 [info ] [MainThread]: Required dependencies:
[0m23:25:17.648319 [debug] [MainThread]: Executing "git --help"
[0m23:25:17.651379 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:25:17.651937 [debug] [MainThread]: STDERR: "b''"
[0m23:25:17.652382 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:25:17.653430 [info ] [MainThread]: Connection:
[0m23:25:17.654480 [info ] [MainThread]:   host: localhost
[0m23:25:17.655308 [info ] [MainThread]:   port: 5432
[0m23:25:17.656038 [info ] [MainThread]:   user: admin
[0m23:25:17.656843 [info ] [MainThread]:   database: postgres
[0m23:25:17.657538 [info ] [MainThread]:   schema: analytics
[0m23:25:17.658266 [info ] [MainThread]:   connect_timeout: 10
[0m23:25:17.658753 [info ] [MainThread]:   role: None
[0m23:25:17.659276 [info ] [MainThread]:   search_path: None
[0m23:25:17.660193 [info ] [MainThread]:   keepalives_idle: 0
[0m23:25:17.661167 [info ] [MainThread]:   sslmode: None
[0m23:25:17.661633 [info ] [MainThread]:   sslcert: None
[0m23:25:17.662127 [info ] [MainThread]:   sslkey: None
[0m23:25:17.662579 [info ] [MainThread]:   sslrootcert: None
[0m23:25:17.663137 [info ] [MainThread]:   application_name: dbt
[0m23:25:17.663623 [info ] [MainThread]:   retries: 1
[0m23:25:17.664379 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:25:17.763105 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:25:17.783725 [debug] [MainThread]: Using postgres connection "debug"
[0m23:25:17.784298 [debug] [MainThread]: On debug: select 1 as id
[0m23:25:17.784728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:25:17.801386 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m23:25:17.802519 [debug] [MainThread]: On debug: Close
[0m23:25:17.803086 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:25:17.803944 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:25:17.805865 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4113428, "process_in_blocks": "368", "process_kernel_time": 0.139812, "process_mem_max_rss": "117188", "process_out_blocks": "24", "process_user_time": 1.663767}
[0m23:25:17.806491 [debug] [MainThread]: Command `dbt debug` succeeded at 23:25:17.806381 after 0.41 seconds
[0m23:25:17.806997 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:25:17.807475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a76463a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a7664c6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a764a54320>]}
[0m23:25:17.808016 [debug] [MainThread]: Flushing usage events
[0m23:25:18.199280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:30.961222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a1e74ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a3d9a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a33d54f0>]}


============================== 23:31:30.966286 | 8b93e5de-781e-44ca-a187-e72334528bd5 ==============================
[0m23:31:30.966286 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:31:30.967423 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'empty': 'None', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m23:31:30.980646 [info ] [MainThread]: dbt version: 1.11.2
[0m23:31:30.981574 [info ] [MainThread]: python version: 3.12.1
[0m23:31:30.982351 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m23:31:30.983245 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m23:31:31.040553 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m23:31:31.041257 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m23:31:31.042035 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m23:31:31.042953 [info ] [MainThread]: adapter type: postgres
[0m23:31:31.043668 [info ] [MainThread]: adapter version: 1.10.0
[0m23:31:31.181831 [info ] [MainThread]: Configuration:
[0m23:31:31.182494 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:31:31.183046 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:31:31.183532 [info ] [MainThread]: Required dependencies:
[0m23:31:31.184048 [debug] [MainThread]: Executing "git --help"
[0m23:31:31.186156 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:31:31.186648 [debug] [MainThread]: STDERR: "b''"
[0m23:31:31.187209 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:31:31.187710 [info ] [MainThread]: Connection:
[0m23:31:31.188299 [info ] [MainThread]:   host: localhost
[0m23:31:31.189013 [info ] [MainThread]:   port: 5432
[0m23:31:31.189690 [info ] [MainThread]:   user: admin
[0m23:31:31.190388 [info ] [MainThread]:   database: postgres
[0m23:31:31.191059 [info ] [MainThread]:   schema: pipedrive_analytics
[0m23:31:31.191532 [info ] [MainThread]:   connect_timeout: 10
[0m23:31:31.192100 [info ] [MainThread]:   role: None
[0m23:31:31.192570 [info ] [MainThread]:   search_path: None
[0m23:31:31.193122 [info ] [MainThread]:   keepalives_idle: 0
[0m23:31:31.193813 [info ] [MainThread]:   sslmode: None
[0m23:31:31.194502 [info ] [MainThread]:   sslcert: None
[0m23:31:31.195172 [info ] [MainThread]:   sslkey: None
[0m23:31:31.195886 [info ] [MainThread]:   sslrootcert: None
[0m23:31:31.196540 [info ] [MainThread]:   application_name: dbt
[0m23:31:31.197178 [info ] [MainThread]:   retries: 1
[0m23:31:31.197823 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:31:31.300056 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:31:31.319603 [debug] [MainThread]: Using postgres connection "debug"
[0m23:31:31.320164 [debug] [MainThread]: On debug: select 1 as id
[0m23:31:31.320615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:31.331448 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m23:31:31.332490 [debug] [MainThread]: On debug: Close
[0m23:31:31.333022 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:31:31.334563 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:31:31.335902 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4506676, "process_in_blocks": "0", "process_kernel_time": 0.142359, "process_mem_max_rss": "117152", "process_out_blocks": "24", "process_user_time": 1.728225}
[0m23:31:31.336501 [debug] [MainThread]: Command `dbt debug` succeeded at 23:31:31.336396 after 0.45 seconds
[0m23:31:31.336970 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:31:31.337443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a0781910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a14b23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d98a16c0ec0>]}
[0m23:31:31.337966 [debug] [MainThread]: Flushing usage events
[0m23:31:31.717590 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:37.651089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead53e6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead5385670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead523f800>]}


============================== 23:31:37.654477 | 0d6592e9-dab5-4cc4-93f7-00ca11287703 ==============================
[0m23:31:37.654477 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:31:37.655341 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt parse', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True'}
[0m23:31:37.878460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead54142c0>]}
[0m23:31:37.954411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead523fec0>]}
[0m23:31:37.955393 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:31:38.110255 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:31:38.278355 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:31:38.279075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead2f8f200>]}
[0m23:31:39.292026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project.marts
- models.enpal_assessment_project.staging
[0m23:31:39.302939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6592e9-dab5-4cc4-93f7-00ca11287703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead37388c0>]}
[0m23:31:39.306814 [info ] [MainThread]: Performance info: /workspaces/dbt_enpal_assessment_mahmoud/target/perf_info.json
[0m23:31:39.374941 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:31:39.382461 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:31:39.384445 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.7900465, "process_in_blocks": "120", "process_kernel_time": 0.16095, "process_mem_max_rss": "118112", "process_out_blocks": "1792", "process_user_time": 2.890674}
[0m23:31:39.385409 [debug] [MainThread]: Command `dbt parse` succeeded at 23:31:39.385251 after 1.79 seconds
[0m23:31:39.386248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead6b19820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead436c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ead2bf2e40>]}
[0m23:31:39.387064 [debug] [MainThread]: Flushing usage events
[0m23:31:39.740923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:31.823257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fd8c4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fdbc6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fda04800>]}


============================== 23:32:31.826485 | 1aa96adc-a7a9-483b-9846-fb5586748e4f ==============================
[0m23:32:31.826485 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:32:31.827406 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud'}
[0m23:32:32.006771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fd052090>]}
[0m23:32:32.072073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1ffb3eae0>]}
[0m23:32:32.073056 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:32:32.173495 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:32:32.256063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:32.256575 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:32:32.257025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:32.262012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project.marts
- models.enpal_assessment_project.staging
[0m23:32:32.292180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fc556c30>]}
[0m23:32:32.370070 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:32:32.372421 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:32:32.386129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fbdac9b0>]}
[0m23:32:32.386718 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:32:32.387281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fde6a0c0>]}
[0m23:32:32.389071 [info ] [MainThread]: 
[0m23:32:32.389591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:32.390078 [info ] [MainThread]: 
[0m23:32:32.390746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:32.391737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:32:32.423112 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:32:32.423648 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:32:32.424117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:32.433238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:32:32.434619 [debug] [ThreadPool]: On list_postgres: Close
[0m23:32:32.435533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_analytics_pipedrive_analytics)
[0m23:32:32.436422 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_analytics_pipedrive_analytics"
"
[0m23:32:32.442048 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.442501 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_analytics_pipedrive_analytics"} */
create schema if not exists "pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.442945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:32.456013 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.013 seconds
[0m23:32:32.457183 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: COMMIT
[0m23:32:32.457646 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.458115 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: COMMIT
[0m23:32:32.465327 [debug] [ThreadPool]: SQL status: COMMIT in 0.007 seconds
[0m23:32:32.466056 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics_pipedrive_analytics: Close
[0m23:32:32.470063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_analytics_pipedrive_analytics, now list_postgres_pipedrive_analytics_pipedrive_analytics)
[0m23:32:32.476346 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics_pipedrive_analytics"
[0m23:32:32.476859 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics_pipedrive_analytics'
  
[0m23:32:32.477294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:32.488870 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m23:32:32.490215 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics_pipedrive_analytics: ROLLBACK
[0m23:32:32.490864 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics_pipedrive_analytics: Close
[0m23:32:32.495444 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:32.495987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:32:32.496456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:32.517528 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m23:32:32.518833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fa9ece60>]}
[0m23:32:32.519396 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:32.520021 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.520470 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:32.520911 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.521588 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:32:32.522057 [debug] [MainThread]: On master: Close
[0m23:32:32.524772 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:32:32.525448 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics_pipedrive_analytics.test_model . [RUN]
[0m23:32:32.526136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m23:32:32.526639 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:32:32.536194 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:32:32.536997 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:32:32.573973 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:32:32.574895 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.575441 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m23:32:32.576002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:32.600082 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m23:32:32.606722 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.607382 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:32:32.610589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:32:32.630743 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:32:32.631303 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.631801 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:32:32.633883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:32:32.639993 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_backup"
[0m23:32:32.645100 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:32:32.645618 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop view if exists "postgres"."pipedrive_analytics_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:32:32.647899 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:32:32.650401 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:32:32.652916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa96adc-a7a9-483b-9846-fb5586748e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1ffa66870>]}
[0m23:32:32.653969 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics_pipedrive_analytics.test_model  [[32mCREATE VIEW[0m in 0.13s]
[0m23:32:32.654781 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:32:32.656023 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.656469 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:32.656922 [debug] [MainThread]: On master: COMMIT
[0m23:32:32.657317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:32:32.665836 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m23:32:32.666312 [debug] [MainThread]: On master: Close
[0m23:32:32.666957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:32.667593 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:32:32.668348 [info ] [MainThread]: 
[0m23:32:32.669042 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m23:32:32.669910 [debug] [MainThread]: Command end result
[0m23:32:32.690188 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:32:32.691810 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:32:32.699472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:32:32.699934 [info ] [MainThread]: 
[0m23:32:32.700533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:32.701025 [info ] [MainThread]: 
[0m23:32:32.701556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:32.702570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9375014, "process_in_blocks": "128", "process_kernel_time": 0.154271, "process_mem_max_rss": "124620", "process_out_blocks": "1840", "process_user_time": 2.132928}
[0m23:32:32.703218 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:32.703109 after 0.94 seconds
[0m23:32:32.703679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fd12e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fb907e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb1fda04800>]}
[0m23:32:32.704194 [debug] [MainThread]: Flushing usage events
[0m23:32:33.089298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:26.717293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc567dd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc567ddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc56a6fb00>]}


============================== 23:35:26.720531 | 172bfe4f-bcf9-4a5c-9143-9fecfeb84148 ==============================
[0m23:35:26.720531 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:35:26.721400 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'no_print': 'None'}
[0m23:35:26.896551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc5553b080>]}
[0m23:35:26.965331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc56396db0>]}
[0m23:35:26.966296 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:35:27.063223 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:35:27.164220 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:35:27.164935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc549a86b0>]}
[0m23:35:28.202386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.enpal_assessment_project.staging
- models.enpal_assessment_project.marts
[0m23:35:28.212812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc555d88c0>]}
[0m23:35:28.276197 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:35:28.278419 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:35:28.291250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc555a8b90>]}
[0m23:35:28.291859 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:35:28.292417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc541fdc40>]}
[0m23:35:28.294233 [info ] [MainThread]: 
[0m23:35:28.294781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:35:28.295287 [info ] [MainThread]: 
[0m23:35:28.295977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:35:28.296987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:35:28.329339 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:35:28.329919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:35:28.330401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:28.341907 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m23:35:28.343387 [debug] [ThreadPool]: On list_postgres: Close
[0m23:35:28.344504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m23:35:28.345365 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m23:35:28.351077 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m23:35:28.351574 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m23:35:28.352024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:28.359124 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m23:35:28.360188 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m23:35:28.360682 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m23:35:28.361115 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m23:35:28.370207 [debug] [ThreadPool]: SQL status: COMMIT in 0.009 seconds
[0m23:35:28.370670 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m23:35:28.372185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m23:35:28.378538 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m23:35:28.379169 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m23:35:28.379600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:28.390266 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m23:35:28.391585 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m23:35:28.392218 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m23:35:28.398417 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:28.398981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:35:28.399490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:35:28.408494 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m23:35:28.409831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc528cb110>]}
[0m23:35:28.410422 [debug] [MainThread]: On master: ROLLBACK
[0m23:35:28.411045 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.411517 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:28.412011 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.412685 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:35:28.413146 [debug] [MainThread]: On master: Close
[0m23:35:28.415633 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:35:28.416495 [info ] [Thread-1 (]: 1 of 1 START sql view model public_pipedrive_analytics.test_model .............. [RUN]
[0m23:35:28.417199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m23:35:28.417705 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:35:28.426884 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:35:28.428511 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:35:28.490291 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:35:28.491549 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.492379 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  create view "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
    
    
  as (
    SELECT *
FROM "postgres"."public"."activity"
  );
[0m23:35:28.493185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:28.506969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:35:28.513713 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.514287 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:35:28.515167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:35:28.528609 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:35:28.529165 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.529655 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:35:28.531951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:35:28.538087 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m23:35:28.543221 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:35:28.543745 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop view if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:35:28.544551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:35:28.546989 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:35:28.549252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '172bfe4f-bcf9-4a5c-9143-9fecfeb84148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc58a72870>]}
[0m23:35:28.550217 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_pipedrive_analytics.test_model ......... [[32mCREATE VIEW[0m in 0.13s]
[0m23:35:28.551065 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:35:28.552293 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.552772 [debug] [MainThread]: Using postgres connection "master"
[0m23:35:28.553231 [debug] [MainThread]: On master: COMMIT
[0m23:35:28.553637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:35:28.561929 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m23:35:28.562440 [debug] [MainThread]: On master: Close
[0m23:35:28.563061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:28.563725 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:35:28.564400 [info ] [MainThread]: 
[0m23:35:28.565109 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m23:35:28.566057 [debug] [MainThread]: Command end result
[0m23:35:28.588677 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:35:28.591667 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:35:28.600739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:35:28.601477 [info ] [MainThread]: 
[0m23:35:28.602485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:35:28.603916 [info ] [MainThread]: 
[0m23:35:28.604991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:35:28.606639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9479434, "process_in_blocks": "0", "process_kernel_time": 0.170661, "process_mem_max_rss": "128112", "process_out_blocks": "2720", "process_user_time": 3.106844}
[0m23:35:28.607618 [debug] [MainThread]: Command `dbt run` succeeded at 23:35:28.607440 after 1.95 seconds
[0m23:35:28.608224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc56488fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc5673e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fc5633f590>]}
[0m23:35:28.608986 [debug] [MainThread]: Flushing usage events
[0m23:35:29.019378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:10.942826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1966eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1a292930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1a84e2a0>]}


============================== 23:38:10.946219 | 96586b0b-e4c1-4a78-9140-ecf0decb0d38 ==============================
[0m23:38:10.946219 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:38:10.947288 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m23:38:11.117276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1850b410>]}
[0m23:38:11.182120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac18fdf3b0>]}
[0m23:38:11.183103 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:38:11.281452 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:38:11.356006 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:38:11.356694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac18d87cb0>]}
[0m23:38:12.365852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac16fab890>]}
[0m23:38:12.426938 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:38:12.428838 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:38:12.442400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac16b99ee0>]}
[0m23:38:12.443411 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:38:12.444221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac17771070>]}
[0m23:38:12.446700 [info ] [MainThread]: 
[0m23:38:12.447405 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:38:12.448031 [info ] [MainThread]: 
[0m23:38:12.448872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:38:12.450370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:38:12.495691 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:38:12.496692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:38:12.497508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:12.532077 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.034 seconds
[0m23:38:12.537778 [debug] [ThreadPool]: On list_postgres: Close
[0m23:38:12.539835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m23:38:12.550152 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m23:38:12.551049 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:38:12.551877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:12.567668 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m23:38:12.570276 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m23:38:12.571238 [debug] [ThreadPool]: On list_postgres_public: Close
[0m23:38:12.581647 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:12.582578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:38:12.583442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:12.600248 [debug] [MainThread]: SQL status: SELECT 2 in 0.017 seconds
[0m23:38:12.603534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1774c470>]}
[0m23:38:12.604429 [debug] [MainThread]: On master: ROLLBACK
[0m23:38:12.605366 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.606126 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:12.606870 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.607755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:38:12.608492 [debug] [MainThread]: On master: Close
[0m23:38:12.613513 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:38:12.614563 [info ] [Thread-1 (]: 1 of 1 START sql table model public.test_model ................................. [RUN]
[0m23:38:12.615507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.enpal_assessment_project.test_model)
[0m23:38:12.616319 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:38:12.630026 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:38:12.631483 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:38:12.684739 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:38:12.686440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.687374 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:38:12.688293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:12.713011 [debug] [Thread-1 (]: SQL status: SELECT 9158 in 0.025 seconds
[0m23:38:12.732512 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.733420 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public"."test_model__dbt_tmp" rename to "test_model"
[0m23:38:12.734867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:38:12.758736 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:38:12.759650 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.760508 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:38:12.770883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m23:38:12.781126 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."test_model__dbt_backup"
[0m23:38:12.789531 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:38:12.790383 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public"."test_model__dbt_backup" cascade
[0m23:38:12.796190 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:38:12.802547 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:38:12.805245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96586b0b-e4c1-4a78-9140-ecf0decb0d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1b02abd0>]}
[0m23:38:12.812055 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.test_model ............................ [[32mSELECT 9158[0m in 0.19s]
[0m23:38:12.813217 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:38:12.815255 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.816198 [debug] [MainThread]: Using postgres connection "master"
[0m23:38:12.817198 [debug] [MainThread]: On master: COMMIT
[0m23:38:12.818700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:12.830094 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m23:38:12.830817 [debug] [MainThread]: On master: Close
[0m23:38:12.831654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:12.834385 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:38:12.835139 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:38:12.838105 [info ] [MainThread]: 
[0m23:38:12.838885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:38:12.841269 [debug] [MainThread]: Command end result
[0m23:38:12.879834 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:38:12.884424 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:38:12.901360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:38:12.904277 [info ] [MainThread]: 
[0m23:38:12.905135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:12.907433 [info ] [MainThread]: 
[0m23:38:12.909770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:38:12.911610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0592227, "process_in_blocks": "0", "process_kernel_time": 0.165818, "process_mem_max_rss": "128428", "process_out_blocks": "2720", "process_user_time": 3.188471}
[0m23:38:12.912553 [debug] [MainThread]: Command `dbt run` succeeded at 23:38:12.912390 after 2.06 seconds
[0m23:38:12.915081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac18954ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac1b27ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ac17b5fda0>]}
[0m23:38:12.916064 [debug] [MainThread]: Flushing usage events
[0m23:38:13.331706 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:26.465014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c3400ecdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f2612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c3400ed0a0>]}


============================== 23:39:26.468325 | 5dd10940-421f-486c-b94f-4d55b4c6711c ==============================
[0m23:39:26.468325 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:39:26.469173 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False'}
[0m23:39:26.631672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c3400ed070>]}
[0m23:39:26.697243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c34005a090>]}
[0m23:39:26.698181 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:39:26.798593 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:39:26.886587 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:39:26.887395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f98fe00>]}
[0m23:39:27.904915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f22b980>]}
[0m23:39:27.971931 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:39:27.974376 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:39:27.987229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33d7a14f0>]}
[0m23:39:27.987841 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m23:39:27.988405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33d331790>]}
[0m23:39:27.990306 [info ] [MainThread]: 
[0m23:39:27.990855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:27.991342 [info ] [MainThread]: 
[0m23:39:27.992112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:39:27.993572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:39:28.030624 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:39:28.031460 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:39:28.032231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:28.046035 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m23:39:28.048478 [debug] [ThreadPool]: On list_postgres: Close
[0m23:39:28.050705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_pipedrive_analytics)
[0m23:39:28.051607 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "pipedrive_analytics"
"
[0m23:39:28.058104 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m23:39:28.058565 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_pipedrive_analytics"} */
create schema if not exists "pipedrive_analytics"
[0m23:39:28.059023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:28.066117 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m23:39:28.067833 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m23:39:28.068672 [debug] [ThreadPool]: Using postgres connection "create_postgres_pipedrive_analytics"
[0m23:39:28.069348 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: COMMIT
[0m23:39:28.075582 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m23:39:28.076361 [debug] [ThreadPool]: On create_postgres_pipedrive_analytics: Close
[0m23:39:28.079095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_pipedrive_analytics, now list_postgres_pipedrive_analytics)
[0m23:39:28.091206 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:39:28.094394 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m23:39:28.098337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:39:28.116908 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.018 seconds
[0m23:39:28.119277 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m23:39:28.120054 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m23:39:28.131968 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:28.132803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:39:28.133653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:39:28.152781 [debug] [MainThread]: SQL status: SELECT 2 in 0.019 seconds
[0m23:39:28.157758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33c2e6090>]}
[0m23:39:28.158785 [debug] [MainThread]: On master: ROLLBACK
[0m23:39:28.159773 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.162696 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:28.163425 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.167504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:39:28.168276 [debug] [MainThread]: On master: Close
[0m23:39:28.177706 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m23:39:28.178673 [info ] [Thread-1 (]: 1 of 1 START sql table model pipedrive_analytics.test_model .................... [RUN]
[0m23:39:28.179433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m23:39:28.179977 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m23:39:28.187910 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m23:39:28.188802 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m23:39:28.235145 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m23:39:28.236146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.236700 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m23:39:28.237216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:39:28.249293 [debug] [Thread-1 (]: SQL status: SELECT 9158 in 0.012 seconds
[0m23:39:28.258611 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.259170 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m23:39:28.260085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:39:28.275970 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:39:28.276516 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.277024 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m23:39:28.285971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:39:28.292163 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."test_model__dbt_backup"
[0m23:39:28.297238 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m23:39:28.297761 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."pipedrive_analytics"."test_model__dbt_backup" cascade
[0m23:39:28.298587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:39:28.301045 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m23:39:28.303308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dd10940-421f-486c-b94f-4d55b4c6711c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33d789760>]}
[0m23:39:28.304299 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pipedrive_analytics.test_model ............... [[32mSELECT 9158[0m in 0.12s]
[0m23:39:28.305153 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m23:39:28.306417 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.306891 [debug] [MainThread]: Using postgres connection "master"
[0m23:39:28.307324 [debug] [MainThread]: On master: COMMIT
[0m23:39:28.307736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:39:28.316142 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m23:39:28.316613 [debug] [MainThread]: On master: Close
[0m23:39:28.317249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:28.317901 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m23:39:28.318513 [info ] [MainThread]: 
[0m23:39:28.319212 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m23:39:28.320224 [debug] [MainThread]: Command end result
[0m23:39:28.341257 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:39:28.343006 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:39:28.348418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:39:28.348865 [info ] [MainThread]: 
[0m23:39:28.349455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:39:28.349977 [info ] [MainThread]: 
[0m23:39:28.350506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:39:28.351540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9486055, "process_in_blocks": "0", "process_kernel_time": 0.150254, "process_mem_max_rss": "128268", "process_out_blocks": "2728", "process_user_time": 3.117526}
[0m23:39:28.352165 [debug] [MainThread]: Command `dbt run` succeeded at 23:39:28.352056 after 1.95 seconds
[0m23:39:28.352632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f2cbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f22bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c33f24cbf0>]}
[0m23:39:28.353198 [debug] [MainThread]: Flushing usage events
[0m23:39:28.750512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:19:44.863039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581951eccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581951c69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758192564bc0>]}


============================== 00:19:44.867753 | 8afda2a8-f700-4b53-88de-a2cbb4a0e668 ==============================
[0m00:19:44.867753 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:19:44.868637 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:44.878904 [info ] [MainThread]: dbt version: 1.11.2
[0m00:19:44.879759 [info ] [MainThread]: python version: 3.12.1
[0m00:19:44.880357 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m00:19:44.881010 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m00:19:44.972333 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m00:19:44.973041 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m00:19:44.973687 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m00:19:44.974619 [info ] [MainThread]: adapter type: postgres
[0m00:19:44.975285 [info ] [MainThread]: adapter version: 1.10.0
[0m00:19:45.096430 [info ] [MainThread]: Configuration:
[0m00:19:45.097187 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:19:45.097743 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:19:45.098262 [info ] [MainThread]: Required dependencies:
[0m00:19:45.098779 [debug] [MainThread]: Executing "git --help"
[0m00:19:45.101064 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:19:45.101659 [debug] [MainThread]: STDERR: "b''"
[0m00:19:45.102260 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:19:45.102968 [info ] [MainThread]: Connection:
[0m00:19:45.103666 [info ] [MainThread]:   host: localhost
[0m00:19:45.104220 [info ] [MainThread]:   port: 5432
[0m00:19:45.104739 [info ] [MainThread]:   user: admin
[0m00:19:45.105383 [info ] [MainThread]:   database: postgres
[0m00:19:45.106057 [info ] [MainThread]:   schema: pipedrive_analytics
[0m00:19:45.106715 [info ] [MainThread]:   connect_timeout: 10
[0m00:19:45.107380 [info ] [MainThread]:   role: None
[0m00:19:45.108045 [info ] [MainThread]:   search_path: None
[0m00:19:45.108646 [info ] [MainThread]:   keepalives_idle: 0
[0m00:19:45.109239 [info ] [MainThread]:   sslmode: None
[0m00:19:45.109704 [info ] [MainThread]:   sslcert: None
[0m00:19:45.110356 [info ] [MainThread]:   sslkey: None
[0m00:19:45.111021 [info ] [MainThread]:   sslrootcert: None
[0m00:19:45.111697 [info ] [MainThread]:   application_name: dbt
[0m00:19:45.112373 [info ] [MainThread]:   retries: 1
[0m00:19:45.113417 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:19:45.206279 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:19:45.229110 [debug] [MainThread]: Using postgres connection "debug"
[0m00:19:45.229985 [debug] [MainThread]: On debug: select 1 as id
[0m00:19:45.230587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:45.262657 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m00:19:45.264673 [debug] [MainThread]: On debug: Close
[0m00:19:45.265499 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:19:45.266385 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:19:45.267993 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.47054848, "process_in_blocks": "3704", "process_kernel_time": 0.167043, "process_mem_max_rss": "117268", "process_out_blocks": "24", "process_user_time": 1.745006}
[0m00:19:45.269112 [debug] [MainThread]: Command `dbt debug` succeeded at 00:19:45.268941 after 0.47 seconds
[0m00:19:45.269880 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:19:45.270656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581924fe600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758191b951c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75819237a000>]}
[0m00:19:45.271511 [debug] [MainThread]: Flushing usage events
[0m00:19:45.663212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:10.533334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd96f3e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd976d73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd974d6b40>]}


============================== 00:29:10.536995 | 9238e66d-a3d1-4a1a-a21a-0726f1a462b4 ==============================
[0m00:29:10.536995 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:29:10.537920 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'empty': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'write_json': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select tag:pipedrive', 'fail_fast': 'False'}
[0m00:29:10.710815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9238e66d-a3d1-4a1a-a21a-0726f1a462b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd95d3aab0>]}
[0m00:29:10.782327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9238e66d-a3d1-4a1a-a21a-0726f1a462b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd9703e450>]}
[0m00:29:10.783431 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:29:10.891806 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:29:10.995231 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:29:10.996102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9238e66d-a3d1-4a1a-a21a-0726f1a462b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd951986b0>]}
[0m00:29:11.992660 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.enpal_assessment_project.stg_users' (models/staging/stg_users.sql) depends on a source named 'pipedrive.users' which was not found
[0m00:29:11.994202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5232502, "process_in_blocks": "8", "process_kernel_time": 0.170189, "process_mem_max_rss": "116372", "process_out_blocks": "16", "process_user_time": 2.955928}
[0m00:29:11.994940 [debug] [MainThread]: Command `dbt run` failed at 00:29:11.994818 after 1.52 seconds
[0m00:29:11.995498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd96f3e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd949de090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70cd94ddc200>]}
[0m00:29:11.996063 [debug] [MainThread]: Flushing usage events
[0m00:29:12.378033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:31:39.002285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2e217f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de816780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dedb8380>]}


============================== 00:31:39.006637 | c627d3e4-c341-4575-845f-135ba4d39f32 ==============================
[0m00:31:39.006637 [info ] [MainThread]: Running with dbt=1.11.2
[0m00:31:39.007574 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:pipedrive', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'static_parser': 'True', 'no_print': 'None'}
[0m00:31:39.174399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de10c7d0>]}
[0m00:31:39.240904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2e06653a0>]}
[0m00:31:39.241931 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m00:31:39.349888 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m00:31:39.443564 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:31:39.444345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de987cb0>]}
[0m00:31:40.834717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2de141400>]}
[0m00:31:41.099638 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:31:41.103359 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:31:41.145986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dc774320>]}
[0m00:31:41.147128 [info ] [MainThread]: Found 1 model, 6 sources, 464 macros
[0m00:31:41.147984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dd373f50>]}
[0m00:31:41.150760 [info ] [MainThread]: 
[0m00:31:41.157921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:31:41.159322 [info ] [MainThread]: 
[0m00:31:41.162858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:31:41.164680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:31:41.226117 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:31:41.232738 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:31:41.234020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:41.256226 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m00:31:41.261123 [debug] [ThreadPool]: On list_postgres: Close
[0m00:31:41.269859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m00:31:41.280683 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:31:41.281780 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:31:41.282716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:41.305743 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m00:31:41.309279 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:31:41.310515 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:31:41.322328 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:41.323482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:31:41.324559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:31:41.342578 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m00:31:41.345187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2daba9ee0>]}
[0m00:31:41.346302 [debug] [MainThread]: On master: ROLLBACK
[0m00:31:41.347376 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.348074 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:41.348729 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.349946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:31:41.350783 [debug] [MainThread]: On master: Close
[0m00:31:41.357702 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m00:31:41.358855 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_users ...................... [RUN]
[0m00:31:41.361467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_users)
[0m00:31:41.362362 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m00:31:41.378815 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m00:31:41.380019 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m00:31:41.446176 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m00:31:41.447691 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.448625 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with 

transformed as (

                SELECT 
                      id          as user_id,
                      name        as user_name,
                      email       as user_email,
                      modified    as user_modified_at

                FROM "postgres"."public"."users"
)

SELECT 
      *
FROM transformed
  );
[0m00:31:41.449470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:31:41.462616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m00:31:41.474983 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.476138 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m00:31:41.477768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:31:41.502636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m00:31:41.503841 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.504850 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m00:31:41.517701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m00:31:41.528991 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_users__dbt_backup"
[0m00:31:41.538335 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m00:31:41.539512 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m00:31:41.541058 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:31:41.545284 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m00:31:41.550533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c627d3e4-c341-4575-845f-135ba4d39f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2da996540>]}
[0m00:31:41.552711 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_users ................. [[32mCREATE VIEW[0m in 0.19s]
[0m00:31:41.554096 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m00:31:41.556121 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.557087 [debug] [MainThread]: Using postgres connection "master"
[0m00:31:41.557884 [debug] [MainThread]: On master: COMMIT
[0m00:31:41.558646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:31:41.569840 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m00:31:41.570959 [debug] [MainThread]: On master: Close
[0m00:31:41.574272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:41.575218 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:31:41.576059 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m00:31:41.576916 [info ] [MainThread]: 
[0m00:31:41.577767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m00:31:41.579289 [debug] [MainThread]: Command end result
[0m00:31:41.618139 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:31:41.621407 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:31:41.630965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:31:41.631916 [info ] [MainThread]: 
[0m00:31:41.632889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:41.633745 [info ] [MainThread]: 
[0m00:31:41.634614 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:31:41.636320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.691725, "process_in_blocks": "0", "process_kernel_time": 0.179661, "process_mem_max_rss": "128116", "process_out_blocks": "2776", "process_user_time": 3.536642}
[0m00:31:41.637361 [debug] [MainThread]: Command `dbt run` succeeded at 00:31:41.637205 after 2.69 seconds
[0m00:31:41.638255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2e0a44bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2dc3ff2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d2da9b7650>]}
[0m00:31:41.639174 [debug] [MainThread]: Flushing usage events
[0m00:31:42.047746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:57.567251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35e9c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35016900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c33a26ea0>]}


============================== 00:55:57.570416 | 171f3fc9-dfa4-481c-b3ff-cd7f36b27efb ==============================
[0m00:55:57.570416 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:55:57.571298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:57.746785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35d5deb0>]}
[0m00:55:57.807947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3421f5f0>]}
[0m00:55:57.808946 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:55:57.973647 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:55:58.086016 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:55:58.086837 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:55:58.087337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c33c03890>]}
[0m00:55:59.083421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c329691c0>]}
[0m00:55:59.161327 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:55:59.173258 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:55:59.281829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c3159d1f0>]}
[0m00:55:59.282777 [info ] [MainThread]: Found 2 models, 6 sources, 434 macros
[0m00:55:59.283648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35b0eff0>]}
[0m00:55:59.286238 [info ] [MainThread]: 
[0m00:55:59.287697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:59.288738 [info ] [MainThread]: 
[0m00:55:59.290105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:55:59.291885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:55:59.342545 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:55:59.343305 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:55:59.343770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:59.352736 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m00:55:59.354158 [debug] [ThreadPool]: On list_postgres: Close
[0m00:55:59.359125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:55:59.365038 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:55:59.365468 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:55:59.365893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:59.373626 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m00:55:59.374522 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:55:59.375317 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:55:59.379591 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m00:55:59.381965 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:55:59.382854 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:55:59.393415 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.394183 [debug] [MainThread]: On master: BEGIN
[0m00:55:59.394828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:59.406318 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:55:59.407067 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.407989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:55:59.412531 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m00:55:59.414325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35b0fb60>]}
[0m00:55:59.415224 [debug] [MainThread]: On master: ROLLBACK
[0m00:55:59.416142 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.416611 [debug] [MainThread]: On master: BEGIN
[0m00:55:59.417374 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:55:59.418080 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.418731 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.419422 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.419991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:59.420596 [debug] [MainThread]: On master: Close
[0m00:55:59.423931 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.425435 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity_types ............. [RUN]
[0m00:55:59.426785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m00:55:59.427684 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.439743 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.440773 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.490854 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.491952 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.492502 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m00:55:59.492997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:59.501089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m00:55:59.501949 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.502509 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
                 )
SELECT *
FROM transformed
  );
[0m00:55:59.504731 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m00:55:59.512253 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.512780 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m00:55:59.513677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m00:55:59.527870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m00:55:59.528406 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.528892 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m00:55:59.537297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m00:55:59.543526 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m00:55:59.548538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m00:55:59.549070 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m00:55:59.549931 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:55:59.552405 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m00:55:59.555392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171f3fc9-dfa4-481c-b3ff-cd7f36b27efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c35d5ce90>]}
[0m00:55:59.556200 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity_types ........ [[32mCREATE VIEW[0m in 0.13s]
[0m00:55:59.557149 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m00:55:59.558756 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.559512 [debug] [MainThread]: On master: BEGIN
[0m00:55:59.560219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:59.568853 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:55:59.569536 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.570170 [debug] [MainThread]: Using postgres connection "master"
[0m00:55:59.570607 [debug] [MainThread]: On master: COMMIT
[0m00:55:59.571216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:55:59.571659 [debug] [MainThread]: On master: Close
[0m00:55:59.572344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:59.573162 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity_types' was properly closed.
[0m00:55:59.573871 [info ] [MainThread]: 
[0m00:55:59.575531 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:55:59.581203 [debug] [MainThread]: Command end result
[0m00:55:59.649782 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:55:59.653392 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:55:59.663726 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:55:59.664724 [info ] [MainThread]: 
[0m00:55:59.666280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:59.668191 [info ] [MainThread]: 
[0m00:55:59.669361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:55:59.671345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1650198, "process_in_blocks": "1376", "process_kernel_time": 0.207173, "process_mem_max_rss": "140928", "process_out_blocks": "2632", "process_user_time": 4.315776}
[0m00:55:59.672474 [debug] [MainThread]: Command `cli run` succeeded at 00:55:59.672311 after 2.17 seconds
[0m00:55:59.673563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c33fc7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c334a2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6c359f9070>]}
[0m00:55:59.674772 [debug] [MainThread]: Flushing usage events
[0m00:56:00.077187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:50.693108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fc2342f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbb3b140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbc9ff50>]}


============================== 20:24:50.696290 | e72eadf5-d389-4597-8e4c-1eb392a02cf2 ==============================
[0m20:24:50.696290 [info ] [MainThread]: Running with dbt=1.10.0
[0m20:24:50.697942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:24:50.929303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e72eadf5-d389-4597-8e4c-1eb392a02cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbec2030>]}
[0m20:24:50.941513 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:24:50.957880 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:24:50.959550 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.3214577, "process_in_blocks": "400", "process_kernel_time": 0.15386, "process_mem_max_rss": "117088", "process_out_blocks": "16", "process_user_time": 2.514717}
[0m20:24:50.960555 [debug] [MainThread]: Command `cli deps` succeeded at 20:24:50.960365 after 0.32 seconds
[0m20:24:50.961322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fb6ed670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fb5c40b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7312fbec1970>]}
[0m20:24:50.962206 [debug] [MainThread]: Flushing usage events
[0m20:24:51.373837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:12.040289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80ae929ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80aef87200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80ae8945f0>]}


============================== 21:41:12.043711 | 80b9a54b-9b42-435c-b0d6-57c75aeb1e05 ==============================
[0m21:41:12.043711 [info ] [MainThread]: Running with dbt=1.10.0
[0m21:41:12.044785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:41:12.182589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80b9a54b-9b42-435c-b0d6-57c75aeb1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80af132bd0>]}
[0m21:41:12.207868 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:41:12.227410 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:41:12.230378 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2538539, "process_in_blocks": "400", "process_kernel_time": 0.174642, "process_mem_max_rss": "116924", "process_out_blocks": "8", "process_user_time": 2.45797}
[0m21:41:12.232099 [debug] [MainThread]: Command `cli deps` succeeded at 21:41:12.231904 after 0.26 seconds
[0m21:41:12.233004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80b0dcae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80af001910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d80ae347aa0>]}
[0m21:41:12.234085 [debug] [MainThread]: Flushing usage events
[0m21:41:12.650710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:01.066365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f790eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f76b6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7c1e480>]}


============================== 23:29:01.097965 | cf8ae08a-6f11-4436-93cd-649c3b0e5222 ==============================
[0m23:29:01.097965 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:29:01.100687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:01.284688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7017dd0>]}
[0m23:29:01.353613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f75d14f0>]}
[0m23:29:01.354678 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:29:01.699252 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m23:29:01.809017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:29:01.809986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:29:01.872133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7e6b770>]}
[0m23:29:02.005889 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:29:02.035036 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:29:02.063292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f4d02ae0>]}
[0m23:29:02.064063 [info ] [MainThread]: Found 6 models, 6 sources, 434 macros
[0m23:29:02.064692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7017260>]}
[0m23:29:02.067278 [info ] [MainThread]: 
[0m23:29:02.067963 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:02.068471 [info ] [MainThread]: 
[0m23:29:02.069286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:02.075004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:29:02.112717 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:29:02.113371 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:29:02.113862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:02.124438 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m23:29:02.126168 [debug] [ThreadPool]: On list_postgres: Close
[0m23:29:02.128443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m23:29:02.135854 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:29:02.136488 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m23:29:02.136989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:02.144640 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:29:02.145683 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:29:02.146183 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m23:29:02.168994 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.022 seconds
[0m23:29:02.171698 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m23:29:02.172947 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m23:29:02.187722 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.189504 [debug] [MainThread]: On master: BEGIN
[0m23:29:02.190471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:02.234021 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m23:29:02.234900 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.244470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:29:02.257832 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m23:29:02.267839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f614bbf0>]}
[0m23:29:02.277636 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:02.288161 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.290787 [debug] [MainThread]: On master: BEGIN
[0m23:29:02.308850 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:29:02.309778 [debug] [MainThread]: On master: COMMIT
[0m23:29:02.312478 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:02.317795 [debug] [MainThread]: On master: COMMIT
[0m23:29:02.328817 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:29:02.330258 [debug] [MainThread]: On master: Close
[0m23:29:02.369646 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m23:29:02.372918 [info ] [Thread-1 (]: 1 of 6 START sql view model pipedrive_analytics.stg_activity ................... [RUN]
[0m23:29:02.383452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m23:29:02.384457 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m23:29:02.450828 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m23:29:02.453777 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m23:29:02.621676 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m23:29:02.624852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.625798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m23:29:02.626733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.645686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m23:29:02.646711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.647666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt 

                    FROM "postgres"."public"."activity"
)

SELECT *
FROM transformed
  );
[0m23:29:02.675559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m23:29:02.682835 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.683477 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m23:29:02.684578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.701868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:29:02.702578 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.703112 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:29:02.705577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:29:02.712519 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m23:29:02.718551 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:29:02.719184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m23:29:02.720092 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:02.722840 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m23:29:02.727604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f989d6d0>]}
[0m23:29:02.728611 [info ] [Thread-1 (]: 1 of 6 OK created sql view model pipedrive_analytics.stg_activity .............. [[32mCREATE VIEW[0m in 0.34s]
[0m23:29:02.729480 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m23:29:02.730075 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.730793 [info ] [Thread-1 (]: 2 of 6 START sql view model pipedrive_analytics.stg_activity_types ............. [RUN]
[0m23:29:02.731499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m23:29:02.732022 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.735885 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.737090 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.743336 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.744988 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.745976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m23:29:02.746683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.754243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:29:02.755149 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.755677 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
)

SELECT *
FROM transformed
  );
[0m23:29:02.758079 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:02.761973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.762769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m23:29:02.764523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.767882 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.768446 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m23:29:02.769588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.775041 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m23:29:02.775666 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.776149 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m23:29:02.778151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:29:02.782162 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m23:29:02.783818 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m23:29:02.784798 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m23:29:02.787211 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:29:02.789042 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m23:29:02.789936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3eac320>]}
[0m23:29:02.791158 [info ] [Thread-1 (]: 2 of 6 OK created sql view model pipedrive_analytics.stg_activity_types ........ [[32mCREATE VIEW[0m in 0.06s]
[0m23:29:02.792238 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m23:29:02.793089 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.793795 [info ] [Thread-1 (]: 3 of 6 START sql view model pipedrive_analytics.stg_deal_changes ............... [RUN]
[0m23:29:02.794489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m23:29:02.795049 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.800345 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.801863 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.806979 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.807942 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.808488 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m23:29:02.808969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.816522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:29:02.817312 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.817864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            deal_id,
                            CAST(change_time AS TIMESTAMP) change_dt,
                            changed_field_key,
                            new_value

                    FROM "postgres"."public"."deal_changes"
)

SELECT 
      *
FROM transformed
  );
[0m23:29:02.822547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:29:02.827385 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.828096 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m23:29:02.829170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.831021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:29:02.831584 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.832060 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m23:29:02.833597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:02.838441 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m23:29:02.841069 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m23:29:02.843991 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m23:29:02.847759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:29:02.851185 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m23:29:02.854262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3f34050>]}
[0m23:29:02.855799 [info ] [Thread-1 (]: 3 of 6 OK created sql view model pipedrive_analytics.stg_deal_changes .......... [[32mCREATE VIEW[0m in 0.06s]
[0m23:29:02.857273 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m23:29:02.858232 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m23:29:02.859320 [info ] [Thread-1 (]: 4 of 6 START sql view model pipedrive_analytics.stg_fields ..................... [RUN]
[0m23:29:02.860222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m23:29:02.860764 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m23:29:02.866782 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m23:29:02.867683 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m23:29:02.871568 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m23:29:02.872413 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.872949 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m23:29:02.873389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.881153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:02.881915 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.882455 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp"
    
    
  as (
    

WITH

raw AS (
        SELECT 
              id          AS field_id,
              field_key,
              name        AS field_name,
              field_value_options

        FROM "postgres"."public"."fields"
)

, base AS (
            SELECT
                  field_id,
                  field_key,
                  field_value_options
                  
            FROM raw
            WHERE field_value_options IS NOT NULL
)

, exploded AS (
                SELECT
                      b.field_id,
                      b.field_key,
                      e.elem->>'id'    AS option_id,
                      e.elem->>'label' AS option_label

                FROM base b
                CROSS JOIN lateral
                    jsonb_array_elements(b.field_value_options) WITH ordinality AS e(elem, ord)
)

, transformed AS (
                    SELECT
                          r.field_id,
                          r.field_key,
                          r.field_name,
                          CASE
                              WHEN e.option_id ~ '^\d+$' THEN e.option_id::int
                              ELSE NULL
                          END AS option_id,
                          e.option_label
                        
                    FROM raw r
                    LEFT JOIN exploded e    USING (field_id)
)
SELECT
        *
FROM transformed
ORDER BY field_id, 
         option_id
  );
[0m23:29:02.892940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m23:29:02.896803 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.897447 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m23:29:02.898654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:02.900500 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m23:29:02.901053 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.901515 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m23:29:02.903425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:02.907352 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_fields__dbt_backup"
[0m23:29:02.909235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m23:29:02.910165 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m23:29:02.911314 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:02.912920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m23:29:02.913747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3ed3890>]}
[0m23:29:02.914869 [info ] [Thread-1 (]: 4 of 6 OK created sql view model pipedrive_analytics.stg_fields ................ [[32mCREATE VIEW[0m in 0.05s]
[0m23:29:02.915895 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m23:29:02.916739 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m23:29:02.917431 [info ] [Thread-1 (]: 5 of 6 START sql view model pipedrive_analytics.stg_stages ..................... [RUN]
[0m23:29:02.918085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m23:29:02.918587 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m23:29:02.924837 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m23:29:02.926470 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m23:29:02.934878 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m23:29:02.935783 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.936305 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m23:29:02.936772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.945043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:29:02.945964 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.946990 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            stage_id,
                            stage_name

                    FROM "postgres"."public"."stages"
)

SELECT *
FROM transformed
  );
[0m23:29:02.949340 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:02.954568 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.955619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m23:29:02.956969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:29:02.959898 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m23:29:02.960608 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.961127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m23:29:02.962902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:02.966081 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_stages__dbt_backup"
[0m23:29:02.967191 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m23:29:02.967779 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m23:29:02.968673 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:29:02.970202 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m23:29:02.971030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3ee8d70>]}
[0m23:29:02.972197 [info ] [Thread-1 (]: 5 of 6 OK created sql view model pipedrive_analytics.stg_stages ................ [[32mCREATE VIEW[0m in 0.05s]
[0m23:29:02.973437 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m23:29:02.974111 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m23:29:02.974778 [info ] [Thread-1 (]: 6 of 6 START sql view model pipedrive_analytics.stg_users ...................... [RUN]
[0m23:29:02.975430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m23:29:02.975913 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m23:29:02.979574 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m23:29:02.980730 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m23:29:02.986975 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m23:29:02.988299 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:02.989190 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m23:29:02.989976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:02.999107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:29:02.999924 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.000461 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with 

transformed as (

                SELECT 
                      id          as user_id,
                      name        as user_name,
                      email       as user_email,
                      modified    as user_modified_at

                FROM "postgres"."public"."users"
)

SELECT 
      *
FROM transformed
  );
[0m23:29:03.002616 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m23:29:03.007616 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.008574 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m23:29:03.010008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:03.015128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.015801 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m23:29:03.016893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:03.019021 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m23:29:03.019585 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.020063 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m23:29:03.021442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:03.024210 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_users__dbt_backup"
[0m23:29:03.025757 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m23:29:03.026640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m23:29:03.031446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:29:03.034098 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m23:29:03.035296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf8ae08a-6f11-4436-93cd-649c3b0e5222', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f3f8fa70>]}
[0m23:29:03.038093 [info ] [Thread-1 (]: 6 of 6 OK created sql view model pipedrive_analytics.stg_users ................. [[32mCREATE VIEW[0m in 0.06s]
[0m23:29:03.039243 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m23:29:03.041229 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:03.042030 [debug] [MainThread]: On master: BEGIN
[0m23:29:03.042863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:03.053467 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m23:29:03.054241 [debug] [MainThread]: On master: COMMIT
[0m23:29:03.054784 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:03.055213 [debug] [MainThread]: On master: COMMIT
[0m23:29:03.055888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:03.056338 [debug] [MainThread]: On master: Close
[0m23:29:03.057020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:03.057721 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:29:03.058287 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_users' was properly closed.
[0m23:29:03.059008 [info ] [MainThread]: 
[0m23:29:03.059745 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m23:29:03.061562 [debug] [MainThread]: Command end result
[0m23:29:03.091954 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:29:03.095266 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:29:03.105410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:29:03.106274 [info ] [MainThread]: 
[0m23:29:03.107351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:03.108026 [info ] [MainThread]: 
[0m23:29:03.108922 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m23:29:03.111825 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.101913, "process_in_blocks": "1400", "process_kernel_time": 0.297424, "process_mem_max_rss": "138180", "process_out_blocks": "1992", "process_user_time": 4.514724}
[0m23:29:03.113282 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:03.113083 after 2.10 seconds
[0m23:29:03.114375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7687020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f9032a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a51f7aef170>]}
[0m23:29:03.115324 [debug] [MainThread]: Flushing usage events
[0m23:29:03.610456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:59.540477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05a4e1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05a4e2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a059d2a8a0>]}


============================== 23:56:59.544041 | 265e6e10-1232-490c-9223-aab05ef08256 ==============================
[0m23:56:59.544041 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:56:59.545006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:59.731518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a059772f90>]}
[0m23:56:59.797085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a059b99070>]}
[0m23:56:59.798132 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:56:59.961869 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m23:57:00.070973 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:57:00.071686 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m23:57:00.072274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a058750140>]}
[0m23:57:01.155881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05778ec30>]}
[0m23:57:01.232644 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:57:01.246584 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:57:01.267710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057f7f7d0>]}
[0m23:57:01.268742 [info ] [MainThread]: Found 6 models, 6 sources, 434 macros
[0m23:57:01.269492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057b56150>]}
[0m23:57:01.272486 [info ] [MainThread]: 
[0m23:57:01.273308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:01.274132 [info ] [MainThread]: 
[0m23:57:01.275907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:01.277624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:57:01.344216 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:57:01.345451 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:57:01.346357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:01.360450 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m23:57:01.363336 [debug] [ThreadPool]: On list_postgres: Close
[0m23:57:01.377362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m23:57:01.397447 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:57:01.400450 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m23:57:01.401192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:01.443178 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m23:57:01.445631 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m23:57:01.446486 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m23:57:01.463816 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m23:57:01.472579 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m23:57:01.474366 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m23:57:01.484407 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.485508 [debug] [MainThread]: On master: BEGIN
[0m23:57:01.486344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:01.499435 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:57:01.500464 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.501375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:57:01.513024 [debug] [MainThread]: SQL status: SELECT 6 in 0.011 seconds
[0m23:57:01.515891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057b69070>]}
[0m23:57:01.517029 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:01.518185 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.519018 [debug] [MainThread]: On master: BEGIN
[0m23:57:01.521043 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:57:01.521971 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.522757 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.523835 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.524892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:01.525896 [debug] [MainThread]: On master: Close
[0m23:57:01.538782 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m23:57:01.540929 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity ................... [RUN]
[0m23:57:01.542279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m23:57:01.543151 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m23:57:01.556637 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m23:57:01.560417 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m23:57:01.655717 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m23:57:01.657872 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.660031 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m23:57:01.662891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:01.694051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m23:57:01.700414 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.706020 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt,
                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num 

                    FROM "postgres"."public"."activity"
)

SELECT *
FROM transformed
WHERE row_num = 1
  );
[0m23:57:01.734952 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m23:57:01.749231 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.752205 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m23:57:01.755906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:57:01.765030 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.766127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m23:57:01.767923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:01.802184 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:57:01.803310 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.804295 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m23:57:01.806661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:57:01.819141 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m23:57:01.833479 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m23:57:01.834628 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m23:57:01.838872 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:57:01.843490 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m23:57:01.849066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '265e6e10-1232-490c-9223-aab05ef08256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a0561d9b80>]}
[0m23:57:01.850502 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity .............. [[32mCREATE VIEW[0m in 0.30s]
[0m23:57:01.852615 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m23:57:01.854781 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.855599 [debug] [MainThread]: On master: BEGIN
[0m23:57:01.856268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:01.867976 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m23:57:01.869111 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.869878 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:01.870597 [debug] [MainThread]: On master: COMMIT
[0m23:57:01.871547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:01.872293 [debug] [MainThread]: On master: Close
[0m23:57:01.873208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:01.873924 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m23:57:01.877023 [info ] [MainThread]: 
[0m23:57:01.877916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m23:57:01.879279 [debug] [MainThread]: Command end result
[0m23:57:01.943113 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m23:57:01.954971 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m23:57:01.983755 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m23:57:01.984591 [info ] [MainThread]: 
[0m23:57:01.985455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:01.988245 [info ] [MainThread]: 
[0m23:57:01.989245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:57:01.991000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.514063, "process_in_blocks": "152", "process_kernel_time": 0.254356, "process_mem_max_rss": "140904", "process_out_blocks": "2712", "process_user_time": 4.679761}
[0m23:57:01.992037 [debug] [MainThread]: Command `cli run` succeeded at 23:57:01.991864 after 2.52 seconds
[0m23:57:01.992941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05c18ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a05a403470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a057b9e510>]}
[0m23:57:01.993861 [debug] [MainThread]: Flushing usage events
[0m23:57:02.427709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:55.999973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e74ef2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7726b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e750c7b30>]}


============================== 00:00:56.003338 | dfb3a460-c937-4583-932b-6d7d9e60b4e1 ==============================
[0m00:00:56.003338 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:00:56.004258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:00:56.185410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e73ef77a0>]}
[0m00:00:56.251018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e76ca2120>]}
[0m00:00:56.252417 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:00:56.450394 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:00:56.558636 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:00:56.559478 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:00:56.560216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e733eeb70>]}
[0m00:00:58.728103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e72726f00>]}
[0m00:00:58.808688 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:00:58.821903 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:00:58.843557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7333d430>]}
[0m00:00:58.844568 [info ] [MainThread]: Found 6 models, 6 sources, 434 macros
[0m00:00:58.845368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e733a1520>]}
[0m00:00:58.849327 [info ] [MainThread]: 
[0m00:00:58.850729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:58.851980 [info ] [MainThread]: 
[0m00:00:58.853026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:58.855647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:00:58.914696 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:00:58.916197 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:00:58.917135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:58.929331 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m00:00:58.930964 [debug] [ThreadPool]: On list_postgres: Close
[0m00:00:58.937070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:00:58.943452 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:00:58.944075 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:00:58.944546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:58.952103 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m00:00:58.952895 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:00:58.953364 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:00:58.956547 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m00:00:58.958379 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:00:58.959278 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:00:58.967303 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.967854 [debug] [MainThread]: On master: BEGIN
[0m00:00:58.968260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:58.975652 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:00:58.976239 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.976774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:00:58.980969 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m00:00:58.982752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e72f11cd0>]}
[0m00:00:58.983891 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:58.986024 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.986618 [debug] [MainThread]: On master: BEGIN
[0m00:00:58.987446 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:58.988352 [debug] [MainThread]: On master: COMMIT
[0m00:00:58.988876 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:58.989313 [debug] [MainThread]: On master: COMMIT
[0m00:00:58.989985 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:58.990446 [debug] [MainThread]: On master: Close
[0m00:00:58.994624 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m00:00:58.995465 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity ................... [RUN]
[0m00:00:58.996415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m00:00:58.997683 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m00:00:59.009752 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m00:00:59.010743 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m00:00:59.057424 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m00:00:59.058428 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.058971 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m00:00:59.059417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:59.069730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:00:59.070383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.070920 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt,
                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num 

                    FROM "postgres"."public"."activity"
)

SELECT 
       activity_id,
       type,
       assigned_to_user,
       deal_id,
       done,
       due_to_dt
FROM transformed
WHERE row_num = 1
  );
[0m00:00:59.074413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:00:59.086776 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.087404 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m00:00:59.088491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:59.093489 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.094372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m00:00:59.095886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:59.118635 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m00:00:59.119672 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.120480 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m00:00:59.124886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:00:59.141289 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m00:00:59.147670 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m00:00:59.148619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m00:00:59.150850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:00:59.153739 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m00:00:59.157340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb3a460-c937-4583-932b-6d7d9e60b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7702f3e0>]}
[0m00:00:59.159434 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity .............. [[32mCREATE VIEW[0m in 0.16s]
[0m00:00:59.162056 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m00:00:59.165820 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:59.166732 [debug] [MainThread]: On master: BEGIN
[0m00:00:59.167691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:59.177862 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:00:59.178454 [debug] [MainThread]: On master: COMMIT
[0m00:00:59.178903 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:59.179294 [debug] [MainThread]: On master: COMMIT
[0m00:00:59.180375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:59.180906 [debug] [MainThread]: On master: Close
[0m00:00:59.181649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:59.182277 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m00:00:59.182893 [info ] [MainThread]: 
[0m00:00:59.183900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m00:00:59.184859 [debug] [MainThread]: Command end result
[0m00:00:59.225247 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:00:59.228917 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:00:59.238869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:00:59.239731 [info ] [MainThread]: 
[0m00:00:59.240623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:59.241391 [info ] [MainThread]: 
[0m00:00:59.242177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:00:59.243885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.299033, "process_in_blocks": "0", "process_kernel_time": 0.263759, "process_mem_max_rss": "140888", "process_out_blocks": "2712", "process_user_time": 5.097704}
[0m00:00:59.244898 [debug] [MainThread]: Command `cli run` succeeded at 00:00:59.244732 after 3.30 seconds
[0m00:00:59.245734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e754160f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e74785220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e7013a270>]}
[0m00:00:59.246600 [debug] [MainThread]: Flushing usage events
[0m00:00:59.628059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:19.772816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f78e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b273374d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f7b7cb0>]}


============================== 00:27:19.776362 | ec42bc8c-843b-46bb-9353-4bc6fdc47d20 ==============================
[0m00:27:19.776362 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:27:19.777254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:27:19.961724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2731200080>]}
[0m00:27:20.026160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2730fb18e0>]}
[0m00:27:20.027190 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:27:20.191506 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:27:20.271008 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:27:20.271714 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:27:20.272242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f09d640>]}
[0m00:27:21.451893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272c9afe00>]}
[0m00:27:21.587994 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:27:21.601781 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:27:21.622585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272cda4f50>]}
[0m00:27:21.623648 [info ] [MainThread]: Found 7 models, 6 sources, 434 macros
[0m00:27:21.624448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272c9c6600>]}
[0m00:27:21.627300 [info ] [MainThread]: 
[0m00:27:21.628200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:27:21.628946 [info ] [MainThread]: 
[0m00:27:21.629932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:27:21.631886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:27:21.693649 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:27:21.694628 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:27:21.695463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:21.713284 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m00:27:21.716309 [debug] [ThreadPool]: On list_postgres: Close
[0m00:27:21.729653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:27:21.741323 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:27:21.742146 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:27:21.742836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:27:21.754550 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:27:21.755368 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:27:21.756127 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:27:21.761031 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m00:27:21.763669 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:27:21.764853 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:27:21.776106 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.776960 [debug] [MainThread]: On master: BEGIN
[0m00:27:21.777681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:27:21.790389 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:27:21.793599 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.794662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:27:21.802962 [debug] [MainThread]: SQL status: SELECT 6 in 0.007 seconds
[0m00:27:21.807340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272d9c85c0>]}
[0m00:27:21.808375 [debug] [MainThread]: On master: ROLLBACK
[0m00:27:21.809548 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.810417 [debug] [MainThread]: On master: BEGIN
[0m00:27:21.812798 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:27:21.813631 [debug] [MainThread]: On master: COMMIT
[0m00:27:21.814398 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:21.815119 [debug] [MainThread]: On master: COMMIT
[0m00:27:21.816133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:27:21.816870 [debug] [MainThread]: On master: Close
[0m00:27:21.827358 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m00:27:21.828668 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_activites .................. [RUN]
[0m00:27:21.829741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_activites)
[0m00:27:21.830782 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m00:27:21.844251 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m00:27:21.845725 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m00:27:21.908060 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activites"
[0m00:27:21.909990 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.910984 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: BEGIN
[0m00:27:21.911843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:21.925844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:27:21.926811 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.928090 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */

  create view "postgres"."pipedrive_analytics"."int_activites__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
          SELECT 
                ac.activity_id,
                ac.deal_id,
                ac.type,
                act.name,
                ac.assigned_to_user,
                ac.due_to_dt,
                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month
                
          FROM "postgres"."pipedrive_analytics"."stg_activity" ac
          LEFT JOIN "postgres"."pipedrive_analytics"."stg_activity_types" act ON ac.type = act.type
          WHERE TRUE 
              AND ac.done
              AND act.name IN ('Sales Call 1', 'Sales Call 2')
)

SELECT *
FROM base
  );
[0m00:27:21.942143 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m00:27:21.960273 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.961312 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
alter table "postgres"."pipedrive_analytics"."int_activites__dbt_tmp" rename to "int_activites"
[0m00:27:21.962921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:27:21.994026 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m00:27:21.995097 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:21.995998 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m00:27:21.998797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:27:22.014918 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_activites__dbt_backup"
[0m00:27:22.024448 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m00:27:22.025570 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
drop view if exists "postgres"."pipedrive_analytics"."int_activites__dbt_backup" cascade
[0m00:27:22.027055 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m00:27:22.031427 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: Close
[0m00:27:22.037519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec42bc8c-843b-46bb-9353-4bc6fdc47d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b27311d7110>]}
[0m00:27:22.039009 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_activites ............. [[32mCREATE VIEW[0m in 0.21s]
[0m00:27:22.040361 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m00:27:22.042347 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:22.043214 [debug] [MainThread]: On master: BEGIN
[0m00:27:22.043961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:27:22.056597 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:27:22.057607 [debug] [MainThread]: On master: COMMIT
[0m00:27:22.058406 [debug] [MainThread]: Using postgres connection "master"
[0m00:27:22.059171 [debug] [MainThread]: On master: COMMIT
[0m00:27:22.060196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:27:22.060985 [debug] [MainThread]: On master: Close
[0m00:27:22.064624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:22.065431 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_activites' was properly closed.
[0m00:27:22.066192 [info ] [MainThread]: 
[0m00:27:22.070100 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m00:27:22.071695 [debug] [MainThread]: Command end result
[0m00:27:22.110304 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:27:22.114678 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:27:22.124279 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:27:22.125188 [info ] [MainThread]: 
[0m00:27:22.126104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:27:22.126878 [info ] [MainThread]: 
[0m00:27:22.127662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:27:22.129407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4120617, "process_in_blocks": "0", "process_kernel_time": 0.293556, "process_mem_max_rss": "140936", "process_out_blocks": "2744", "process_user_time": 4.679981}
[0m00:27:22.130497 [debug] [MainThread]: Command `cli run` succeeded at 00:27:22.130327 after 2.41 seconds
[0m00:27:22.131323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272eedf200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272f1645c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b272c9ad8b0>]}
[0m00:27:22.132233 [debug] [MainThread]: Flushing usage events
[0m00:27:22.542978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:48.041026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dd1f0>]}


============================== 00:33:48.044778 | b426fa81-ba91-4f43-8654-e99ff81eeb4b ==============================
[0m00:33:48.044778 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:33:48.045971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:33:48.209685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b426fa81-ba91-4f43-8654-e99ff81eeb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f05c8c0>]}
[0m00:33:48.228109 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:33:48.229504 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:33:48.231386 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.25253686, "process_in_blocks": "176", "process_kernel_time": 0.160936, "process_mem_max_rss": "116552", "process_out_blocks": "8", "process_user_time": 2.788907}
[0m00:33:48.232368 [debug] [MainThread]: Command `cli deps` succeeded at 00:33:48.232193 after 0.25 seconds
[0m00:33:48.233352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f7ac200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8dfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c26f8de930>]}
[0m00:33:48.234433 [debug] [MainThread]: Flushing usage events
[0m00:33:48.653479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:43.174940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6d7bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd90f3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd731cfb0>]}


============================== 00:44:43.178428 | 66aaae8c-3f3e-4a44-bd10-09aff369e985 ==============================
[0m00:44:43.178428 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:44:43.179398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:44:43.392231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd57e6300>]}
[0m00:44:43.456946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6c95130>]}
[0m00:44:43.457991 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:44:43.647403 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:44:43.728007 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:44:43.728737 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:44:43.729349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6d78fb0>]}
[0m00:44:45.002045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd43faf00>]}
[0m00:44:45.163960 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:44:45.179571 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:44:45.204151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd4b17560>]}
[0m00:44:45.205154 [info ] [MainThread]: Found 7 models, 6 sources, 434 macros
[0m00:44:45.205920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd4bb9310>]}
[0m00:44:45.208631 [info ] [MainThread]: 
[0m00:44:45.209393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:44:45.210061 [info ] [MainThread]: 
[0m00:44:45.211013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:44:45.212433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:44:45.272320 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:44:45.273240 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:44:45.274026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:45.288719 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m00:44:45.291230 [debug] [ThreadPool]: On list_postgres: Close
[0m00:44:45.302104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:44:45.312920 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:44:45.313782 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:44:45.314459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:45.327079 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.327984 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:44:45.328741 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:44:45.333997 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m00:44:45.336925 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:44:45.338085 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:44:45.351024 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.351877 [debug] [MainThread]: On master: BEGIN
[0m00:44:45.352597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:45.364915 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.365808 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.366641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:44:45.372405 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m00:44:45.375862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd47b71a0>]}
[0m00:44:45.376892 [debug] [MainThread]: On master: ROLLBACK
[0m00:44:45.377903 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.378616 [debug] [MainThread]: On master: BEGIN
[0m00:44:45.379891 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:44:45.380590 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.381277 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.382153 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.383118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:44:45.383831 [debug] [MainThread]: On master: Close
[0m00:44:45.390087 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.391411 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_deal_changes ............... [RUN]
[0m00:44:45.392430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_deal_changes)
[0m00:44:45.393280 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.406663 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.407954 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.480067 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.481521 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.484135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m00:44:45.484960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:45.497128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.498234 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.499135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            deal_id,
                            CAST(change_time AS TIMESTAMP) change_dt,
                            changed_field_key,
                            new_value,
                            row_number() OVER (
                                PARTITION BY deal_id, changed_field_key, new_value,  change_time) AS rn

                    FROM "postgres"."public"."deal_changes"
)

SELECT 
      deal_id,
      change_dt,
      changed_field_key,
      new_value

FROM transformed
WHERE rn = 1
  );
[0m00:44:45.503094 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m00:44:45.514973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.516135 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m00:44:45.517875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:45.523967 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.525059 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m00:44:45.526764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:44:45.556871 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m00:44:45.558036 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.559077 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m00:44:45.569412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m00:44:45.581451 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m00:44:45.591458 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m00:44:45.592714 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m00:44:45.595722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:44:45.600465 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m00:44:45.603672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66aaae8c-3f3e-4a44-bd10-09aff369e985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd8eaecc0>]}
[0m00:44:45.605246 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_deal_changes .......... [[32mCREATE VIEW[0m in 0.21s]
[0m00:44:45.606736 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m00:44:45.608931 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.609869 [debug] [MainThread]: On master: BEGIN
[0m00:44:45.610775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:44:45.623179 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:44:45.624210 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.625136 [debug] [MainThread]: Using postgres connection "master"
[0m00:44:45.625954 [debug] [MainThread]: On master: COMMIT
[0m00:44:45.627073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:44:45.627923 [debug] [MainThread]: On master: Close
[0m00:44:45.629944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:45.632387 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_deal_changes' was properly closed.
[0m00:44:45.633513 [info ] [MainThread]: 
[0m00:44:45.634395 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m00:44:45.635794 [debug] [MainThread]: Command end result
[0m00:44:45.686004 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:44:45.695746 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:44:45.711247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:44:45.712273 [info ] [MainThread]: 
[0m00:44:45.713304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:45.716077 [info ] [MainThread]: 
[0m00:44:45.717025 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:44:45.719022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.6012967, "process_in_blocks": "0", "process_kernel_time": 0.272472, "process_mem_max_rss": "140920", "process_out_blocks": "2744", "process_user_time": 4.729489}
[0m00:44:45.720026 [debug] [MainThread]: Command `cli run` succeeded at 00:44:45.719852 after 2.60 seconds
[0m00:44:45.720788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6d13bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6700da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799dd6700a70>]}
[0m00:44:45.721493 [debug] [MainThread]: Flushing usage events
[0m00:44:46.138933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:42.451849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb875739040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb87575f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8758a6ea0>]}


============================== 01:16:42.455061 | 411f645b-9631-478e-b3b1-4a206d142d32 ==============================
[0m01:16:42.455061 [info ] [MainThread]: Running with dbt=1.10.0
[0m01:16:42.456001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:16:42.631343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8745f1850>]}
[0m01:16:42.701370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8751b2ed0>]}
[0m01:16:42.702838 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:16:42.883870 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m01:16:42.995132 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:16:42.995915 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m01:16:42.996469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8739f7bc0>]}
[0m01:16:44.051292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8731b0170>]}
[0m01:16:44.124791 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:16:44.134773 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:16:44.151288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8735b5d90>]}
[0m01:16:44.151987 [info ] [MainThread]: Found 8 models, 6 sources, 434 macros
[0m01:16:44.153125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb873554c80>]}
[0m01:16:44.156418 [info ] [MainThread]: 
[0m01:16:44.157492 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:44.158185 [info ] [MainThread]: 
[0m01:16:44.159169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:16:44.160719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:16:44.253008 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:16:44.254038 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:16:44.254920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:44.268831 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m01:16:44.271255 [debug] [ThreadPool]: On list_postgres: Close
[0m01:16:44.282020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:16:44.292245 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:16:44.293097 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:16:44.293817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:44.306386 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:16:44.307266 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:16:44.307975 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:16:44.312772 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m01:16:44.315521 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:16:44.316610 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:16:44.333128 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.334718 [debug] [MainThread]: On master: BEGIN
[0m01:16:44.336652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:16:44.349212 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:16:44.350099 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.351982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:16:44.358306 [debug] [MainThread]: SQL status: SELECT 8 in 0.005 seconds
[0m01:16:44.361653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8731bf5f0>]}
[0m01:16:44.362565 [debug] [MainThread]: On master: ROLLBACK
[0m01:16:44.363550 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.364184 [debug] [MainThread]: On master: BEGIN
[0m01:16:44.366060 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:16:44.368840 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.369517 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.370179 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.371081 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:16:44.371768 [debug] [MainThread]: On master: Close
[0m01:16:44.379607 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m01:16:44.381801 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages ..................... [RUN]
[0m01:16:44.382827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages)
[0m01:16:44.384606 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m01:16:44.401755 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m01:16:44.403249 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m01:16:44.511201 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m01:16:44.512494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.516504 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m01:16:44.517201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:44.531589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:16:44.532589 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.533937 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m01:16:44.537767 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:16:44.551644 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.553155 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m01:16:44.554825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:16:44.580918 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m01:16:44.581867 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.584403 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m01:16:44.590219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:16:44.613284 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m01:16:44.635918 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:16:44.636838 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m01:16:44.640460 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:16:44.650922 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m01:16:44.657159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411f645b-9631-478e-b3b1-4a206d142d32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb87797b1a0>]}
[0m01:16:44.659721 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages ................ [[32mCREATE VIEW[0m in 0.27s]
[0m01:16:44.661605 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m01:16:44.663515 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.665619 [debug] [MainThread]: On master: BEGIN
[0m01:16:44.666702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:16:44.686599 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:16:44.689721 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.690566 [debug] [MainThread]: Using postgres connection "master"
[0m01:16:44.691350 [debug] [MainThread]: On master: COMMIT
[0m01:16:44.694048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:16:44.696698 [debug] [MainThread]: On master: Close
[0m01:16:44.697639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:44.698502 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages' was properly closed.
[0m01:16:44.701005 [info ] [MainThread]: 
[0m01:16:44.701842 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m01:16:44.705557 [debug] [MainThread]: Command end result
[0m01:16:44.762705 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:16:44.766814 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:16:44.776912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m01:16:44.778145 [info ] [MainThread]: 
[0m01:16:44.779032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:44.779905 [info ] [MainThread]: 
[0m01:16:44.780681 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:16:44.782359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.385294, "process_in_blocks": "0", "process_kernel_time": 0.243272, "process_mem_max_rss": "140924", "process_out_blocks": "2752", "process_user_time": 4.401736}
[0m01:16:44.783378 [debug] [MainThread]: Command `cli run` succeeded at 01:16:44.783220 after 2.39 seconds
[0m01:16:44.784180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8751b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8735cb0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb8735c8bc0>]}
[0m01:16:44.785055 [debug] [MainThread]: Flushing usage events
[0m01:16:45.194689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:37.874199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d68e0d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d68757440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d68e0d4f0>]}


============================== 22:59:37.877363 | 08ea783d-3c9f-41cf-ae1b-59fb5b11f43c ==============================
[0m22:59:37.877363 [info ] [MainThread]: Running with dbt=1.10.0
[0m22:59:37.878407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m22:59:38.002234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08ea783d-3c9f-41cf-ae1b-59fb5b11f43c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d6af4a030>]}
[0m22:59:38.013877 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:38.016383 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:59:38.018165 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19751708, "process_in_blocks": "1312", "process_kernel_time": 0.149058, "process_mem_max_rss": "116824", "process_out_blocks": "8", "process_user_time": 2.58567}
[0m22:59:38.019598 [debug] [MainThread]: Command `cli deps` succeeded at 22:59:38.019434 after 0.20 seconds
[0m22:59:38.020327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d687b2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d685ea2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757d685ea270>]}
[0m22:59:38.021090 [debug] [MainThread]: Flushing usage events
[0m22:59:38.423097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:18.694705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b777b758e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b7774b5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b7774b67e0>]}


============================== 23:59:18.697823 | d500efd5-1076-4c4d-935c-3bdbf121cdd6 ==============================
[0m23:59:18.697823 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:59:18.698805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m23:59:18.856813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd500efd5-1076-4c4d-935c-3bdbf121cdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b777a225d0>]}
[0m23:59:18.871874 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:59:18.873009 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:59:18.875940 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.23499177, "process_in_blocks": "328", "process_kernel_time": 0.15578, "process_mem_max_rss": "116772", "process_out_blocks": "16", "process_user_time": 2.459538}
[0m23:59:18.876874 [debug] [MainThread]: Command `cli deps` succeeded at 23:59:18.876715 after 0.24 seconds
[0m23:59:18.877702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b777b758e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b7771e30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b779215b50>]}
[0m23:59:18.878381 [debug] [MainThread]: Flushing usage events
[0m23:59:19.281812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:37.211734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca16bb6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca1681bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca164dd7f0>]}


============================== 00:29:37.214992 | 929eea1d-dd15-493d-a1d9-e183326e4ea0 ==============================
[0m00:29:37.214992 [info ] [MainThread]: Running with dbt=1.10.0
[0m00:29:37.215939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m00:29:37.399161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca14f9f110>]}
[0m00:29:37.472200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca181105c0>]}
[0m00:29:37.473229 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:29:37.775871 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m00:29:37.854066 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:29:37.854899 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m00:29:37.855648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca161fc830>]}
[0m00:29:38.939630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca13b9c260>]}
[0m00:29:39.006849 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:29:39.025806 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:29:39.043484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca14359190>]}
[0m00:29:39.044474 [info ] [MainThread]: Found 8 models, 6 sources, 434 macros
[0m00:29:39.045617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca13f729c0>]}
[0m00:29:39.048316 [info ] [MainThread]: 
[0m00:29:39.049109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:39.049855 [info ] [MainThread]: 
[0m00:29:39.052868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:29:39.054255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:29:39.112121 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:29:39.113070 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:29:39.113788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:39.142645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m00:29:39.145342 [debug] [ThreadPool]: On list_postgres: Close
[0m00:29:39.155120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m00:29:39.164870 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:29:39.165603 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m00:29:39.166267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:39.177680 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:29:39.178553 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m00:29:39.179371 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m00:29:39.200487 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m00:29:39.205324 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m00:29:39.209372 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m00:29:39.220498 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.221416 [debug] [MainThread]: On master: BEGIN
[0m00:29:39.222185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:39.235473 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:29:39.237138 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.238051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:29:39.246709 [debug] [MainThread]: SQL status: SELECT 10 in 0.008 seconds
[0m00:29:39.250466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca12634e90>]}
[0m00:29:39.251416 [debug] [MainThread]: On master: ROLLBACK
[0m00:29:39.252414 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.253182 [debug] [MainThread]: On master: BEGIN
[0m00:29:39.254304 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:29:39.255028 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.255750 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.256458 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.257313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:39.258035 [debug] [MainThread]: On master: Close
[0m00:29:39.264374 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m00:29:39.265465 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages ..................... [RUN]
[0m00:29:39.266473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages)
[0m00:29:39.267307 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m00:29:39.281797 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m00:29:39.284725 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m00:29:39.355176 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m00:29:39.357814 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.358858 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m00:29:39.359737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:29:39.371211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:29:39.372016 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.372886 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH
users AS (
			SELECT 
				  deal_id,
				   new_value :: INT AS user_id,
				   change_dt AS assigned_user_start,
				   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end
			FROM "postgres"."pipedrive_analytics"."stg_deal_changes"
			WHERE TRUE 
				AND  changed_field_key= 'user_id'
) 
, 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name,
                u.user_id,
                u.assigned_user_start,
                u.assigned_user_end
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         LEFT JOIN users u                       ON dc.deal_id = u.deal_id 
					                                AND dc.change_dt >= u.assigned_user_start
					                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m00:29:39.448150 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.074 seconds
[0m00:29:39.458654 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.459484 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages" rename to "int_stages__dbt_backup"
[0m00:29:39.460909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:29:39.466178 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.466955 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m00:29:39.468335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:29:39.496342 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m00:29:39.497441 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.498360 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m00:29:39.501864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:29:39.512285 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m00:29:39.521023 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m00:29:39.521877 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m00:29:39.525717 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m00:29:39.529723 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m00:29:39.536232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929eea1d-dd15-493d-a1d9-e183326e4ea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca18332000>]}
[0m00:29:39.537472 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages ................ [[32mCREATE VIEW[0m in 0.27s]
[0m00:29:39.538684 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m00:29:39.540555 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.541372 [debug] [MainThread]: On master: BEGIN
[0m00:29:39.542128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:39.553077 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:29:39.553786 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.554488 [debug] [MainThread]: Using postgres connection "master"
[0m00:29:39.555175 [debug] [MainThread]: On master: COMMIT
[0m00:29:39.555942 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:29:39.556638 [debug] [MainThread]: On master: Close
[0m00:29:39.557467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:39.558090 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages' was properly closed.
[0m00:29:39.560925 [info ] [MainThread]: 
[0m00:29:39.561671 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m00:29:39.562969 [debug] [MainThread]: Command end result
[0m00:29:39.627266 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m00:29:39.635901 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m00:29:39.646916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m00:29:39.647685 [info ] [MainThread]: 
[0m00:29:39.648988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:39.649678 [info ] [MainThread]: 
[0m00:29:39.650400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:29:39.651925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.49394, "process_in_blocks": "1368", "process_kernel_time": 0.257279, "process_mem_max_rss": "141360", "process_out_blocks": "2760", "process_user_time": 4.377741}
[0m00:29:39.652854 [debug] [MainThread]: Command `cli run` succeeded at 00:29:39.652697 after 2.50 seconds
[0m00:29:39.653634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca161ffbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca15b6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cca1681ba40>]}
[0m00:29:39.654410 [debug] [MainThread]: Flushing usage events
[0m00:29:40.076824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:38.409626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5d7bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec6359d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5d7bec0>]}


============================== 01:18:38.412961 | 3f79b6aa-6445-4046-816d-d547ab8fa236 ==============================
[0m01:18:38.412961 [info ] [MainThread]: Running with dbt=1.10.0
[0m01:18:38.414010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:38.620804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec47b7aa0>]}
[0m01:18:38.682522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec56ca2d0>]}
[0m01:18:38.683514 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:18:38.860529 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m01:18:38.967013 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:18:38.967881 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m01:18:38.968654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5dad8b0>]}
[0m01:18:40.022823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec2b094c0>]}
[0m01:18:40.090184 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:18:40.101423 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:18:40.114590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec37b2c30>]}
[0m01:18:40.115486 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m01:18:40.116211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5b31f70>]}
[0m01:18:40.118890 [info ] [MainThread]: 
[0m01:18:40.119632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:40.120298 [info ] [MainThread]: 
[0m01:18:40.121182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:40.123181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:18:40.183904 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:18:40.184838 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:18:40.185616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:40.213319 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m01:18:40.215913 [debug] [ThreadPool]: On list_postgres: Close
[0m01:18:40.225664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:18:40.235608 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:18:40.236357 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:18:40.237059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:40.248349 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:18:40.249090 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:18:40.249847 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:18:40.254082 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m01:18:40.256598 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:18:40.257532 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:18:40.268835 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.269601 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.270295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:40.287138 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m01:18:40.288855 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.289752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:18:40.294877 [debug] [MainThread]: SQL status: SELECT 10 in 0.004 seconds
[0m01:18:40.298607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec20688f0>]}
[0m01:18:40.299487 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:40.300437 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.301135 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.302232 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:18:40.302857 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.303487 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.304074 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.305012 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:40.305681 [debug] [MainThread]: On master: Close
[0m01:18:40.310902 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.311907 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages_anmly ............... [RUN]
[0m01:18:40.312776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages_anmly)
[0m01:18:40.313552 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.325558 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.326781 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.383441 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.384957 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.385928 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: BEGIN
[0m01:18:40.386732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:40.397797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:18:40.398606 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.399417 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */

  create view "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp"
    
    
  as (
    

WITH 
stages AS (
			SELECT 
				  *,
				  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
				  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,
				  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn
				  
			FROM "postgres"."pipedrive_analytics"."int_stages" 			
)

, stages_anmly AS (
					SELECT 
						   *,
						   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg
								
					FROM stages
)

SELECT *
FROM stages_anmly
  );
[0m01:18:40.416450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m01:18:40.442383 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.445516 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
alter table "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp" rename to "int_stages_anmly"
[0m01:18:40.449083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:40.494211 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m01:18:40.495824 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.496755 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m01:18:40.499453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:18:40.510355 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup"
[0m01:18:40.518977 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:18:40.519871 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup" cascade
[0m01:18:40.521143 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:18:40.525125 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: Close
[0m01:18:40.527840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f79b6aa-6445-4046-816d-d547ab8fa236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec7ec2ea0>]}
[0m01:18:40.531551 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages_anmly .......... [[32mCREATE VIEW[0m in 0.21s]
[0m01:18:40.532727 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m01:18:40.534566 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.535454 [debug] [MainThread]: On master: BEGIN
[0m01:18:40.536287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:40.546973 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:18:40.547796 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.548595 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:40.549347 [debug] [MainThread]: On master: COMMIT
[0m01:18:40.550266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:40.551044 [debug] [MainThread]: On master: Close
[0m01:18:40.551950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:40.554608 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages_anmly' was properly closed.
[0m01:18:40.555471 [info ] [MainThread]: 
[0m01:18:40.556272 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m01:18:40.557615 [debug] [MainThread]: Command end result
[0m01:18:40.609934 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:18:40.614123 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:18:40.624160 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m01:18:40.625039 [info ] [MainThread]: 
[0m01:18:40.625964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:40.626724 [info ] [MainThread]: 
[0m01:18:40.627548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:18:40.629927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2824123, "process_in_blocks": "112", "process_kernel_time": 0.245118, "process_mem_max_rss": "141204", "process_out_blocks": "2768", "process_user_time": 4.22879}
[0m01:18:40.631518 [debug] [MainThread]: Command `cli run` succeeded at 01:18:40.631352 after 2.28 seconds
[0m01:18:40.632401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5c45820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec5daddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ec64d5970>]}
[0m01:18:40.633281 [debug] [MainThread]: Flushing usage events
[0m01:18:41.070183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:06:51.910178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3cf13740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3d5cb0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3d01d5b0>]}


============================== 02:06:51.913866 | fa9dace0-643c-4c1a-841c-7c58d3be74fa ==============================
[0m02:06:51.913866 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:06:51.914738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:06:52.095234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3efb7ce0>]}
[0m02:06:52.156677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3bb5c920>]}
[0m02:06:52.157657 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:06:52.317421 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:06:52.393319 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:06:52.393978 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:06:52.394555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3cea18b0>]}
[0m02:06:54.079072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3a7c9fd0>]}
[0m02:06:54.259520 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:06:54.269602 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:06:54.282840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3abbb890>]}
[0m02:06:54.283458 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:06:54.284007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3a757800>]}
[0m02:06:54.286204 [info ] [MainThread]: 
[0m02:06:54.287084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:06:54.287844 [info ] [MainThread]: 
[0m02:06:54.288552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:06:54.289679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:06:54.340737 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:06:54.341774 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:06:54.342669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:06:54.356749 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:06:54.359264 [debug] [ThreadPool]: On list_postgres: Close
[0m02:06:54.372388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:06:54.378871 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:06:54.379419 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:06:54.379820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:06:54.386823 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:06:54.387315 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:06:54.387783 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:06:54.390653 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m02:06:54.392153 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:06:54.392799 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:06:54.399203 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.399666 [debug] [MainThread]: On master: BEGIN
[0m02:06:54.400079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:06:54.407199 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:06:54.407674 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.408168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:06:54.411429 [debug] [MainThread]: SQL status: SELECT 11 in 0.003 seconds
[0m02:06:54.413698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3af733b0>]}
[0m02:06:54.414259 [debug] [MainThread]: On master: ROLLBACK
[0m02:06:54.414878 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.415337 [debug] [MainThread]: On master: BEGIN
[0m02:06:54.416284 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:06:54.416881 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.417662 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.418597 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.419520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:06:54.420044 [debug] [MainThread]: On master: Close
[0m02:06:54.423601 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.424267 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_activity_types ............. [RUN]
[0m02:06:54.424967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity_types)
[0m02:06:54.425561 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.435183 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.436010 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.468241 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.469156 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.469753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m02:06:54.470240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:06:54.477453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:06:54.477965 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.478499 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE 
                       		 WHEN name= 'Sales Call 1' THEN 'Step 2.1'
                       		 WHEN name= 'Sales Call 2' THEN 'Step 3.1'
                  	     END 				AS funnel_step,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
)

SELECT *
FROM transformed
  );
[0m02:06:54.480720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m02:06:54.486837 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.487350 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m02:06:54.488242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:06:54.491244 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.491729 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m02:06:54.492576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:06:54.508086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:06:54.508683 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.509177 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m02:06:54.520560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m02:06:54.529796 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m02:06:54.535192 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m02:06:54.535773 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m02:06:54.538054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m02:06:54.540544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m02:06:54.544007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa9dace0-643c-4c1a-841c-7c58d3be74fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3d59fda0>]}
[0m02:06:54.544785 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_activity_types ........ [[32mCREATE VIEW[0m in 0.12s]
[0m02:06:54.545705 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m02:06:54.547212 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.547943 [debug] [MainThread]: On master: BEGIN
[0m02:06:54.548729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:06:54.557602 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:06:54.558397 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.559144 [debug] [MainThread]: Using postgres connection "master"
[0m02:06:54.559901 [debug] [MainThread]: On master: COMMIT
[0m02:06:54.560828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:06:54.561582 [debug] [MainThread]: On master: Close
[0m02:06:54.564472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:06:54.565169 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity_types' was properly closed.
[0m02:06:54.566174 [info ] [MainThread]: 
[0m02:06:54.566979 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:06:54.568277 [debug] [MainThread]: Command end result
[0m02:06:54.607981 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:06:54.611643 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:06:54.622290 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:06:54.623300 [info ] [MainThread]: 
[0m02:06:54.624704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:06:54.625768 [info ] [MainThread]: 
[0m02:06:54.626836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:06:54.628994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7797508, "process_in_blocks": "32", "process_kernel_time": 0.252017, "process_mem_max_rss": "141020", "process_out_blocks": "2784", "process_user_time": 4.867717}
[0m02:06:54.630173 [debug] [MainThread]: Command `cli run` succeeded at 02:06:54.630001 after 2.78 seconds
[0m02:06:54.631507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3cef4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3b3f97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72aa3b7371d0>]}
[0m02:06:54.632444 [debug] [MainThread]: Flushing usage events
[0m02:06:55.016018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:07:50.797980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3187464c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3185d6c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31869fec30>]}


============================== 02:07:50.801202 | fa2d7884-76cf-4421-9982-433fec852894 ==============================
[0m02:07:50.801202 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:07:50.802131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:07:51.074805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31851e4b30>]}
[0m02:07:51.143364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31867195e0>]}
[0m02:07:51.144431 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:07:51.302816 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:07:51.378372 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:07:51.379026 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:07:51.379606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3186400fb0>]}
[0m02:07:52.515070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a318390d3a0>]}
[0m02:07:52.601923 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:07:52.618361 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:07:52.640599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31849f4aa0>]}
[0m02:07:52.641587 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:07:52.643392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a318393d4f0>]}
[0m02:07:52.646237 [info ] [MainThread]: 
[0m02:07:52.649333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:07:52.649986 [info ] [MainThread]: 
[0m02:07:52.652415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:07:52.654292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:07:52.718626 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:07:52.719525 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:07:52.720297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:52.734551 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:07:52.736848 [debug] [ThreadPool]: On list_postgres: Close
[0m02:07:52.746034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:07:52.755378 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:07:52.756090 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:07:52.756765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:52.767795 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m02:07:52.768528 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:07:52.769261 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:07:52.773269 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m02:07:52.775753 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:07:52.776684 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:07:52.789272 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.790033 [debug] [MainThread]: On master: BEGIN
[0m02:07:52.790690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:07:52.801689 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:07:52.802417 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.803265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:07:52.808144 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m02:07:52.811453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31845b94c0>]}
[0m02:07:52.812335 [debug] [MainThread]: On master: ROLLBACK
[0m02:07:52.813306 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.814001 [debug] [MainThread]: On master: BEGIN
[0m02:07:52.815174 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:07:52.815872 [debug] [MainThread]: On master: COMMIT
[0m02:07:52.816611 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:52.817332 [debug] [MainThread]: On master: COMMIT
[0m02:07:52.818205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:52.818897 [debug] [MainThread]: On master: Close
[0m02:07:52.824252 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m02:07:52.825295 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_activites .................. [RUN]
[0m02:07:52.826266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_activites)
[0m02:07:52.827101 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m02:07:52.839503 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m02:07:52.840878 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m02:07:52.926913 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activites"
[0m02:07:52.928542 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.929461 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: BEGIN
[0m02:07:52.930278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:52.941647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:07:52.942446 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.943293 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */

  create view "postgres"."pipedrive_analytics"."int_activites__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
          SELECT 
                ac.activity_id,
                ac.deal_id,
                ac.type,
                act.name,
                act.funnel_step,
                ac.assigned_to_user,
                ac.due_to_dt,
                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month
                
          FROM "postgres"."pipedrive_analytics"."stg_activity" ac
          LEFT JOIN "postgres"."pipedrive_analytics"."stg_activity_types" act ON ac.type = act.type
          WHERE TRUE 
              AND ac.done
              AND act.name IN ('Sales Call 1', 'Sales Call 2')
)

SELECT *
FROM base
  );
[0m02:07:52.947750 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m02:07:52.958246 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.959085 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
alter table "postgres"."pipedrive_analytics"."int_activites__dbt_tmp" rename to "int_activites"
[0m02:07:52.961964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m02:07:52.986911 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m02:07:52.987893 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:52.988762 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m02:07:52.990455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:07:53.000648 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_activites__dbt_backup"
[0m02:07:53.012075 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m02:07:53.012975 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
drop view if exists "postgres"."pipedrive_analytics"."int_activites__dbt_backup" cascade
[0m02:07:53.014287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:07:53.018194 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: Close
[0m02:07:53.021104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa2d7884-76cf-4421-9982-433fec852894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3188536240>]}
[0m02:07:53.024847 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_activites ............. [[32mCREATE VIEW[0m in 0.19s]
[0m02:07:53.026063 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m02:07:53.027853 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:53.028603 [debug] [MainThread]: On master: BEGIN
[0m02:07:53.029334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:53.040307 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:07:53.041058 [debug] [MainThread]: On master: COMMIT
[0m02:07:53.041837 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:53.042569 [debug] [MainThread]: On master: COMMIT
[0m02:07:53.043420 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:53.044088 [debug] [MainThread]: On master: Close
[0m02:07:53.044892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:53.047653 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_activites' was properly closed.
[0m02:07:53.048478 [info ] [MainThread]: 
[0m02:07:53.049260 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:07:53.050594 [debug] [MainThread]: Command end result
[0m02:07:53.087365 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:07:53.090438 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:07:53.099203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:07:53.099983 [info ] [MainThread]: 
[0m02:07:53.100843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:07:53.101576 [info ] [MainThread]: 
[0m02:07:53.102348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:07:53.103925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.36406, "process_in_blocks": "0", "process_kernel_time": 0.239998, "process_mem_max_rss": "140828", "process_out_blocks": "2784", "process_user_time": 4.404617}
[0m02:07:53.104880 [debug] [MainThread]: Command `cli run` succeeded at 02:07:53.104722 after 2.37 seconds
[0m02:07:53.105704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3186401430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31869c5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a31869c54c0>]}
[0m02:07:53.106520 [debug] [MainThread]: Flushing usage events
[0m02:07:53.509679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:41.950926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d91419a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d8f54710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11db468aa0>]}


============================== 02:09:41.954184 | dbea45df-6047-4c94-95f8-67984ed3a8f7 ==============================
[0m02:09:41.954184 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:09:41.955026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:09:42.124335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11db225370>]}
[0m02:09:42.185609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11daf5cce0>]}
[0m02:09:42.186627 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:09:42.378424 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:09:42.455396 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:09:42.456092 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:09:42.456627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d90e6d50>]}
[0m02:09:43.541674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d6dfd520>]}
[0m02:09:43.617619 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:09:43.634430 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:09:43.672011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d817da60>]}
[0m02:09:43.675767 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:09:43.678404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d7508710>]}
[0m02:09:43.683400 [info ] [MainThread]: 
[0m02:09:43.684429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:09:43.685697 [info ] [MainThread]: 
[0m02:09:43.687600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:09:43.696350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:09:43.784193 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:09:43.786260 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:09:43.786994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:09:43.800839 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:09:43.803049 [debug] [ThreadPool]: On list_postgres: Close
[0m02:09:43.810334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:09:43.825995 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:09:43.826775 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:09:43.829199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:09:43.840197 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m02:09:43.840848 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:09:43.841562 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:09:43.850060 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m02:09:43.853153 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:09:43.854371 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:09:43.871341 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.872074 [debug] [MainThread]: On master: BEGIN
[0m02:09:43.872764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:09:43.896056 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m02:09:43.896982 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.899052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:09:43.911303 [debug] [MainThread]: SQL status: SELECT 11 in 0.010 seconds
[0m02:09:43.921658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11d71967b0>]}
[0m02:09:43.925562 [debug] [MainThread]: On master: ROLLBACK
[0m02:09:43.927922 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.929596 [debug] [MainThread]: On master: BEGIN
[0m02:09:43.932784 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:09:43.934335 [debug] [MainThread]: On master: COMMIT
[0m02:09:43.936287 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:43.937003 [debug] [MainThread]: On master: COMMIT
[0m02:09:43.939513 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m02:09:43.940263 [debug] [MainThread]: On master: Close
[0m02:09:43.952597 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m02:09:43.955207 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_stages ..................... [RUN]
[0m02:09:43.960621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_stages)
[0m02:09:43.962510 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m02:09:43.998169 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m02:09:44.003937 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m02:09:44.085736 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m02:09:44.087559 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.088535 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m02:09:44.089452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:09:44.111478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m02:09:44.113050 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.116127 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            stage_id,
                            stage_name,
                            CASE 
	                            WHEN stage_name= 'Lead Generation'              THEN 'Step 1'
	                            WHEN stage_name= 'Qualified lead'               THEN 'Step 2'
	                            WHEN stage_name= 'Needs Assessment'             THEN 'Step 3'
	                            WHEN stage_name= 'Proposal/Quote Preparation'   THEN 'Step 4'
	                            WHEN stage_name= 'Negotiation'                  THEN 'Step 5'
	                            WHEN stage_name= 'Closing'                      THEN 'Step 6'
	                            WHEN stage_name= 'Implementation/Onboarding'    THEN 'Step 7'
	                            WHEN stage_name= 'Follow-up/Customer Success'   THEN 'Step 8'
	                            WHEN stage_name= 'Renewal/Expansion'            THEN 'Step 9'
                            END AS funnel_step

                    FROM "postgres"."public"."stages"
)

SELECT *
FROM transformed
  );
[0m02:09:44.130520 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m02:09:44.149003 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.150040 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m02:09:44.151606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:09:44.156900 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.157752 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m02:09:44.159201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:09:44.236085 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:09:44.242598 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.244673 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m02:09:44.261833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m02:09:44.275643 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_stages__dbt_backup"
[0m02:09:44.284339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m02:09:44.285259 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m02:09:44.292173 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m02:09:44.296186 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m02:09:44.300960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbea45df-6047-4c94-95f8-67984ed3a8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11db224650>]}
[0m02:09:44.302850 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_stages ................ [[32mCREATE VIEW[0m in 0.34s]
[0m02:09:44.304058 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m02:09:44.305915 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:44.306701 [debug] [MainThread]: On master: BEGIN
[0m02:09:44.307431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:09:44.319424 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m02:09:44.320378 [debug] [MainThread]: On master: COMMIT
[0m02:09:44.321155 [debug] [MainThread]: Using postgres connection "master"
[0m02:09:44.321873 [debug] [MainThread]: On master: COMMIT
[0m02:09:44.322749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:09:44.323511 [debug] [MainThread]: On master: Close
[0m02:09:44.328781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:09:44.330309 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_stages' was properly closed.
[0m02:09:44.331082 [info ] [MainThread]: 
[0m02:09:44.331866 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m02:09:44.333179 [debug] [MainThread]: Command end result
[0m02:09:44.379504 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:09:44.382756 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:09:44.392158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:09:44.393036 [info ] [MainThread]: 
[0m02:09:44.394384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:09:44.395093 [info ] [MainThread]: 
[0m02:09:44.395880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:09:44.397508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5025914, "process_in_blocks": "0", "process_kernel_time": 0.243996, "process_mem_max_rss": "141328", "process_out_blocks": "2792", "process_user_time": 4.269932}
[0m02:09:44.398461 [debug] [MainThread]: Command `cli run` succeeded at 02:09:44.398301 after 2.50 seconds
[0m02:09:44.399285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11da3b6c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11da3b4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e11da3b6cc0>]}
[0m02:09:44.400099 [debug] [MainThread]: Flushing usage events
[0m02:09:44.818560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:10:43.883146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a46b64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a42e97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a441eb10>]}


============================== 02:10:43.886333 | a956d90f-63d5-4fc1-a5bd-a85f3fef0013 ==============================
[0m02:10:43.886333 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:10:43.887259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:10:44.081466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a5e77770>]}
[0m02:10:44.143658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a362ffe0>]}
[0m02:10:44.144648 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:10:44.325182 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:10:44.401765 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:10:44.402464 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:10:44.403043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a2cd2fc0>]}
[0m02:10:45.646788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a196a480>]}
[0m02:10:45.775540 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:10:45.788038 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:10:45.807739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a2163950>]}
[0m02:10:45.808705 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:10:45.809458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a19ec1d0>]}
[0m02:10:45.812114 [info ] [MainThread]: 
[0m02:10:45.812902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:10:45.813666 [info ] [MainThread]: 
[0m02:10:45.814692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:10:45.816189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:10:45.873253 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:10:45.874238 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:10:45.875084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:10:45.888915 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:10:45.891295 [debug] [ThreadPool]: On list_postgres: Close
[0m02:10:45.900580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:10:45.914680 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:10:45.917136 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:10:45.917872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:10:45.937155 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m02:10:45.939422 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:10:45.942271 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:10:45.949499 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m02:10:45.952136 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:10:45.953275 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:10:45.963231 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.963912 [debug] [MainThread]: On master: BEGIN
[0m02:10:45.964593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:10:45.975758 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:10:45.976495 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.977265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:10:45.982409 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m02:10:45.985464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a21cbc80>]}
[0m02:10:45.986299 [debug] [MainThread]: On master: ROLLBACK
[0m02:10:45.987360 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.988085 [debug] [MainThread]: On master: BEGIN
[0m02:10:45.989258 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:10:45.989955 [debug] [MainThread]: On master: COMMIT
[0m02:10:45.990703 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:45.991418 [debug] [MainThread]: On master: COMMIT
[0m02:10:45.992311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:10:45.993030 [debug] [MainThread]: On master: Close
[0m02:10:45.998553 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m02:10:45.999624 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages ..................... [RUN]
[0m02:10:46.000613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages)
[0m02:10:46.001472 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m02:10:46.015077 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m02:10:46.016158 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m02:10:46.077154 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m02:10:46.078849 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.079715 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m02:10:46.080935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:10:46.095145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m02:10:46.095998 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.096905 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH
users AS (
			SELECT 
				  deal_id,
				   new_value :: INT AS user_id,
				   change_dt AS assigned_user_start,
				   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end
			FROM "postgres"."pipedrive_analytics"."stg_deal_changes"
			WHERE TRUE 
				AND  changed_field_key= 'user_id'
) 
, 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name,
                s.funnel_step,
                u.user_id,
                u.assigned_user_start,
                u.assigned_user_end
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         LEFT JOIN users u                       ON dc.deal_id = u.deal_id 
					                                AND dc.change_dt >= u.assigned_user_start
					                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m02:10:46.101646 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m02:10:46.119162 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.120026 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m02:10:46.121508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:10:46.146960 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m02:10:46.150035 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.150857 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m02:10:46.152479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:10:46.162766 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m02:10:46.171155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m02:10:46.171958 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m02:10:46.173137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:10:46.177171 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m02:10:46.182789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a956d90f-63d5-4fc1-a5bd-a85f3fef0013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a5e768d0>]}
[0m02:10:46.183978 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages ................ [[32mCREATE VIEW[0m in 0.18s]
[0m02:10:46.185148 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m02:10:46.187011 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:46.187800 [debug] [MainThread]: On master: BEGIN
[0m02:10:46.188586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:10:46.202243 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m02:10:46.202972 [debug] [MainThread]: On master: COMMIT
[0m02:10:46.203679 [debug] [MainThread]: Using postgres connection "master"
[0m02:10:46.204339 [debug] [MainThread]: On master: COMMIT
[0m02:10:46.205145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:10:46.205874 [debug] [MainThread]: On master: Close
[0m02:10:46.206781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:10:46.209745 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages' was properly closed.
[0m02:10:46.210564 [info ] [MainThread]: 
[0m02:10:46.211304 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:10:46.212547 [debug] [MainThread]: Command end result
[0m02:10:46.245992 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:10:46.249071 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:10:46.259198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:10:46.259904 [info ] [MainThread]: 
[0m02:10:46.260679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:10:46.261391 [info ] [MainThread]: 
[0m02:10:46.262061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:10:46.263598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4340403, "process_in_blocks": "0", "process_kernel_time": 0.256713, "process_mem_max_rss": "140816", "process_out_blocks": "2792", "process_user_time": 4.533612}
[0m02:10:46.264577 [debug] [MainThread]: Command `cli run` succeeded at 02:10:46.264366 after 2.44 seconds
[0m02:10:46.265452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a35d4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a3d3e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b73a4390170>]}
[0m02:10:46.266184 [debug] [MainThread]: Flushing usage events
[0m02:10:46.681115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:11:11.518694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c9195b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c907bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c997b230>]}


============================== 02:11:11.523570 | 85eabc3f-437d-4b76-9872-eb4f4a239696 ==============================
[0m02:11:11.523570 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:11:11.525056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:11:11.706047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb57f170>]}
[0m02:11:11.780290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb35cd70>]}
[0m02:11:11.781724 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:11:11.950732 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:11:12.053999 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:11:12.054732 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:11:12.055293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c75fb170>]}
[0m02:11:13.213488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c6deeea0>]}
[0m02:11:13.334071 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:11:13.348081 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:11:13.367923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c81b1760>]}
[0m02:11:13.368985 [info ] [MainThread]: Found 9 models, 6 sources, 434 macros
[0m02:11:13.369810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c9f08620>]}
[0m02:11:13.373676 [info ] [MainThread]: 
[0m02:11:13.374475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:11:13.375210 [info ] [MainThread]: 
[0m02:11:13.376195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:11:13.377691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:11:13.432978 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:11:13.434011 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:11:13.434833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:13.449459 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m02:11:13.451845 [debug] [ThreadPool]: On list_postgres: Close
[0m02:11:13.461145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:11:13.470923 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:11:13.471753 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:11:13.472529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:11:13.490558 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m02:11:13.491736 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:11:13.492455 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:11:13.505410 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m02:11:13.511151 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:11:13.514546 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:11:13.529559 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.532357 [debug] [MainThread]: On master: BEGIN
[0m02:11:13.534350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:11:13.554719 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m02:11:13.557508 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.558447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:11:13.568836 [debug] [MainThread]: SQL status: SELECT 10 in 0.007 seconds
[0m02:11:13.575702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c81b0770>]}
[0m02:11:13.576576 [debug] [MainThread]: On master: ROLLBACK
[0m02:11:13.581375 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.582090 [debug] [MainThread]: On master: BEGIN
[0m02:11:13.585652 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m02:11:13.586429 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.589324 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.590002 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.590975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:13.591695 [debug] [MainThread]: On master: Close
[0m02:11:13.594748 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.595719 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_stages_anmly ............... [RUN]
[0m02:11:13.596574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_stages_anmly)
[0m02:11:13.597406 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.610327 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.611689 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.668620 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.670431 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.671315 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: BEGIN
[0m02:11:13.672146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:11:13.683229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:11:13.683973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.684778 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */

  create view "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp"
    
    
  as (
    

WITH 
stages AS (
			SELECT 
				  *,
				  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
				  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,
				  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn
				  
			FROM "postgres"."pipedrive_analytics"."int_stages" 			
)

, stages_anmly AS (
					SELECT 
						   *,
						   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg
								
					FROM stages
)

SELECT *
FROM stages_anmly
  );
[0m02:11:13.688733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m02:11:13.699328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.700161 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
alter table "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp" rename to "int_stages_anmly"
[0m02:11:13.701611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:11:13.725262 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m02:11:13.726180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.727053 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m02:11:13.732537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m02:11:13.744884 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup"
[0m02:11:13.753466 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m02:11:13.754416 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup" cascade
[0m02:11:13.755747 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:11:13.759757 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: Close
[0m02:11:13.762311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85eabc3f-437d-4b76-9872-eb4f4a239696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb57e2a0>]}
[0m02:11:13.763544 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_stages_anmly .......... [[32mCREATE VIEW[0m in 0.16s]
[0m02:11:13.764732 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m02:11:13.766531 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.767319 [debug] [MainThread]: On master: BEGIN
[0m02:11:13.768053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:11:13.778576 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:11:13.779382 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.780112 [debug] [MainThread]: Using postgres connection "master"
[0m02:11:13.780879 [debug] [MainThread]: On master: COMMIT
[0m02:11:13.781749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:11:13.782510 [debug] [MainThread]: On master: Close
[0m02:11:13.785242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:13.785982 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_stages_anmly' was properly closed.
[0m02:11:13.786782 [info ] [MainThread]: 
[0m02:11:13.787654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:11:13.789007 [debug] [MainThread]: Command end result
[0m02:11:13.825894 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:11:13.828763 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:11:13.837706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:11:13.838384 [info ] [MainThread]: 
[0m02:11:13.839132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:11:13.840019 [info ] [MainThread]: 
[0m02:11:13.840835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:11:13.842419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4022744, "process_in_blocks": "0", "process_kernel_time": 0.245161, "process_mem_max_rss": "141204", "process_out_blocks": "2792", "process_user_time": 4.359097}
[0m02:11:13.843398 [debug] [MainThread]: Command `cli run` succeeded at 02:11:13.843243 after 2.40 seconds
[0m02:11:13.844250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c9195b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90c8cdd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c90cb7c26c0>]}
[0m02:11:13.845079 [debug] [MainThread]: Flushing usage events
[0m02:11:14.225711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:37:27.963692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069442f89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706944e460c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706944e46390>]}


============================== 02:37:27.966817 | cfa85106-6fbe-4d04-82cf-078156565999 ==============================
[0m02:37:27.966817 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:37:27.967726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m02:37:28.138540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069464c0410>]}
[0m02:37:28.200136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069440732f0>]}
[0m02:37:28.201136 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:37:28.356509 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:37:28.432140 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:37:28.432828 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:37:28.433368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069421cbc50>]}
[0m02:37:29.396044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706941978c80>]}
[0m02:37:29.564772 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:37:29.575474 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:37:29.591559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069419e97f0>]}
[0m02:37:29.592349 [info ] [MainThread]: Found 11 models, 6 sources, 434 macros
[0m02:37:29.593086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069419d87a0>]}
[0m02:37:29.595836 [info ] [MainThread]: 
[0m02:37:29.596550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:37:29.597077 [info ] [MainThread]: 
[0m02:37:29.597875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:37:29.599314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:37:29.646229 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:37:29.646823 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:37:29.647275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:29.656515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m02:37:29.658848 [debug] [ThreadPool]: On list_postgres: Close
[0m02:37:29.666696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:37:29.672895 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:37:29.673342 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:37:29.673739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:29.680498 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:37:29.680957 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:37:29.681420 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:37:29.684125 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.002 seconds
[0m02:37:29.685587 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:37:29.686182 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:37:29.692764 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.693181 [debug] [MainThread]: On master: BEGIN
[0m02:37:29.693610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:37:29.700263 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:37:29.700727 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.701203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:37:29.704429 [debug] [MainThread]: SQL status: SELECT 11 in 0.003 seconds
[0m02:37:29.706633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70694626e030>]}
[0m02:37:29.707159 [debug] [MainThread]: On master: ROLLBACK
[0m02:37:29.707798 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.708205 [debug] [MainThread]: On master: BEGIN
[0m02:37:29.708902 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:37:29.709337 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.709763 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.710152 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.710695 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:37:29.711091 [debug] [MainThread]: On master: Close
[0m02:37:29.713521 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.714232 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_sales_funnel ............... [RUN]
[0m02:37:29.714916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_sales_funnel)
[0m02:37:29.715424 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.726359 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.727763 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.784885 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.786671 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.787675 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: BEGIN
[0m02:37:29.788529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:37:29.800318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:37:29.801099 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.801923 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */

  create view "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp"
    
    
  as (
    

WITH 
avtivities AS (
		   		SELECT 
				   	   deal_id,
					   name				AS kpi_name,
					   funnel_step,
					   assigned_to_user AS user_id,
					   due_to_dt		AS change_dt,
					   month,
					   0 				AS anmly_flg
		   		
				FROM "postgres"."pipedrive_analytics"."int_activites"
)
, stages AS (
			  SELECT 
			  		 deal_id,
			  		 stage_name			AS kpi_name,
					 funnel_step,
					 user_id,
					 change_dt,
					 month,
					 anmly_flg
			  FROM "postgres"."pipedrive_analytics"."int_stages_anmly"
)

,stg_funnel AS ( 
			    SELECT * FROM avtivities 
			    UNION ALL
			    SELECT * FROM stages
)

, int_funnel AS (
				  SELECT *,
						 LAG(funnel_step) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
						 LAG(user_id)     OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user
						   
				  FROM stg_funnel
)

, final_funnel AS (
					SELECT *,
						   CASE 
						   		WHEN funnel_step= 'Step 2.1' AND COALESCE(prev_step, 'n') <> 'Step 2' AND user_id = prev_user THEN 1
						   		WHEN funnel_step= 'Step 3.1' AND COALESCE(prev_step, 'n') <> 'Step 3' AND user_id = prev_user THEN 1
								ELSE anmly_flg
						   END AS funnel_anmly_flg
					FROM int_funnel 
)

SELECT *
FROM final_funnel
  );
[0m02:37:29.807878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m02:37:29.818529 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.819036 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
alter table "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp" rename to "int_sales_funnel"
[0m02:37:29.819994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:37:29.834608 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m02:37:29.835124 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.835608 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m02:37:29.836919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:37:29.842801 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup"
[0m02:37:29.847932 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m02:37:29.848455 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
drop view if exists "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup" cascade
[0m02:37:29.849266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:37:29.851692 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: Close
[0m02:37:29.853920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfa85106-6fbe-4d04-82cf-078156565999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70694649b3b0>]}
[0m02:37:29.854982 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_sales_funnel .......... [[32mCREATE VIEW[0m in 0.14s]
[0m02:37:29.856110 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_sales_funnel
[0m02:37:29.857845 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.858537 [debug] [MainThread]: On master: BEGIN
[0m02:37:29.859155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:37:29.874292 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m02:37:29.875136 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.875889 [debug] [MainThread]: Using postgres connection "master"
[0m02:37:29.877500 [debug] [MainThread]: On master: COMMIT
[0m02:37:29.878411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:37:29.880942 [debug] [MainThread]: On master: Close
[0m02:37:29.881674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:29.882356 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_sales_funnel' was properly closed.
[0m02:37:29.882999 [info ] [MainThread]: 
[0m02:37:29.883958 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m02:37:29.885130 [debug] [MainThread]: Command end result
[0m02:37:29.930729 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:37:29.934708 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:37:29.942331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:37:29.943046 [info ] [MainThread]: 
[0m02:37:29.943992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:37:29.945095 [info ] [MainThread]: 
[0m02:37:29.946027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:37:29.947828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.064913, "process_in_blocks": "0", "process_kernel_time": 0.261554, "process_mem_max_rss": "140932", "process_out_blocks": "2832", "process_user_time": 4.276371}
[0m02:37:29.949573 [debug] [MainThread]: Command `cli run` succeeded at 02:37:29.949407 after 2.07 seconds
[0m02:37:29.950429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7069440b6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706941d7d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706943f90800>]}
[0m02:37:29.951300 [debug] [MainThread]: Flushing usage events
[0m02:37:30.317980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:40:52.827772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b423f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b28dd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b529f6e0>]}


============================== 02:40:52.830902 | fb409331-9dc6-48eb-957d-3b354f172c9a ==============================
[0m02:40:52.830902 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:40:52.831793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:40:53.002557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b1b159a0>]}
[0m02:40:53.065507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b359f230>]}
[0m02:40:53.066512 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:40:53.236195 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:40:53.314656 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:40:53.315335 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:40:53.316020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b2f39ee0>]}
[0m02:40:54.266911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b07694f0>]}
[0m02:40:54.424296 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:40:54.436148 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:40:54.452444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b072d0a0>]}
[0m02:40:54.453364 [info ] [MainThread]: Found 12 models, 6 sources, 434 macros
[0m02:40:54.454098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b4e3deb0>]}
[0m02:40:54.457630 [info ] [MainThread]: 
[0m02:40:54.458564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:40:54.459549 [info ] [MainThread]: 
[0m02:40:54.460722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:40:54.462568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:40:54.523667 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:40:54.524639 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:40:54.525367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:54.538198 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m02:40:54.540581 [debug] [ThreadPool]: On list_postgres: Close
[0m02:40:54.548802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:40:54.554610 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:40:54.555066 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:40:54.555517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:54.562349 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m02:40:54.562820 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:40:54.563285 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:40:54.566059 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m02:40:54.567559 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:40:54.568149 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:40:54.574811 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.575247 [debug] [MainThread]: On master: BEGIN
[0m02:40:54.575660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:40:54.582677 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m02:40:54.583141 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.583649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:40:54.586968 [debug] [MainThread]: SQL status: SELECT 13 in 0.003 seconds
[0m02:40:54.589520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b0ffe750>]}
[0m02:40:54.590461 [debug] [MainThread]: On master: ROLLBACK
[0m02:40:54.592453 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.594404 [debug] [MainThread]: On master: BEGIN
[0m02:40:54.595662 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:40:54.596337 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.596991 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.597784 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.598392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:54.598814 [debug] [MainThread]: On master: Close
[0m02:40:54.601362 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.602063 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.int_step_month_matrix .......... [RUN]
[0m02:40:54.602771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.int_step_month_matrix)
[0m02:40:54.603291 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.612908 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.613641 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.650587 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.651494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.652273 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: BEGIN
[0m02:40:54.653006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:40:54.662163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:40:54.662682 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.663229 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */

  create view "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp"
    
    
  as (
    

WITH
all_unique_steps AS (
                        SELECT 
                               * 
                        FROM (
                                VALUES
                                    ('Lead Generation',              'Step 1'),
                                    ('Qualified lead',               'Step 2'),
                                    ('Sales Call 1',                 'Step 2.1'),
                                    ('Needs Assessment',             'Step 3'),
                                    ('Sales Call 2',                 'Step 3.1'),
                                    ('Proposal/Quote Preparation',   'Step 4'),
                                    ('Negotiation',                  'Step 5'),
                                    ('Closing',                      'Step 6'),
                                    ('Implementation/Onboarding',    'Step 7'),
                                    ('Follow-up/Customer Success',   'Step 8'),
                                    ('Renewal/Expansion',            'Step 9')
                             ) AS t (kpi_name, funnel_step)
                        )
, all_months AS (
                    SELECT DISTINCT month 
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                )

, month_step_matrix AS (
                         SELECT
                               m.month,
                               s.kpi_name,
                               s.funnel_step
                         FROM all_months m
                         CROSS JOIN all_unique_steps s
                       )

SELECT *
FROM month_step_matrix
  );
[0m02:40:54.665538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m02:40:54.671566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.672067 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
alter table "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp" rename to "int_step_month_matrix"
[0m02:40:54.673002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:40:54.687440 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m02:40:54.687960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.688446 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m02:40:54.689869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:40:54.695743 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup"
[0m02:40:54.700842 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m02:40:54.701384 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
drop view if exists "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup" cascade
[0m02:40:54.702162 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m02:40:54.704605 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: Close
[0m02:40:54.706861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb409331-9dc6-48eb-957d-3b354f172c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4af134410>]}
[0m02:40:54.707845 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.int_step_month_matrix ..... [[32mCREATE VIEW[0m in 0.10s]
[0m02:40:54.708704 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_step_month_matrix
[0m02:40:54.710139 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.710821 [debug] [MainThread]: On master: BEGIN
[0m02:40:54.711499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:40:54.719842 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m02:40:54.720363 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.720815 [debug] [MainThread]: Using postgres connection "master"
[0m02:40:54.721242 [debug] [MainThread]: On master: COMMIT
[0m02:40:54.721816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:40:54.722260 [debug] [MainThread]: On master: Close
[0m02:40:54.722845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:40:54.723501 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_step_month_matrix' was properly closed.
[0m02:40:54.724132 [info ] [MainThread]: 
[0m02:40:54.724775 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m02:40:54.726088 [debug] [MainThread]: Command end result
[0m02:40:54.774418 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:40:54.777892 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:40:54.785959 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:40:54.786726 [info ] [MainThread]: 
[0m02:40:54.788050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:40:54.789154 [info ] [MainThread]: 
[0m02:40:54.790135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:40:54.792361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.030923, "process_in_blocks": "0", "process_kernel_time": 0.292027, "process_mem_max_rss": "141204", "process_out_blocks": "2872", "process_user_time": 4.667476}
[0m02:40:54.793284 [debug] [MainThread]: Command `cli run` succeeded at 02:40:54.793102 after 2.03 seconds
[0m02:40:54.794038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b2f77980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b3f0c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4b77ead50>]}
[0m02:40:54.795360 [debug] [MainThread]: Flushing usage events
[0m02:40:55.178148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:48:15.999566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4da32390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ee51d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ed6ed20>]}


============================== 02:48:16.002713 | 022690b6-b293-4075-a0d7-4a0105928eab ==============================
[0m02:48:16.002713 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:48:16.003610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:48:16.199763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4d3b6630>]}
[0m02:48:16.318156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ee9bd70>]}
[0m02:48:16.319656 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:48:16.497768 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m02:48:16.573564 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:48:16.574319 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m02:48:16.575131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4d9f8920>]}
[0m02:48:17.704042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4d5978c0>]}
[0m02:48:17.895057 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:48:17.907446 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:48:17.926467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4b7e2f90>]}
[0m02:48:17.927376 [info ] [MainThread]: Found 12 models, 6 sources, 434 macros
[0m02:48:17.928053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4b343c20>]}
[0m02:48:17.930589 [info ] [MainThread]: 
[0m02:48:17.931265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:48:17.931886 [info ] [MainThread]: 
[0m02:48:17.932740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:48:17.934055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:48:17.988760 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:48:17.989577 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:48:17.990287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:18.004485 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m02:48:18.007011 [debug] [ThreadPool]: On list_postgres: Close
[0m02:48:18.016887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m02:48:18.026846 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:48:18.027550 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:48:18.028182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:18.039477 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m02:48:18.040340 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:48:18.041191 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:48:18.045823 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m02:48:18.048525 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:48:18.049516 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:48:18.060962 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.061811 [debug] [MainThread]: On master: BEGIN
[0m02:48:18.062550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:48:18.076551 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m02:48:18.077362 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.078288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:48:18.083676 [debug] [MainThread]: SQL status: SELECT 14 in 0.005 seconds
[0m02:48:18.088434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4b340d70>]}
[0m02:48:18.089342 [debug] [MainThread]: On master: ROLLBACK
[0m02:48:18.090315 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.091027 [debug] [MainThread]: On master: BEGIN
[0m02:48:18.092060 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:48:18.092737 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.093509 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.094208 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.095141 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:48:18.095876 [debug] [MainThread]: On master: Close
[0m02:48:18.101397 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.102530 [info ] [Thread-1 (]: 1 of 1 START sql table model pipedrive_analytics.rep_sales_funnel_monthly ...... [RUN]
[0m02:48:18.103495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m02:48:18.104325 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.117830 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.119398 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.184528 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.188599 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.189514 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m02:48:18.190352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:48:18.210820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m02:48:18.211633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.212726 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

WITH
monthly_data AS (
                    SELECT
                           month,
                           kpi_name,
                           funnel_step,
                           COUNT(DISTINCT deal_id) AS deals_count
                           
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                    WHERE funnel_anmly_flg = 0
                    GROUP BY 
                             month, 
                             kpi_name, 
                             funnel_step
)

, final AS (
             SELECT
                    ms.month,
                    ms.kpi_name,
                    ms.funnel_step,
                    COALESCE(a.deals_count, 0) AS deals_count

             FROM "postgres"."pipedrive_analytics"."int_step_month_matrix" ms
             LEFT JOIN monthly_data a            ON ms.month = a.month
                                                    AND ms.kpi_name = a.kpi_name
                               
           )
SELECT *
FROM final
  );
  
[0m02:48:18.482745 [debug] [Thread-1 (]: SQL status: SELECT 154 in 0.269 seconds
[0m02:48:18.500681 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.501673 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m02:48:18.503189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:48:18.526698 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m02:48:18.527674 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.528674 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m02:48:18.530574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:48:18.540727 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m02:48:18.549474 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m02:48:18.550359 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m02:48:18.551703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:48:18.555634 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m02:48:18.561315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022690b6-b293-4075-a0d7-4a0105928eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d49e752e0>]}
[0m02:48:18.563604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model pipedrive_analytics.rep_sales_funnel_monthly . [[32mSELECT 154[0m in 0.45s]
[0m02:48:18.564987 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m02:48:18.566822 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.567605 [debug] [MainThread]: On master: BEGIN
[0m02:48:18.568331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:48:18.579593 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m02:48:18.580335 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.581060 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:18.581884 [debug] [MainThread]: On master: COMMIT
[0m02:48:18.583907 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:48:18.584661 [debug] [MainThread]: On master: Close
[0m02:48:18.587934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:48:18.588649 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m02:48:18.589408 [info ] [MainThread]: 
[0m02:48:18.590164 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m02:48:18.591494 [debug] [MainThread]: Command end result
[0m02:48:18.642582 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:48:18.648702 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:48:18.676067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:48:18.676852 [info ] [MainThread]: 
[0m02:48:18.677663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:48:18.678343 [info ] [MainThread]: 
[0m02:48:18.679100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:48:18.682677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7363362, "process_in_blocks": "0", "process_kernel_time": 0.260381, "process_mem_max_rss": "141424", "process_out_blocks": "2872", "process_user_time": 4.398666}
[0m02:48:18.689547 [debug] [MainThread]: Command `cli run` succeeded at 02:48:18.689382 after 2.74 seconds
[0m02:48:18.690257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4ddb10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4db8bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731d4e120410>]}
[0m02:48:18.690954 [debug] [MainThread]: Flushing usage events
[0m02:48:19.128726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:53:08.917951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e426ec42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e428240560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e4275059a0>]}


============================== 23:53:08.921745 | db62dc50-0777-4aa9-9cf9-8e4adbfb2771 ==============================
[0m23:53:08.921745 [info ] [MainThread]: Running with dbt=1.10.0
[0m23:53:08.922806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:53:09.080227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db62dc50-0777-4aa9-9cf9-8e4adbfb2771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e428f3f6e0>]}
[0m23:53:09.093473 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:09.094762 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:53:09.096571 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2346284, "process_in_blocks": "368", "process_kernel_time": 0.16949, "process_mem_max_rss": "116760", "process_out_blocks": "8", "process_user_time": 2.716836}
[0m23:53:09.097686 [debug] [MainThread]: Command `cli deps` succeeded at 23:53:09.097478 after 0.24 seconds
[0m23:53:09.098427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e426d1c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e427e89010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e426cc1070>]}
[0m23:53:09.099257 [debug] [MainThread]: Flushing usage events
[0m23:53:09.490513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:00.963297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71416ac62d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71416ad60fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71416a84bb30>]}


============================== 01:06:01.006610 | 59a16ddb-53d7-4925-aab9-d25e208c7d84 ==============================
[0m01:06:01.006610 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:06:01.008205 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'None', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'write_json': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'quiet': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'target_path': 'None', 'no_print': 'None'}
[0m01:06:01.074373 [info ] [MainThread]: dbt version: 1.11.2
[0m01:06:01.075365 [info ] [MainThread]: python version: 3.12.1
[0m01:06:01.075981 [info ] [MainThread]: python path: /workspaces/dbt_enpal_assessment_mahmoud/.venv/bin/python
[0m01:06:01.076485 [info ] [MainThread]: os info: Linux-6.8.0-1030-azure-x86_64-with-glibc2.39
[0m01:06:01.148368 [info ] [MainThread]: Using profiles dir at /workspaces/dbt_enpal_assessment_mahmoud
[0m01:06:01.149365 [info ] [MainThread]: Using profiles.yml file at /workspaces/dbt_enpal_assessment_mahmoud/profiles.yml
[0m01:06:01.150049 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/dbt_enpal_assessment_mahmoud/dbt_project.yml
[0m01:06:01.151124 [info ] [MainThread]: adapter type: postgres
[0m01:06:01.151827 [info ] [MainThread]: adapter version: 1.10.0
[0m01:06:01.270701 [info ] [MainThread]: Configuration:
[0m01:06:01.271534 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:06:01.272126 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:06:01.272638 [info ] [MainThread]: Required dependencies:
[0m01:06:01.273177 [debug] [MainThread]: Executing "git --help"
[0m01:06:01.275720 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:06:01.276272 [debug] [MainThread]: STDERR: "b''"
[0m01:06:01.276731 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:06:01.277327 [info ] [MainThread]: Connection:
[0m01:06:01.278009 [info ] [MainThread]:   host: localhost
[0m01:06:01.278678 [info ] [MainThread]:   port: 5432
[0m01:06:01.279319 [info ] [MainThread]:   user: admin
[0m01:06:01.279975 [info ] [MainThread]:   database: postgres
[0m01:06:01.280683 [info ] [MainThread]:   schema: pipedrive_analytics
[0m01:06:01.281361 [info ] [MainThread]:   connect_timeout: 10
[0m01:06:01.282056 [info ] [MainThread]:   role: None
[0m01:06:01.282737 [info ] [MainThread]:   search_path: None
[0m01:06:01.283401 [info ] [MainThread]:   keepalives_idle: 0
[0m01:06:01.283848 [info ] [MainThread]:   sslmode: None
[0m01:06:01.284435 [info ] [MainThread]:   sslcert: None
[0m01:06:01.285138 [info ] [MainThread]:   sslkey: None
[0m01:06:01.285804 [info ] [MainThread]:   sslrootcert: None
[0m01:06:01.286537 [info ] [MainThread]:   application_name: dbt
[0m01:06:01.287216 [info ] [MainThread]:   retries: 1
[0m01:06:01.287957 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:06:01.387837 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:06:01.427069 [debug] [MainThread]: Using postgres connection "debug"
[0m01:06:01.427726 [debug] [MainThread]: On debug: select 1 as id
[0m01:06:01.428226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:01.440452 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m01:06:01.441663 [debug] [MainThread]: On debug: Close
[0m01:06:01.442225 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:06:01.443393 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:06:01.445116 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.541552, "process_in_blocks": "16", "process_kernel_time": 0.372472, "process_mem_max_rss": "126808", "process_out_blocks": "34640", "process_user_time": 3.740619}
[0m01:06:01.445757 [debug] [MainThread]: Command `dbt debug` succeeded at 01:06:01.445644 after 0.54 seconds
[0m01:06:01.446226 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:06:01.446710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71416ad60fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71416a865640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71416a05fa40>]}
[0m01:06:01.447288 [debug] [MainThread]: Flushing usage events
[0m01:06:01.848912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:45.196729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3df55520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3f866930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3ead1220>]}


============================== 01:08:45.200365 | ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1 ==============================
[0m01:08:45.200365 [info ] [MainThread]: Running with dbt=1.10.0
[0m01:08:45.201293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:08:45.378326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3e3de660>]}
[0m01:08:45.443141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3d33bc20>]}
[0m01:08:45.444296 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:08:45.609459 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m01:08:45.687640 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:08:45.688488 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m01:08:45.689114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3e5e1010>]}
[0m01:08:46.683329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bfe1490>]}
[0m01:08:46.884965 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:08:46.895234 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:08:46.953040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3c7ad070>]}
[0m01:08:46.953818 [info ] [MainThread]: Found 12 models, 6 sources, 434 macros
[0m01:08:46.957444 [info ] [MainThread]: 
[0m01:08:46.958233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:46.958875 [info ] [MainThread]: 
[0m01:08:46.959849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:08:46.965717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:08:47.002187 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:08:47.002744 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:08:47.003411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:47.014804 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m01:08:47.016293 [debug] [ThreadPool]: On list_postgres: Close
[0m01:08:47.019042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:08:47.026668 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:08:47.027113 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:08:47.027519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:47.034638 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m01:08:47.035380 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:08:47.035807 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:08:47.039757 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m01:08:47.042258 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:08:47.043059 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:08:47.059725 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:47.060447 [debug] [MainThread]: On master: BEGIN
[0m01:08:47.061051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:08:47.070224 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:08:47.070873 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:47.071585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:08:47.075171 [debug] [MainThread]: SQL status: SELECT 9 in 0.003 seconds
[0m01:08:47.077823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3a876780>]}
[0m01:08:47.078734 [debug] [MainThread]: On master: ROLLBACK
[0m01:08:47.079682 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:47.080370 [debug] [MainThread]: On master: BEGIN
[0m01:08:47.081389 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:08:47.082144 [debug] [MainThread]: On master: COMMIT
[0m01:08:47.082667 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:47.083060 [debug] [MainThread]: On master: COMMIT
[0m01:08:47.083781 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:47.084521 [debug] [MainThread]: On master: Close
[0m01:08:47.088350 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m01:08:47.089280 [info ] [Thread-1 (]: 1 of 12 START sql view model pipedrive_analytics.stg_activity .................. [RUN]
[0m01:08:47.090608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m01:08:47.091210 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m01:08:47.101931 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m01:08:47.102677 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m01:08:47.149695 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m01:08:47.150693 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:08:47.151255 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m01:08:47.151744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.162781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:08:47.163575 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:08:47.164104 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt,
                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num 

                    FROM "postgres"."public"."activity"
)

SELECT 
       activity_id,
       type,
       assigned_to_user,
       deal_id,
       done,
       due_to_dt
FROM transformed
WHERE row_num = 1
  );
[0m01:08:47.166910 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:08:47.180208 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:08:47.180983 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m01:08:47.181998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.185202 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:08:47.185683 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m01:08:47.186543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.202211 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m01:08:47.202751 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:08:47.203217 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m01:08:47.204633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.211666 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m01:08:47.218523 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m01:08:47.219022 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m01:08:47.221224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:08:47.223838 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m01:08:47.226367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bf9c650>]}
[0m01:08:47.227465 [info ] [Thread-1 (]: 1 of 12 OK created sql view model pipedrive_analytics.stg_activity ............. [[32mCREATE VIEW[0m in 0.13s]
[0m01:08:47.228504 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m01:08:47.229409 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m01:08:47.230595 [info ] [Thread-1 (]: 2 of 12 START sql view model pipedrive_analytics.stg_activity_types ............ [RUN]
[0m01:08:47.231394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m01:08:47.232235 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m01:08:47.236932 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.237669 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m01:08:47.241516 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.242226 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.242693 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m01:08:47.243141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.250831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:08:47.251566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.252178 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE 
                       		 WHEN name= 'Sales Call 1' THEN 'Step 2.1'
                       		 WHEN name= 'Sales Call 2' THEN 'Step 3.1'
                  	     END 				AS funnel_step,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
)

SELECT *
FROM transformed
  );
[0m01:08:47.254548 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:08:47.260255 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.260795 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m01:08:47.262302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.267361 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.268204 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m01:08:47.269577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.273119 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m01:08:47.273652 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.274106 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m01:08:47.275718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.278014 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m01:08:47.278967 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m01:08:47.279735 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m01:08:47.281907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:08:47.283901 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m01:08:47.284943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38f440b0>]}
[0m01:08:47.286032 [info ] [Thread-1 (]: 2 of 12 OK created sql view model pipedrive_analytics.stg_activity_types ....... [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.287041 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m01:08:47.287871 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m01:08:47.289073 [info ] [Thread-1 (]: 3 of 12 START sql view model pipedrive_analytics.stg_deal_changes .............. [RUN]
[0m01:08:47.290189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m01:08:47.290709 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m01:08:47.295863 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.296694 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m01:08:47.301450 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.302132 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.302598 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m01:08:47.303034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.310421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m01:08:47.311102 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.311593 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            deal_id,
                            CAST(change_time AS TIMESTAMP) change_dt,
                            changed_field_key,
                            new_value,
                            row_number() OVER (
                                PARTITION BY deal_id, changed_field_key, new_value,  change_time) AS rn

                    FROM "postgres"."public"."deal_changes"
)

SELECT 
      deal_id,
      change_dt,
      changed_field_key,
      new_value

FROM transformed
WHERE rn = 1
  );
[0m01:08:47.327241 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m01:08:47.331274 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.331763 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m01:08:47.332708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.335714 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.336213 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m01:08:47.337036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.339466 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m01:08:47.340235 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.340724 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m01:08:47.342228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.345339 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m01:08:47.346316 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m01:08:47.346826 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m01:08:47.349265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:08:47.350640 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m01:08:47.351507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3a860140>]}
[0m01:08:47.352693 [info ] [Thread-1 (]: 3 of 12 OK created sql view model pipedrive_analytics.stg_deal_changes ......... [[32mCREATE VIEW[0m in 0.06s]
[0m01:08:47.353829 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m01:08:47.354723 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m01:08:47.355630 [info ] [Thread-1 (]: 4 of 12 START sql view model pipedrive_analytics.stg_fields .................... [RUN]
[0m01:08:47.356659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m01:08:47.357504 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m01:08:47.362433 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m01:08:47.363554 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m01:08:47.369919 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m01:08:47.370822 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:08:47.371309 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m01:08:47.371745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.379317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m01:08:47.379992 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:08:47.380517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp"
    
    
  as (
    

WITH

raw AS (
        SELECT 
              id          AS field_id,
              field_key,
              name        AS field_name,
              field_value_options

        FROM "postgres"."public"."fields"
)

, base AS (
            SELECT
                  field_id,
                  field_key,
                  field_value_options
                  
            FROM raw
            WHERE field_value_options IS NOT NULL
)

, exploded AS (
                SELECT
                      b.field_id,
                      b.field_key,
                      e.elem->>'id'    AS option_id,
                      e.elem->>'label' AS option_label

                FROM base b
                CROSS JOIN lateral
                    jsonb_array_elements(b.field_value_options) WITH ordinality AS e(elem, ord)
)

, transformed AS (
                    SELECT
                          r.field_id,
                          r.field_key,
                          r.field_name,
                          CASE
                              WHEN e.option_id ~ '^\d+$' THEN e.option_id::int
                              ELSE NULL
                          END AS option_id,
                          e.option_label
                        
                    FROM raw r
                    LEFT JOIN exploded e    USING (field_id)
)
SELECT
        *
FROM transformed
ORDER BY field_id, 
         option_id
  );
[0m01:08:47.390390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m01:08:47.395315 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:08:47.395813 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m01:08:47.396863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.400888 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:08:47.401451 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m01:08:47.402428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.405066 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m01:08:47.405555 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:08:47.405995 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m01:08:47.407582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.411304 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_fields__dbt_backup"
[0m01:08:47.412261 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:08:47.412769 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m01:08:47.414555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:08:47.415974 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m01:08:47.416827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38f5ccb0>]}
[0m01:08:47.417910 [info ] [Thread-1 (]: 4 of 12 OK created sql view model pipedrive_analytics.stg_fields ............... [[32mCREATE VIEW[0m in 0.06s]
[0m01:08:47.418865 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m01:08:47.419638 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m01:08:47.420447 [info ] [Thread-1 (]: 5 of 12 START sql view model pipedrive_analytics.stg_stages .................... [RUN]
[0m01:08:47.421234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m01:08:47.421989 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m01:08:47.426968 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m01:08:47.428018 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m01:08:47.431783 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m01:08:47.432500 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:08:47.432965 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m01:08:47.433420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.441073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:08:47.441782 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:08:47.442307 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            stage_id,
                            stage_name,
                            CASE 
	                            WHEN stage_name= 'Lead Generation'              THEN 'Step 1'
	                            WHEN stage_name= 'Qualified lead'               THEN 'Step 2'
	                            WHEN stage_name= 'Needs Assessment'             THEN 'Step 3'
	                            WHEN stage_name= 'Proposal/Quote Preparation'   THEN 'Step 4'
	                            WHEN stage_name= 'Negotiation'                  THEN 'Step 5'
	                            WHEN stage_name= 'Closing'                      THEN 'Step 6'
	                            WHEN stage_name= 'Implementation/Onboarding'    THEN 'Step 7'
	                            WHEN stage_name= 'Follow-up/Customer Success'   THEN 'Step 8'
	                            WHEN stage_name= 'Renewal/Expansion'            THEN 'Step 9'
                            END AS funnel_step

                    FROM "postgres"."public"."stages"
)

SELECT *
FROM transformed
  );
[0m01:08:47.444655 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:08:47.447896 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:08:47.448785 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m01:08:47.450397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.454075 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:08:47.454566 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m01:08:47.455509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.458666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m01:08:47.459456 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:08:47.460193 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m01:08:47.461830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.465162 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_stages__dbt_backup"
[0m01:08:47.466115 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m01:08:47.466624 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m01:08:47.468302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:08:47.469868 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m01:08:47.470676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3a9a6120>]}
[0m01:08:47.471777 [info ] [Thread-1 (]: 5 of 12 OK created sql view model pipedrive_analytics.stg_stages ............... [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.473198 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m01:08:47.474183 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m01:08:47.475504 [info ] [Thread-1 (]: 6 of 12 START sql view model pipedrive_analytics.stg_users ..................... [RUN]
[0m01:08:47.476670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m01:08:47.477460 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m01:08:47.482173 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m01:08:47.482857 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m01:08:47.487548 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m01:08:47.488605 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:08:47.489373 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m01:08:47.489895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.497474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:08:47.498180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:08:47.498674 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with 

transformed as (

                SELECT 
                      id          as user_id,
                      name        as user_name,
                      email       as user_email,
                      modified    as user_modified_at

                FROM "postgres"."public"."users"
)

SELECT 
      *
FROM transformed
  );
[0m01:08:47.500452 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:08:47.503948 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:08:47.504728 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m01:08:47.506197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.511784 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:08:47.512546 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m01:08:47.513372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.515163 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m01:08:47.515731 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:08:47.516490 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m01:08:47.518363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.521526 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_users__dbt_backup"
[0m01:08:47.522494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m01:08:47.523009 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m01:08:47.524600 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:08:47.526240 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m01:08:47.527304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38f6a540>]}
[0m01:08:47.528434 [info ] [Thread-1 (]: 6 of 12 OK created sql view model pipedrive_analytics.stg_users ................ [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.529560 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m01:08:47.530343 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m01:08:47.531247 [info ] [Thread-1 (]: 7 of 12 START sql view model pipedrive_analytics.int_activites ................. [RUN]
[0m01:08:47.532131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.int_activites)
[0m01:08:47.532951 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m01:08:47.540725 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m01:08:47.541504 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m01:08:47.546850 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activites"
[0m01:08:47.547633 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m01:08:47.548118 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: BEGIN
[0m01:08:47.548559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.555967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m01:08:47.556679 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m01:08:47.557191 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */

  create view "postgres"."pipedrive_analytics"."int_activites__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
          SELECT 
                ac.activity_id,
                ac.deal_id,
                ac.type,
                act.name,
                act.funnel_step,
                ac.assigned_to_user,
                ac.due_to_dt,
                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month
                
          FROM "postgres"."pipedrive_analytics"."stg_activity" ac
          LEFT JOIN "postgres"."pipedrive_analytics"."stg_activity_types" act ON ac.type = act.type
          WHERE TRUE 
              AND ac.done
              AND act.name IN ('Sales Call 1', 'Sales Call 2')
)

SELECT *
FROM base
  );
[0m01:08:47.578989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m01:08:47.583736 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m01:08:47.584293 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
alter table "postgres"."pipedrive_analytics"."int_activites__dbt_tmp" rename to "int_activites"
[0m01:08:47.585292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.587013 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m01:08:47.587519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m01:08:47.587972 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m01:08:47.589315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.591897 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_activites__dbt_backup"
[0m01:08:47.592862 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m01:08:47.593373 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
drop view if exists "postgres"."pipedrive_analytics"."int_activites__dbt_backup" cascade
[0m01:08:47.594064 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:08:47.595449 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: Close
[0m01:08:47.596269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38f8bf20>]}
[0m01:08:47.597398 [info ] [Thread-1 (]: 7 of 12 OK created sql view model pipedrive_analytics.int_activites ............ [[32mCREATE VIEW[0m in 0.06s]
[0m01:08:47.598774 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m01:08:47.599619 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m01:08:47.601264 [info ] [Thread-1 (]: 8 of 12 START sql view model pipedrive_analytics.int_stages .................... [RUN]
[0m01:08:47.602160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activites, now model.enpal_assessment_project.int_stages)
[0m01:08:47.602902 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m01:08:47.609439 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m01:08:47.610610 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m01:08:47.618693 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m01:08:47.619465 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:08:47.619957 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m01:08:47.620442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.628285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:08:47.629002 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:08:47.629825 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH
users AS (
			SELECT 
				  deal_id,
				   new_value :: INT AS user_id,
				   change_dt AS assigned_user_start,
				   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end
			FROM "postgres"."pipedrive_analytics"."stg_deal_changes"
			WHERE TRUE 
				AND  changed_field_key= 'user_id'
) 
, 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name,
                s.funnel_step,
                u.user_id,
                u.assigned_user_start,
                u.assigned_user_end
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         LEFT JOIN users u                       ON dc.deal_id = u.deal_id 
					                                AND dc.change_dt >= u.assigned_user_start
					                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m01:08:47.635229 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:08:47.640253 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:08:47.640793 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m01:08:47.641729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.643373 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m01:08:47.643846 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:08:47.644297 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m01:08:47.645729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.648196 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m01:08:47.649154 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m01:08:47.649618 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m01:08:47.650330 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:08:47.651722 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m01:08:47.652566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3c3b9d90>]}
[0m01:08:47.653655 [info ] [Thread-1 (]: 8 of 12 OK created sql view model pipedrive_analytics.int_stages ............... [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.655924 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m01:08:47.657592 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m01:08:47.658616 [info ] [Thread-1 (]: 9 of 12 START sql view model pipedrive_analytics.int_stages_anmly .............. [RUN]
[0m01:08:47.659459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_stages, now model.enpal_assessment_project.int_stages_anmly)
[0m01:08:47.660342 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m01:08:47.665339 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.666466 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m01:08:47.671900 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.673047 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.673802 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: BEGIN
[0m01:08:47.674286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.682150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:08:47.682793 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.683298 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */

  create view "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp"
    
    
  as (
    

WITH 
stages AS (
			SELECT 
				  *,
				  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
				  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,
				  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn
				  
			FROM "postgres"."pipedrive_analytics"."int_stages" 			
)

, stages_anmly AS (
					SELECT 
						   *,
						   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg
								
					FROM stages
)

SELECT *
FROM stages_anmly
  );
[0m01:08:47.686750 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:08:47.691081 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.691598 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
alter table "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp" rename to "int_stages_anmly"
[0m01:08:47.692520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:47.694708 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m01:08:47.695484 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.696226 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m01:08:47.697990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.703193 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup"
[0m01:08:47.704148 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m01:08:47.704636 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup" cascade
[0m01:08:47.705366 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:08:47.706767 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: Close
[0m01:08:47.707542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38fa8500>]}
[0m01:08:47.708619 [info ] [Thread-1 (]: 9 of 12 OK created sql view model pipedrive_analytics.int_stages_anmly ......... [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.709579 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m01:08:47.710583 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_sales_funnel
[0m01:08:47.711726 [info ] [Thread-1 (]: 10 of 12 START sql view model pipedrive_analytics.int_sales_funnel ............. [RUN]
[0m01:08:47.712605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_stages_anmly, now model.enpal_assessment_project.int_sales_funnel)
[0m01:08:47.713384 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_sales_funnel
[0m01:08:47.718804 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.719617 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_sales_funnel
[0m01:08:47.726864 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.727734 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.728237 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: BEGIN
[0m01:08:47.728968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.738279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:08:47.739232 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.740120 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */

  create view "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp"
    
    
  as (
    

WITH 
avtivities AS (
		   		SELECT 
				   	   deal_id,
					   name				AS kpi_name,
					   funnel_step,
					   assigned_to_user AS user_id,
					   due_to_dt		AS change_dt,
					   month,
					   0 				AS anmly_flg
		   		
				FROM "postgres"."pipedrive_analytics"."int_activites"
)
, stages AS (
			  SELECT 
			  		 deal_id,
			  		 stage_name			AS kpi_name,
					 funnel_step,
					 user_id,
					 change_dt,
					 month,
					 anmly_flg
			  FROM "postgres"."pipedrive_analytics"."int_stages_anmly"
)

,stg_funnel AS ( 
			    SELECT * FROM avtivities 
			    UNION ALL
			    SELECT * FROM stages
)

, int_funnel AS (
				  SELECT *,
						 LAG(funnel_step) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
						 LAG(user_id)     OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user
						   
				  FROM stg_funnel
)

, final_funnel AS (
					SELECT *,
						   CASE 
						   		WHEN funnel_step= 'Step 2.1' AND COALESCE(prev_step, 'n') <> 'Step 2' AND user_id = prev_user THEN 1
						   		WHEN funnel_step= 'Step 3.1' AND COALESCE(prev_step, 'n') <> 'Step 3' AND user_id = prev_user THEN 1
								ELSE anmly_flg
						   END AS funnel_anmly_flg
					FROM int_funnel 
)

SELECT *
FROM final_funnel
  );
[0m01:08:47.743719 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:08:47.749049 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.749868 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
alter table "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp" rename to "int_sales_funnel"
[0m01:08:47.751503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.754949 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m01:08:47.755732 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.756378 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m01:08:47.757836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.760440 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup"
[0m01:08:47.761417 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m01:08:47.761916 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
drop view if exists "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup" cascade
[0m01:08:47.762693 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:08:47.764468 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: Close
[0m01:08:47.765612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38f4ff80>]}
[0m01:08:47.766737 [info ] [Thread-1 (]: 10 of 12 OK created sql view model pipedrive_analytics.int_sales_funnel ........ [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.768512 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_sales_funnel
[0m01:08:47.769779 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_step_month_matrix
[0m01:08:47.770937 [info ] [Thread-1 (]: 11 of 12 START sql view model pipedrive_analytics.int_step_month_matrix ........ [RUN]
[0m01:08:47.771647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_sales_funnel, now model.enpal_assessment_project.int_step_month_matrix)
[0m01:08:47.772148 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_step_month_matrix
[0m01:08:47.776428 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.777373 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_step_month_matrix
[0m01:08:47.783397 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.784367 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.784853 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: BEGIN
[0m01:08:47.785672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.794082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:08:47.794850 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.795731 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */

  create view "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp"
    
    
  as (
    

WITH
all_unique_steps AS (
                        SELECT 
                               * 
                        FROM (
                                VALUES
                                    ('Lead Generation',              'Step 1'),
                                    ('Qualified lead',               'Step 2'),
                                    ('Sales Call 1',                 'Step 2.1'),
                                    ('Needs Assessment',             'Step 3'),
                                    ('Sales Call 2',                 'Step 3.1'),
                                    ('Proposal/Quote Preparation',   'Step 4'),
                                    ('Negotiation',                  'Step 5'),
                                    ('Closing',                      'Step 6'),
                                    ('Implementation/Onboarding',    'Step 7'),
                                    ('Follow-up/Customer Success',   'Step 8'),
                                    ('Renewal/Expansion',            'Step 9')
                             ) AS t (kpi_name, funnel_step)
                        )
, all_months AS (
                    SELECT DISTINCT month 
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                )

, month_step_matrix AS (
                         SELECT
                               m.month,
                               s.kpi_name,
                               s.funnel_step
                         FROM all_months m
                         CROSS JOIN all_unique_steps s
                       )

SELECT *
FROM month_step_matrix
  );
[0m01:08:47.798822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:08:47.803566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.804372 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
alter table "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp" rename to "int_step_month_matrix"
[0m01:08:47.805724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:47.807776 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m01:08:47.808577 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.809288 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m01:08:47.810910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:47.813989 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup"
[0m01:08:47.814939 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m01:08:47.815443 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
drop view if exists "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup" cascade
[0m01:08:47.816170 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:08:47.817630 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: Close
[0m01:08:47.818672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c38f07860>]}
[0m01:08:47.819789 [info ] [Thread-1 (]: 11 of 12 OK created sql view model pipedrive_analytics.int_step_month_matrix ... [[32mCREATE VIEW[0m in 0.05s]
[0m01:08:47.822279 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_step_month_matrix
[0m01:08:47.823581 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m01:08:47.824547 [info ] [Thread-1 (]: 12 of 12 START sql table model pipedrive_analytics.rep_sales_funnel_monthly .... [RUN]
[0m01:08:47.825517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_step_month_matrix, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m01:08:47.826014 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m01:08:47.831792 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:47.832722 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m01:08:47.859431 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:47.860317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:47.860837 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m01:08:47.861551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:47.871919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:08:47.872692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:47.873611 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

WITH
monthly_data AS (
                    SELECT
                           month,
                           kpi_name,
                           funnel_step,
                           COUNT(DISTINCT deal_id) AS deals_count
                           
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                    WHERE funnel_anmly_flg = 0
                    GROUP BY 
                             month, 
                             kpi_name, 
                             funnel_step
)

, final AS (
             SELECT
                    ms.month,
                    ms.kpi_name,
                    ms.funnel_step,
                    COALESCE(a.deals_count, 0) AS deals_count

             FROM "postgres"."pipedrive_analytics"."int_step_month_matrix" ms
             LEFT JOIN monthly_data a            ON ms.month = a.month
                                                    AND ms.kpi_name = a.kpi_name
                               
           )
SELECT *
FROM final
  );
  
[0m01:08:48.080049 [debug] [Thread-1 (]: SQL status: SELECT 154 in 0.205 seconds
[0m01:08:48.087986 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:48.088564 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m01:08:48.089603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:08:48.092521 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:48.092986 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m01:08:48.093975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:08:48.095833 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m01:08:48.096317 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:48.096754 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m01:08:48.098209 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:08:48.100784 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m01:08:48.104217 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m01:08:48.104699 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m01:08:48.106878 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m01:08:48.108380 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m01:08:48.109289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0ecb4f-cbbe-43c7-bb0f-2a412bd00dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3a8545c0>]}
[0m01:08:48.110418 [info ] [Thread-1 (]: 12 of 12 OK created sql table model pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 154[0m in 0.28s]
[0m01:08:48.112298 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m01:08:48.114395 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:48.115124 [debug] [MainThread]: On master: BEGIN
[0m01:08:48.115788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:08:48.127162 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:08:48.127927 [debug] [MainThread]: On master: COMMIT
[0m01:08:48.128377 [debug] [MainThread]: Using postgres connection "master"
[0m01:08:48.128765 [debug] [MainThread]: On master: COMMIT
[0m01:08:48.129335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:08:48.129749 [debug] [MainThread]: On master: Close
[0m01:08:48.130334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:48.130939 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m01:08:48.131734 [info ] [MainThread]: 
[0m01:08:48.132732 [info ] [MainThread]: Finished running 1 table model, 11 view models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m01:08:48.136714 [debug] [MainThread]: Command end result
[0m01:08:48.168571 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:08:48.170851 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:08:48.177053 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m01:08:48.177524 [info ] [MainThread]: 
[0m01:08:48.178146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:48.178715 [info ] [MainThread]: 
[0m01:08:48.179578 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m01:08:48.182982 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0405076, "process_in_blocks": "2384", "process_kernel_time": 0.312754, "process_mem_max_rss": "144256", "process_out_blocks": "3224", "process_user_time": 4.965219}
[0m01:08:48.184048 [debug] [MainThread]: Command `cli build` succeeded at 01:08:48.183873 after 3.04 seconds
[0m01:08:48.184886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3e4088c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3bfe2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741c3e5a85c0>]}
[0m01:08:48.185735 [debug] [MainThread]: Flushing usage events
[0m01:08:48.671779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:12:19.504378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710813aaac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710811fa3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71081289ef60>]}


============================== 01:12:19.508068 | 7b8e0c19-3548-42e7-9f97-5489fb46ce9c ==============================
[0m01:12:19.508068 [info ] [MainThread]: Running with dbt=1.10.0
[0m01:12:19.508996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m01:12:19.698495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7108139ffd10>]}
[0m01:12:19.772566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7108117bb290>]}
[0m01:12:19.773779 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:12:19.938802 [debug] [MainThread]: checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, vars: {}, profile: , target: dev, version: 1.10.0
[0m01:12:20.017411 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:12:20.018192 [debug] [MainThread]: previous checksum: ded1c53f2b99ea6ad08029af7d38ffd2272d98278567e2007e3d87b9b9e19772, current checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed
[0m01:12:20.018810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71080f5174d0>]}
[0m01:12:21.020600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71080f94fb90>]}
[0m01:12:21.227318 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:12:21.237587 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:12:21.252632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71080f1ec1d0>]}
[0m01:12:21.253331 [info ] [MainThread]: Found 12 models, 6 sources, 434 macros
[0m01:12:21.253946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71080ed1c050>]}
[0m01:12:21.256890 [info ] [MainThread]: 
[0m01:12:21.257679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:12:21.258290 [info ] [MainThread]: 
[0m01:12:21.259495 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:12:21.261354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:12:21.308828 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:12:21.309881 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:12:21.310629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:21.321782 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m01:12:21.323317 [debug] [ThreadPool]: On list_postgres: Close
[0m01:12:21.329491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m01:12:21.336072 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:12:21.336567 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m01:12:21.336983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:21.344792 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:12:21.345504 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m01:12:21.346059 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m01:12:21.349245 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m01:12:21.350814 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m01:12:21.351606 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m01:12:21.360974 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:21.361584 [debug] [MainThread]: On master: BEGIN
[0m01:12:21.362232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:12:21.370309 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m01:12:21.370956 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:21.371643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:12:21.375398 [debug] [MainThread]: SQL status: SELECT 14 in 0.003 seconds
[0m01:12:21.379556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710811099b50>]}
[0m01:12:21.380491 [debug] [MainThread]: On master: ROLLBACK
[0m01:12:21.381779 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:21.382679 [debug] [MainThread]: On master: BEGIN
[0m01:12:21.383760 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:12:21.384501 [debug] [MainThread]: On master: COMMIT
[0m01:12:21.385251 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:21.385771 [debug] [MainThread]: On master: COMMIT
[0m01:12:21.386354 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:12:21.386784 [debug] [MainThread]: On master: Close
[0m01:12:21.390182 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m01:12:21.391211 [info ] [Thread-1 (]: 1 of 1 START sql view model pipedrive_analytics.stg_fields ..................... [RUN]
[0m01:12:21.392635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_fields)
[0m01:12:21.393419 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m01:12:21.404464 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m01:12:21.405253 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m01:12:21.450720 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m01:12:21.451772 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:12:21.452349 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m01:12:21.452799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:21.460720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m01:12:21.461458 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:12:21.461976 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp"
    
    
  as (
    

WITH

raw AS (
        SELECT 
              id          AS field_id,
              field_key,
              name        AS field_name,
              field_value_options

        FROM "postgres"."public"."fields"
)

, base AS (
            SELECT
                  field_id,
                  field_key,
                  field_value_options
                  
            FROM raw
            WHERE field_value_options IS NOT NULL
)

, exploded AS (
                SELECT
                      b.field_id,
                      b.field_key,
                      e.elem->>'id'    AS option_id,
                      e.elem->>'label' AS option_label

                FROM base b
                CROSS JOIN lateral
                    jsonb_array_elements(b.field_value_options) WITH ordinality AS e(elem, ord)
)

, transformed AS (
                    SELECT
                          r.field_id,
                          r.field_key,
                          r.field_name,
                          CASE
                              WHEN e.option_id ~ '^\d+$' THEN e.option_id::int
                              ELSE NULL
                          END AS option_id,
                          e.option_label
                        
                    FROM raw r
                    LEFT JOIN exploded e    USING (field_id)
)
SELECT
        *
FROM transformed
ORDER BY field_id, 
         option_id
  );
[0m01:12:21.465332 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:12:21.476359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:12:21.476870 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m01:12:21.478183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:12:21.484920 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:12:21.485472 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m01:12:21.486553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:12:21.502622 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m01:12:21.503170 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:12:21.503634 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m01:12:21.505074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:12:21.511332 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_fields__dbt_backup"
[0m01:12:21.516636 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m01:12:21.517132 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m01:12:21.520032 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:12:21.523636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m01:12:21.526184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8e0c19-3548-42e7-9f97-5489fb46ce9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7108139feed0>]}
[0m01:12:21.527269 [info ] [Thread-1 (]: 1 of 1 OK created sql view model pipedrive_analytics.stg_fields ................ [[32mCREATE VIEW[0m in 0.13s]
[0m01:12:21.528233 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m01:12:21.529750 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:21.530460 [debug] [MainThread]: On master: BEGIN
[0m01:12:21.531184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:12:21.540109 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:12:21.540772 [debug] [MainThread]: On master: COMMIT
[0m01:12:21.541223 [debug] [MainThread]: Using postgres connection "master"
[0m01:12:21.541623 [debug] [MainThread]: On master: COMMIT
[0m01:12:21.542221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:12:21.542644 [debug] [MainThread]: On master: Close
[0m01:12:21.543222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:21.543831 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_fields' was properly closed.
[0m01:12:21.544467 [info ] [MainThread]: 
[0m01:12:21.545082 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m01:12:21.546396 [debug] [MainThread]: Command end result
[0m01:12:21.575773 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m01:12:21.578886 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m01:12:21.585365 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m01:12:21.585820 [info ] [MainThread]: 
[0m01:12:21.586486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:12:21.587056 [info ] [MainThread]: 
[0m01:12:21.587810 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:12:21.589552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1420944, "process_in_blocks": "408", "process_kernel_time": 0.275418, "process_mem_max_rss": "140844", "process_out_blocks": "2888", "process_user_time": 4.55782}
[0m01:12:21.590502 [debug] [MainThread]: Command `cli run` succeeded at 01:12:21.590336 after 2.14 seconds
[0m01:12:21.591311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71081166ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71080db94c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710811233770>]}
[0m01:12:21.592125 [debug] [MainThread]: Flushing usage events
[0m01:12:22.001235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:23.132378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c934643e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c950b09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c950b11f0>]}


============================== 02:05:23.138670 | c93c1384-9fdb-4309-9a7b-0ea25312c860 ==============================
[0m02:05:23.138670 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:05:23.139554 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'invocation_command': 'dbt deps', 'empty': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default'}
[0m02:05:23.389425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c93c1384-9fdb-4309-9a7b-0ea25312c860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c93bf7e30>]}
[0m02:05:23.506442 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kbz1xh0_'
[0m02:05:23.507752 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:05:23.624026 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:05:23.626322 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:05:23.662836 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:05:23.677420 [info ] [MainThread]: Updating lock file in file path: /workspaces/dbt_enpal_assessment_mahmoud/package-lock.yml
[0m02:05:23.680933 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d1rk_0l8'
[0m02:05:23.686591 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:05:23.909263 [info ] [MainThread]: Installed from version 1.3.3
[0m02:05:23.910215 [info ] [MainThread]: Up to date!
[0m02:05:23.911052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c93c1384-9fdb-4309-9a7b-0ea25312c860', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c92c1ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c92c1c770>]}
[0m02:05:23.916375 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86734164, "process_in_blocks": "15328", "process_kernel_time": 0.157021, "process_mem_max_rss": "105756", "process_out_blocks": "2480", "process_user_time": 1.888209}
[0m02:05:23.917218 [debug] [MainThread]: Command `dbt deps` succeeded at 02:05:23.917045 after 0.87 seconds
[0m02:05:23.917928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c9293bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c93465a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c93466360>]}
[0m02:05:23.918735 [debug] [MainThread]: Flushing usage events
[0m02:05:24.317939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:05:36.104520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1108a5bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1108a59130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1108d2d760>]}


============================== 02:05:36.108337 | 0fd3f3bb-dafb-4e52-94c8-e43171407bdd ==============================
[0m02:05:36.108337 [info ] [MainThread]: Running with dbt=1.11.2
[0m02:05:36.109247 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt compile', 'fail_fast': 'False', 'empty': 'False', 'debug': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True'}
[0m02:05:36.371969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fd3f3bb-dafb-4e52-94c8-e43171407bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1107957c80>]}
[0m02:05:36.439775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fd3f3bb-dafb-4e52-94c8-e43171407bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c110921c3b0>]}
[0m02:05:36.440937 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m02:05:36.560904 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m02:05:36.639463 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m02:05:36.640290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fd3f3bb-dafb-4e52-94c8-e43171407bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1108a93f80>]}
[0m02:05:37.965292 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/staging/schema.yml @ models: {'name': 'stg_activity', 'description': "{{ doc('stg_activity') }}", 'meta': {'owner': 'Mahmoud Muhammed', 'team': 'Data Analytics', 'email': 'memadeldin93@gmail.com'}, 'tests': None, 'columns': [{'name': 'activity_id', 'description': "{{ doc('stg_activity__activity_id') }}", 'tests': ['not_null', 'unique']}, {'name': 'type', 'description': "{{ doc('stg_activity__type') }}", 'tests': ['not_null']}, {'name': 'assigned_to_user', 'description': "{{ doc('stg_activity__assigned_to_user') }}", 'tests': ['not_null']}, {'name': 'deal_id', 'description': "{{ doc('stg_activity__deal_id') }}", 'tests': ['not_null']}, {'name': 'done', 'description': "{{ doc('stg_activity__done') }}", 'tests': ['not_null', {'accepted_values': {'values': [True, False]}}]}, {'name': 'due_to_dt', 'description': "{{ doc('stg_activity__due_to_dt') }}", 'tests': ['not_null']}], 'original_file_path': 'models/staging/schema.yml', 'yaml_key': 'models', 'package_name': 'enpal_assessment_project'} - at path ['tests']: None is not of type 'array'
[0m02:05:37.967683 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.9217435, "process_in_blocks": "14120", "process_kernel_time": 0.20092, "process_mem_max_rss": "116936", "process_out_blocks": "8", "process_user_time": 3.158027}
[0m02:05:37.968749 [debug] [MainThread]: Command `dbt compile` failed at 02:05:37.968569 after 1.92 seconds
[0m02:05:37.969733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11083a0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1106913fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1108217950>]}
[0m02:05:37.970659 [debug] [MainThread]: Flushing usage events
[0m02:05:38.355515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:15:04.332686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865e3fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48677a8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48663ea870>]}


============================== 02:15:04.336306 | 1851efbb-26a9-422a-9e44-58dbc59b724d ==============================
[0m02:15:04.336306 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:15:04.337369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:15:04.488097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1851efbb-26a9-422a-9e44-58dbc59b724d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4867f70860>]}
[0m02:15:04.527567 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7a0pgi4s'
[0m02:15:04.528922 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:15:04.598358 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:15:04.600978 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:15:04.657085 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:15:04.667566 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:15:04.957307 [info ] [MainThread]: Installed from version 1.3.3
[0m02:15:04.958179 [info ] [MainThread]: Up to date!
[0m02:15:04.958913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1851efbb-26a9-422a-9e44-58dbc59b724d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48654b4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48654b4230>]}
[0m02:15:04.968862 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.69281864, "process_in_blocks": "872", "process_kernel_time": 0.194914, "process_mem_max_rss": "118964", "process_out_blocks": "2296", "process_user_time": 2.84515}
[0m02:15:04.970059 [debug] [MainThread]: Command `cli deps` succeeded at 02:15:04.969807 after 0.69 seconds
[0m02:15:04.970951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865e1aae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4865e1b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48655e8950>]}
[0m02:15:04.971814 [debug] [MainThread]: Flushing usage events
[0m02:15:05.372416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:34.714734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d35483920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d36c9cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d35483080>]}


============================== 02:18:34.725810 | 4e6fe708-e306-4859-9c87-3bfd4ebc8cc3 ==============================
[0m02:18:34.725810 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:18:34.728419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt parse', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:18:34.956543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e6fe708-e306-4859-9c87-3bfd4ebc8cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d34322210>]}
[0m02:18:35.022355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e6fe708-e306-4859-9c87-3bfd4ebc8cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d37bffe30>]}
[0m02:18:35.023566 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:18:35.277852 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m02:18:35.412553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:35.413159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:35.460468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e6fe708-e306-4859-9c87-3bfd4ebc8cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d343b1580>]}
[0m02:18:35.464214 [info ] [MainThread]: Performance info: /workspaces/dbt_enpal_assessment_mahmoud/target/perf_info.json
[0m02:18:35.642195 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:18:35.700835 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:18:35.704822 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.0637094, "process_in_blocks": "160", "process_kernel_time": 0.25344, "process_mem_max_rss": "128564", "process_out_blocks": "1384", "process_user_time": 4.065903}
[0m02:18:35.706534 [debug] [MainThread]: Command `dbt parse` succeeded at 02:18:35.706287 after 1.07 seconds
[0m02:18:35.707577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d361c5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d361c6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0d32f1b290>]}
[0m02:18:35.708500 [debug] [MainThread]: Flushing usage events
[0m02:18:36.134864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:57.856918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d766b7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d764e68a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d765152e0>]}


============================== 02:18:57.860610 | 16d11137-6aad-4fa5-8eb4-34f135a58058 ==============================
[0m02:18:57.860610 [info ] [MainThread]: Running with dbt=1.10.0
[0m02:18:57.861555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:18:58.045507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16d11137-6aad-4fa5-8eb4-34f135a58058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d75d30cb0>]}
[0m02:18:58.112029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16d11137-6aad-4fa5-8eb4-34f135a58058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d751c1d60>]}
[0m02:18:58.113325 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:18:58.272638 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m02:18:58.388439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:58.389140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:58.436783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16d11137-6aad-4fa5-8eb4-34f135a58058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d75166cf0>]}
[0m02:18:58.528540 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:18:58.537670 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:18:58.593005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16d11137-6aad-4fa5-8eb4-34f135a58058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d739ff050>]}
[0m02:18:58.593814 [info ] [MainThread]: Found 12 models, 32 data tests, 6 sources, 550 macros
[0m02:18:58.594469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d11137-6aad-4fa5-8eb4-34f135a58058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d73d85b20>]}
[0m02:18:58.599296 [info ] [MainThread]: 
[0m02:18:58.600008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:58.600554 [info ] [MainThread]: 
[0m02:18:58.601361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:58.608173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m02:18:58.646359 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:18:58.647024 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m02:18:58.647531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:58.659897 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m02:18:58.660529 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m02:18:58.661019 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m02:18:58.664245 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m02:18:58.666500 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m02:18:58.667454 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m02:18:58.676332 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:58.677114 [debug] [MainThread]: On master: BEGIN
[0m02:18:58.677802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:58.688242 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m02:18:58.688744 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:58.689250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:18:58.692929 [debug] [MainThread]: SQL status: SELECT 14 in 0.003 seconds
[0m02:18:58.697411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16d11137-6aad-4fa5-8eb4-34f135a58058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d7513cf20>]}
[0m02:18:58.698376 [debug] [MainThread]: On master: ROLLBACK
[0m02:18:58.699713 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:58.700613 [debug] [MainThread]: On master: BEGIN
[0m02:18:58.701539 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:18:58.702073 [debug] [MainThread]: On master: COMMIT
[0m02:18:58.702940 [debug] [MainThread]: Using postgres connection "master"
[0m02:18:58.704106 [debug] [MainThread]: On master: COMMIT
[0m02:18:58.705564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:18:58.706442 [debug] [MainThread]: On master: Close
[0m02:18:58.710650 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m02:18:58.711441 [info ] [Thread-1 (]: 1 of 32 START test accepted_values_stg_activity_done__True__False .............. [RUN]
[0m02:18:58.712322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052)
[0m02:18:58.712808 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m02:18:58.729599 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m02:18:58.730650 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m02:18:58.752274 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m02:18:58.753533 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m02:18:58.754079 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: BEGIN
[0m02:18:58.754620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:58.762668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:58.763215 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m02:18:58.763714 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        done as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."stg_activity"
    group by done

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m02:18:58.781244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m02:18:58.788818 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: ROLLBACK
[0m02:18:58.790314 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: Close
[0m02:18:58.791691 [info ] [Thread-1 (]: 1 of 32 PASS accepted_values_stg_activity_done__True__False .................... [[32mPASS[0m in 0.08s]
[0m02:18:58.795075 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m02:18:58.796835 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m02:18:58.798244 [info ] [Thread-1 (]: 2 of 32 START test accepted_values_stg_activity_types_is_active__True__False ... [RUN]
[0m02:18:58.799228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052, now test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a)
[0m02:18:58.800140 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m02:18:58.808736 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m02:18:58.809679 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m02:18:58.813887 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m02:18:58.814710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m02:18:58.815202 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: BEGIN
[0m02:18:58.815648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:58.823379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:58.823893 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m02:18:58.824416 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_active as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."stg_activity_types"
    group by is_active

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m02:18:58.826459 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:58.828201 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: ROLLBACK
[0m02:18:58.828842 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: Close
[0m02:18:58.829749 [info ] [Thread-1 (]: 2 of 32 PASS accepted_values_stg_activity_types_is_active__True__False ......... [[32mPASS[0m in 0.03s]
[0m02:18:58.830998 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m02:18:58.831793 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m02:18:58.832573 [info ] [Thread-1 (]: 3 of 32 START test dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value  [RUN]
[0m02:18:58.833230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6)
[0m02:18:58.833772 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m02:18:58.848406 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m02:18:58.849710 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m02:18:58.854827 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m02:18:58.856007 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m02:18:58.856855 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: BEGIN
[0m02:18:58.857666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:58.870810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:18:58.871396 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m02:18:58.871907 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, changed_field_key, new_value
    from "postgres"."pipedrive_analytics"."stg_deal_changes"
    group by deal_id, change_dt, changed_field_key, new_value
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:18:58.944441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m02:18:58.946703 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: ROLLBACK
[0m02:18:58.947629 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: Close
[0m02:18:58.948656 [info ] [Thread-1 (]: 3 of 32 PASS dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value  [[32mPASS[0m in 0.12s]
[0m02:18:58.950130 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m02:18:58.950947 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m02:18:58.951894 [info ] [Thread-1 (]: 4 of 32 START test dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id  [RUN]
[0m02:18:58.953937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00)
[0m02:18:58.955573 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m02:18:58.964085 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m02:18:58.964918 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m02:18:58.967980 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m02:18:58.968802 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m02:18:58.969332 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: BEGIN
[0m02:18:58.969794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:58.978500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:18:58.979165 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m02:18:58.979780 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        field_id, option_id
    from "postgres"."pipedrive_analytics"."stg_fields"
    group by field_id, option_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m02:18:58.982492 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:58.984299 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: ROLLBACK
[0m02:18:58.984983 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: Close
[0m02:18:58.985903 [info ] [Thread-1 (]: 4 of 32 PASS dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id  [[32mPASS[0m in 0.03s]
[0m02:18:58.986979 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m02:18:58.987938 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:18:58.988782 [info ] [Thread-1 (]: 5 of 32 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m02:18:58.989443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m02:18:58.989916 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:18:59.000298 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:18:59.001466 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:18:59.006537 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:18:59.007648 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:18:59.008152 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m02:18:59.008614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.016610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.017159 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m02:18:59.017670 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.020613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:59.022345 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m02:18:59.023000 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m02:18:59.023888 [info ] [Thread-1 (]: 5 of 32 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.03s]
[0m02:18:59.024900 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m02:18:59.025669 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m02:18:59.026589 [info ] [Thread-1 (]: 6 of 32 START test not_null_stg_activity_assigned_to_user ...................... [RUN]
[0m02:18:59.027268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df)
[0m02:18:59.027751 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m02:18:59.032796 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m02:18:59.033884 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m02:18:59.040472 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m02:18:59.041594 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m02:18:59.042765 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: BEGIN
[0m02:18:59.043581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.053616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:18:59.054188 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m02:18:59.054679 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select assigned_to_user
from "postgres"."pipedrive_analytics"."stg_activity"
where assigned_to_user is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.064512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:18:59.066329 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: ROLLBACK
[0m02:18:59.067022 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: Close
[0m02:18:59.067994 [info ] [Thread-1 (]: 6 of 32 PASS not_null_stg_activity_assigned_to_user ............................ [[32mPASS[0m in 0.04s]
[0m02:18:59.069060 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m02:18:59.069795 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m02:18:59.070523 [info ] [Thread-1 (]: 7 of 32 START test not_null_stg_activity_deal_id ............................... [RUN]
[0m02:18:59.071333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m02:18:59.071810 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m02:18:59.210955 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m02:18:59.211956 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m02:18:59.214609 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m02:18:59.215372 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m02:18:59.215861 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m02:18:59.216353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.224595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.225142 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m02:18:59.225640 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.235566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:18:59.237417 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m02:18:59.238136 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m02:18:59.239037 [info ] [Thread-1 (]: 7 of 32 PASS not_null_stg_activity_deal_id ..................................... [[32mPASS[0m in 0.17s]
[0m02:18:59.240282 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m02:18:59.241010 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m02:18:59.241797 [info ] [Thread-1 (]: 8 of 32 START test not_null_stg_activity_done .................................. [RUN]
[0m02:18:59.242510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1)
[0m02:18:59.242982 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m02:18:59.248973 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m02:18:59.249782 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m02:18:59.252532 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m02:18:59.253282 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m02:18:59.253767 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: BEGIN
[0m02:18:59.254212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.262034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.262562 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m02:18:59.263052 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select done
from "postgres"."pipedrive_analytics"."stg_activity"
where done is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.272736 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m02:18:59.274560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: ROLLBACK
[0m02:18:59.275226 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: Close
[0m02:18:59.276113 [info ] [Thread-1 (]: 8 of 32 PASS not_null_stg_activity_done ........................................ [[32mPASS[0m in 0.03s]
[0m02:18:59.277367 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m02:18:59.278140 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m02:18:59.278885 [info ] [Thread-1 (]: 9 of 32 START test not_null_stg_activity_due_to_dt ............................. [RUN]
[0m02:18:59.279512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1, now test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989)
[0m02:18:59.279988 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m02:18:59.285808 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m02:18:59.286548 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m02:18:59.289170 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m02:18:59.289887 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m02:18:59.290375 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: BEGIN
[0m02:18:59.290804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.303123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:18:59.303884 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m02:18:59.304606 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select due_to_dt
from "postgres"."pipedrive_analytics"."stg_activity"
where due_to_dt is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.321346 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m02:18:59.324308 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: ROLLBACK
[0m02:18:59.325303 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: Close
[0m02:18:59.328796 [info ] [Thread-1 (]: 9 of 32 PASS not_null_stg_activity_due_to_dt ................................... [[32mPASS[0m in 0.05s]
[0m02:18:59.330033 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m02:18:59.331290 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m02:18:59.332030 [info ] [Thread-1 (]: 10 of 32 START test not_null_stg_activity_type ................................. [RUN]
[0m02:18:59.333050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989, now test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d)
[0m02:18:59.333788 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m02:18:59.342194 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m02:18:59.343108 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m02:18:59.347190 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m02:18:59.348191 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m02:18:59.348941 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: BEGIN
[0m02:18:59.349789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.367611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m02:18:59.368559 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m02:18:59.369115 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "postgres"."pipedrive_analytics"."stg_activity"
where type is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.381550 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:18:59.383479 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: ROLLBACK
[0m02:18:59.384167 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: Close
[0m02:18:59.385082 [info ] [Thread-1 (]: 10 of 32 PASS not_null_stg_activity_type ....................................... [[32mPASS[0m in 0.05s]
[0m02:18:59.386360 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m02:18:59.387215 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:18:59.388002 [info ] [Thread-1 (]: 11 of 32 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m02:18:59.389042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m02:18:59.389787 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:18:59.396366 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:18:59.397142 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:18:59.401451 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:18:59.402232 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:18:59.402717 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m02:18:59.403176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.410959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.411512 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m02:18:59.411997 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.413609 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.415316 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m02:18:59.415984 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m02:18:59.416877 [info ] [Thread-1 (]: 11 of 32 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m02:18:59.418026 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m02:18:59.418797 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m02:18:59.419505 [info ] [Thread-1 (]: 12 of 32 START test not_null_stg_activity_types_is_active ...................... [RUN]
[0m02:18:59.420144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f)
[0m02:18:59.420620 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m02:18:59.425906 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m02:18:59.426857 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m02:18:59.430775 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m02:18:59.431725 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m02:18:59.432542 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: BEGIN
[0m02:18:59.433308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.442248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:18:59.442745 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m02:18:59.443239 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_active
from "postgres"."pipedrive_analytics"."stg_activity_types"
where is_active is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.444841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.446519 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: ROLLBACK
[0m02:18:59.447184 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: Close
[0m02:18:59.448020 [info ] [Thread-1 (]: 12 of 32 PASS not_null_stg_activity_types_is_active ............................ [[32mPASS[0m in 0.03s]
[0m02:18:59.449040 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m02:18:59.450001 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m02:18:59.450653 [info ] [Thread-1 (]: 13 of 32 START test not_null_stg_activity_types_name ........................... [RUN]
[0m02:18:59.451282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f, now test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596)
[0m02:18:59.451760 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m02:18:59.456450 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m02:18:59.457445 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m02:18:59.460922 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m02:18:59.461678 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m02:18:59.462156 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: BEGIN
[0m02:18:59.462604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.471531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:18:59.472043 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m02:18:59.472547 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."pipedrive_analytics"."stg_activity_types"
where name is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.474137 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.475793 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: ROLLBACK
[0m02:18:59.476460 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: Close
[0m02:18:59.477299 [info ] [Thread-1 (]: 13 of 32 PASS not_null_stg_activity_types_name ................................. [[32mPASS[0m in 0.03s]
[0m02:18:59.478307 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m02:18:59.479058 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m02:18:59.479801 [info ] [Thread-1 (]: 14 of 32 START test not_null_stg_activity_types_type ........................... [RUN]
[0m02:18:59.480421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596, now test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d)
[0m02:18:59.480907 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m02:18:59.486367 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m02:18:59.487080 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m02:18:59.489688 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m02:18:59.490439 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m02:18:59.490913 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: BEGIN
[0m02:18:59.491390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.499295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.500112 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m02:18:59.500621 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "postgres"."pipedrive_analytics"."stg_activity_types"
where type is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.502956 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:59.504692 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: ROLLBACK
[0m02:18:59.505354 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: Close
[0m02:18:59.506384 [info ] [Thread-1 (]: 14 of 32 PASS not_null_stg_activity_types_type ................................. [[32mPASS[0m in 0.03s]
[0m02:18:59.507552 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m02:18:59.508344 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m02:18:59.508945 [info ] [Thread-1 (]: 15 of 32 START test not_null_stg_deal_changes_change_dt ........................ [RUN]
[0m02:18:59.509581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d, now test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35)
[0m02:18:59.510080 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m02:18:59.515733 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m02:18:59.516461 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m02:18:59.519129 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m02:18:59.519865 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m02:18:59.520360 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: BEGIN
[0m02:18:59.520925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.528904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.529697 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m02:18:59.530530 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.536360 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:18:59.538033 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: ROLLBACK
[0m02:18:59.538716 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: Close
[0m02:18:59.539587 [info ] [Thread-1 (]: 15 of 32 PASS not_null_stg_deal_changes_change_dt .............................. [[32mPASS[0m in 0.03s]
[0m02:18:59.540638 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m02:18:59.541406 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m02:18:59.542152 [info ] [Thread-1 (]: 16 of 32 START test not_null_stg_deal_changes_changed_field_key ................ [RUN]
[0m02:18:59.542862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35, now test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f)
[0m02:18:59.543375 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m02:18:59.549408 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m02:18:59.550421 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m02:18:59.557383 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m02:18:59.558404 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m02:18:59.559177 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: BEGIN
[0m02:18:59.559894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.568932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:18:59.569560 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m02:18:59.570082 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select changed_field_key
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where changed_field_key is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.575883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:18:59.577602 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: ROLLBACK
[0m02:18:59.578272 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: Close
[0m02:18:59.579193 [info ] [Thread-1 (]: 16 of 32 PASS not_null_stg_deal_changes_changed_field_key ...................... [[32mPASS[0m in 0.04s]
[0m02:18:59.580432 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m02:18:59.581157 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:18:59.581977 [info ] [Thread-1 (]: 17 of 32 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m02:18:59.582625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m02:18:59.583144 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:18:59.589908 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:18:59.590910 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:18:59.594883 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:18:59.595681 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:18:59.596175 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m02:18:59.596627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.604565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.605188 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m02:18:59.606314 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.612685 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:18:59.614466 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m02:18:59.615160 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m02:18:59.616077 [info ] [Thread-1 (]: 17 of 32 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m02:18:59.617161 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m02:18:59.617906 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m02:18:59.618618 [info ] [Thread-1 (]: 18 of 32 START test not_null_stg_deal_changes_new_value ........................ [RUN]
[0m02:18:59.619502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d)
[0m02:18:59.619983 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m02:18:59.625732 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m02:18:59.626703 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m02:18:59.631273 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m02:18:59.632158 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m02:18:59.632662 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: BEGIN
[0m02:18:59.633400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.641844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.642361 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m02:18:59.642851 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select new_value
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where new_value is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.648163 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m02:18:59.649925 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: ROLLBACK
[0m02:18:59.650620 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: Close
[0m02:18:59.651509 [info ] [Thread-1 (]: 18 of 32 PASS not_null_stg_deal_changes_new_value .............................. [[32mPASS[0m in 0.03s]
[0m02:18:59.652556 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m02:18:59.653297 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m02:18:59.654066 [info ] [Thread-1 (]: 19 of 32 START test not_null_stg_fields_field_id ............................... [RUN]
[0m02:18:59.654834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m02:18:59.655336 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m02:18:59.661793 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m02:18:59.662878 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m02:18:59.666548 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m02:18:59.667296 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m02:18:59.667771 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: BEGIN
[0m02:18:59.668210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.675638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m02:18:59.676171 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m02:18:59.676663 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_id
from "postgres"."pipedrive_analytics"."stg_fields"
where field_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.678855 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:59.680472 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: ROLLBACK
[0m02:18:59.681130 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: Close
[0m02:18:59.681950 [info ] [Thread-1 (]: 19 of 32 PASS not_null_stg_fields_field_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:18:59.682979 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m02:18:59.683836 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:18:59.684499 [info ] [Thread-1 (]: 20 of 32 START test not_null_stg_fields_field_key .............................. [RUN]
[0m02:18:59.685117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m02:18:59.685594 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:18:59.689929 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:18:59.691125 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:18:59.694234 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:18:59.694967 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:18:59.695460 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m02:18:59.695896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.705282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:18:59.706295 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m02:18:59.707080 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.709361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:59.711007 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m02:18:59.711667 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m02:18:59.712574 [info ] [Thread-1 (]: 20 of 32 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m02:18:59.713616 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m02:18:59.714385 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m02:18:59.715175 [info ] [Thread-1 (]: 21 of 32 START test not_null_stg_fields_field_name ............................. [RUN]
[0m02:18:59.715786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd)
[0m02:18:59.716276 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m02:18:59.721679 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m02:18:59.722721 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m02:18:59.728641 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m02:18:59.729717 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m02:18:59.730400 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: BEGIN
[0m02:18:59.730842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.747549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:18:59.749027 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m02:18:59.750001 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_name
from "postgres"."pipedrive_analytics"."stg_fields"
where field_name is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.753661 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:18:59.756801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: ROLLBACK
[0m02:18:59.757912 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: Close
[0m02:18:59.760814 [info ] [Thread-1 (]: 21 of 32 PASS not_null_stg_fields_field_name ................................... [[32mPASS[0m in 0.04s]
[0m02:18:59.761922 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m02:18:59.762512 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m02:18:59.763515 [info ] [Thread-1 (]: 22 of 32 START test not_null_stg_stages_funnel_step ............................ [RUN]
[0m02:18:59.764947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd, now test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e)
[0m02:18:59.765780 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m02:18:59.772978 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m02:18:59.773801 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m02:18:59.777129 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m02:18:59.778263 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m02:18:59.778999 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: BEGIN
[0m02:18:59.779759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.790426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:18:59.790974 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m02:18:59.791504 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."stg_stages"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.793240 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.794994 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: ROLLBACK
[0m02:18:59.795673 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: Close
[0m02:18:59.796598 [info ] [Thread-1 (]: 22 of 32 PASS not_null_stg_stages_funnel_step .................................. [[32mPASS[0m in 0.03s]
[0m02:18:59.797690 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m02:18:59.798445 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:18:59.799264 [info ] [Thread-1 (]: 23 of 32 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m02:18:59.800247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m02:18:59.800988 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:18:59.812957 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:18:59.813821 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:18:59.817567 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:18:59.818327 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:18:59.818803 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m02:18:59.819272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.827241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.827755 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m02:18:59.828267 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.829880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.831611 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m02:18:59.832304 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m02:18:59.833214 [info ] [Thread-1 (]: 23 of 32 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m02:18:59.834249 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m02:18:59.834971 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m02:18:59.835727 [info ] [Thread-1 (]: 24 of 32 START test not_null_stg_stages_stage_name ............................. [RUN]
[0m02:18:59.836497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25)
[0m02:18:59.836978 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m02:18:59.843052 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m02:18:59.843816 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m02:18:59.846577 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m02:18:59.847340 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m02:18:59.848055 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: BEGIN
[0m02:18:59.848537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.856641 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.857214 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m02:18:59.857730 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_name
from "postgres"."pipedrive_analytics"."stg_stages"
where stage_name is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.859852 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:59.862485 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: ROLLBACK
[0m02:18:59.863194 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: Close
[0m02:18:59.864393 [info ] [Thread-1 (]: 24 of 32 PASS not_null_stg_stages_stage_name ................................... [[32mPASS[0m in 0.03s]
[0m02:18:59.866403 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m02:18:59.867162 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m02:18:59.868156 [info ] [Thread-1 (]: 25 of 32 START test not_null_stg_users_user_email .............................. [RUN]
[0m02:18:59.868812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25, now test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f)
[0m02:18:59.869311 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m02:18:59.875513 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m02:18:59.876293 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m02:18:59.880203 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m02:18:59.881223 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m02:18:59.881977 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: BEGIN
[0m02:18:59.882743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.898316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:18:59.899218 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m02:18:59.900429 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_email
from "postgres"."pipedrive_analytics"."stg_users"
where user_email is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.903283 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:18:59.906247 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: ROLLBACK
[0m02:18:59.907258 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: Close
[0m02:18:59.909461 [info ] [Thread-1 (]: 25 of 32 PASS not_null_stg_users_user_email .................................... [[32mPASS[0m in 0.04s]
[0m02:18:59.911983 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m02:18:59.913886 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:18:59.915072 [info ] [Thread-1 (]: 26 of 32 START test not_null_stg_users_user_id ................................. [RUN]
[0m02:18:59.916289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m02:18:59.917450 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:18:59.926846 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:18:59.928296 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:18:59.936226 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:18:59.937797 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:18:59.938702 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m02:18:59.939245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.947175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.947739 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m02:18:59.948244 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.949793 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.951659 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m02:18:59.952362 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m02:18:59.953323 [info ] [Thread-1 (]: 26 of 32 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m02:18:59.954523 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m02:18:59.955334 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m02:18:59.956069 [info ] [Thread-1 (]: 27 of 32 START test not_null_stg_users_user_modified_at ........................ [RUN]
[0m02:18:59.957116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0)
[0m02:18:59.957868 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m02:18:59.966936 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m02:18:59.967972 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m02:18:59.972653 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m02:18:59.974216 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m02:18:59.975000 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: BEGIN
[0m02:18:59.975624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:18:59.983718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:18:59.984333 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m02:18:59.984912 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_modified_at
from "postgres"."pipedrive_analytics"."stg_users"
where user_modified_at is null



  
  
      
    ) dbt_internal_test
[0m02:18:59.986675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:18:59.988859 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: ROLLBACK
[0m02:18:59.990628 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: Close
[0m02:18:59.993646 [info ] [Thread-1 (]: 27 of 32 PASS not_null_stg_users_user_modified_at .............................. [[32mPASS[0m in 0.04s]
[0m02:18:59.995085 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m02:18:59.996633 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:18:59.997448 [info ] [Thread-1 (]: 28 of 32 START test not_null_stg_users_user_name ............................... [RUN]
[0m02:18:59.998502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m02:18:59.999283 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:19:00.008989 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:19:00.010144 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:19:00.013018 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:19:00.013851 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:19:00.014377 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m02:19:00.014834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.022951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:19:00.023498 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m02:19:00.023980 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m02:19:00.025790 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:19:00.027523 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m02:19:00.028199 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m02:19:00.029112 [info ] [Thread-1 (]: 28 of 32 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.03s]
[0m02:19:00.030322 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m02:19:00.031062 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:19:00.031864 [info ] [Thread-1 (]: 29 of 32 START test unique_stg_activity_activity_id ............................ [RUN]
[0m02:19:00.032509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m02:19:00.032980 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:19:00.042504 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:19:00.043584 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:19:00.046668 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:19:00.047439 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:19:00.047920 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m02:19:00.048376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.056172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:19:00.056720 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m02:19:00.057235 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:19:00.069805 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:19:00.072175 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m02:19:00.073369 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m02:19:00.074702 [info ] [Thread-1 (]: 29 of 32 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.04s]
[0m02:19:00.075818 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m02:19:00.076536 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:19:00.077354 [info ] [Thread-1 (]: 30 of 32 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m02:19:00.078118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m02:19:00.078630 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:19:00.084896 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:19:00.085819 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:19:00.088755 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:19:00.089551 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:19:00.090043 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m02:19:00.090517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.098535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:19:00.099064 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m02:19:00.099607 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:19:00.101621 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:19:00.103352 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m02:19:00.104013 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m02:19:00.104929 [info ] [Thread-1 (]: 30 of 32 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m02:19:00.105932 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m02:19:00.106641 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:19:00.107622 [info ] [Thread-1 (]: 31 of 32 START test unique_stg_stages_stage_id ................................. [RUN]
[0m02:19:00.108280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m02:19:00.108774 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:19:00.113901 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:19:00.114679 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:19:00.120535 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:19:00.121339 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:19:00.121836 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m02:19:00.122310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.132197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:19:00.132774 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m02:19:00.133447 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:19:00.135449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m02:19:00.137256 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m02:19:00.137943 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m02:19:00.138894 [info ] [Thread-1 (]: 31 of 32 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:19:00.139902 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m02:19:00.140620 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:19:00.141530 [info ] [Thread-1 (]: 32 of 32 START test unique_stg_users_user_id ................................... [RUN]
[0m02:19:00.142177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m02:19:00.142658 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:19:00.147688 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:19:00.148468 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:19:00.153189 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:19:00.154293 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:19:00.154907 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m02:19:00.155424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.163904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:19:00.164434 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m02:19:00.164925 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:19:00.167357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:19:00.169160 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m02:19:00.169841 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m02:19:00.170773 [info ] [Thread-1 (]: 32 of 32 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m02:19:00.171965 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m02:19:00.173787 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:00.174268 [debug] [MainThread]: On master: BEGIN
[0m02:19:00.174681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:00.183735 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:19:00.184224 [debug] [MainThread]: On master: COMMIT
[0m02:19:00.184657 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:00.185058 [debug] [MainThread]: On master: COMMIT
[0m02:19:00.185920 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:19:00.186647 [debug] [MainThread]: On master: Close
[0m02:19:00.187505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:00.188239 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m02:19:00.189001 [info ] [MainThread]: 
[0m02:19:00.189704 [info ] [MainThread]: Finished running 32 data tests in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m02:19:00.196044 [debug] [MainThread]: Command end result
[0m02:19:00.232507 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m02:19:00.235324 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m02:19:00.244041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m02:19:00.244856 [info ] [MainThread]: 
[0m02:19:00.245704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:19:00.246476 [info ] [MainThread]: 
[0m02:19:00.247267 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=32
[0m02:19:00.249172 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.4481335, "process_in_blocks": "1160", "process_kernel_time": 0.275737, "process_mem_max_rss": "140668", "process_out_blocks": "3696", "process_user_time": 4.474511}
[0m02:19:00.250244 [debug] [MainThread]: Command `dbt test` succeeded at 02:19:00.250064 after 2.45 seconds
[0m02:19:00.251110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d7616c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d769ec2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d769ed010>]}
[0m02:19:00.251982 [debug] [MainThread]: Flushing usage events
[0m02:19:00.625979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:27.904857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c8dd6d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c671d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c68377a0>]}


============================== 03:25:27.908556 | 11fc9109-d996-4b72-a3d8-bc5d27a6b292 ==============================
[0m03:25:27.908556 [info ] [MainThread]: Running with dbt=1.10.0
[0m03:25:27.909415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:25:28.110474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c61ef7a0>]}
[0m03:25:28.177246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c68bfb90>]}
[0m03:25:28.178455 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:25:28.366850 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m03:25:28.501789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:25:28.502450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:25:28.562764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c55f4170>]}
[0m03:25:28.677264 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m03:25:28.686476 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m03:25:28.704916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c415f380>]}
[0m03:25:28.705651 [info ] [MainThread]: Found 12 models, 56 data tests, 1 seed, 6 sources, 550 macros
[0m03:25:28.706253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c60e5f70>]}
[0m03:25:28.709108 [info ] [MainThread]: 
[0m03:25:28.709686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:25:28.710212 [info ] [MainThread]: 
[0m03:25:28.711019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:25:28.712329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:25:28.751769 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:25:28.752592 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:25:28.753046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:28.763702 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m03:25:28.765225 [debug] [ThreadPool]: On list_postgres: Close
[0m03:25:28.771205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m03:25:28.777659 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m03:25:28.778113 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m03:25:28.778519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:28.786167 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m03:25:28.786627 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m03:25:28.787061 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m03:25:28.791164 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m03:25:28.793370 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m03:25:28.794418 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m03:25:28.802056 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:28.802555 [debug] [MainThread]: On master: BEGIN
[0m03:25:28.802951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:28.810600 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m03:25:28.811117 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:28.811594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:25:28.815216 [debug] [MainThread]: SQL status: SELECT 14 in 0.003 seconds
[0m03:25:28.818142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c7abed50>]}
[0m03:25:28.818746 [debug] [MainThread]: On master: ROLLBACK
[0m03:25:28.819437 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:28.819912 [debug] [MainThread]: On master: BEGIN
[0m03:25:28.820693 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:25:28.821203 [debug] [MainThread]: On master: COMMIT
[0m03:25:28.821655 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:28.822041 [debug] [MainThread]: On master: COMMIT
[0m03:25:28.822631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:25:28.823044 [debug] [MainThread]: On master: Close
[0m03:25:28.826254 [debug] [Thread-1 (]: Began running node seed.enpal_assessment_project.funnel_steps
[0m03:25:28.827127 [info ] [Thread-1 (]: 1 of 1 START seed file pipedrive_analytics.funnel_steps ........................ [RUN]
[0m03:25:28.827873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now seed.enpal_assessment_project.funnel_steps)
[0m03:25:28.828391 [debug] [Thread-1 (]: Began compiling node seed.enpal_assessment_project.funnel_steps
[0m03:25:28.828865 [debug] [Thread-1 (]: Began executing node seed.enpal_assessment_project.funnel_steps
[0m03:25:28.858627 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m03:25:28.859268 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: BEGIN
[0m03:25:28.859753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:25:28.867781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:25:28.868324 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m03:25:28.868791 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "seed.enpal_assessment_project.funnel_steps"} */

    create table "postgres"."pipedrive_analytics"."funnel_steps" ("kpi_name" text,"funnel_step" text,"step_order" integer)
  
[0m03:25:28.877407 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.008 seconds
[0m03:25:28.905863 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m03:25:28.906536 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: 
          insert into "postgres"."pipedrive_analytics"."funnel_steps" ("kpi_name", "funnel_step", "step_order") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m03:25:28.907863 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.001 seconds
[0m03:25:28.914698 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.enpal_assessment_project.funnel_steps"
[0m03:25:28.937150 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: COMMIT
[0m03:25:28.937806 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m03:25:28.938318 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: COMMIT
[0m03:25:28.939813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m03:25:28.941815 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: Close
[0m03:25:28.968662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc9109-d996-4b72-a3d8-bc5d27a6b292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c701f320>]}
[0m03:25:28.969595 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file pipedrive_analytics.funnel_steps .................... [[32mINSERT 11[0m in 0.11s]
[0m03:25:28.970526 [debug] [Thread-1 (]: Finished running node seed.enpal_assessment_project.funnel_steps
[0m03:25:28.972055 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:28.972569 [debug] [MainThread]: On master: BEGIN
[0m03:25:28.973009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:28.982456 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m03:25:28.982953 [debug] [MainThread]: On master: COMMIT
[0m03:25:28.983405 [debug] [MainThread]: Using postgres connection "master"
[0m03:25:28.983798 [debug] [MainThread]: On master: COMMIT
[0m03:25:28.984391 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:25:28.984837 [debug] [MainThread]: On master: Close
[0m03:25:28.985470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:28.986170 [debug] [MainThread]: Connection 'seed.enpal_assessment_project.funnel_steps' was properly closed.
[0m03:25:28.986843 [info ] [MainThread]: 
[0m03:25:28.987566 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m03:25:28.988605 [debug] [MainThread]: Command end result
[0m03:25:29.163567 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m03:25:29.166332 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m03:25:29.172488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m03:25:29.172948 [info ] [MainThread]: 
[0m03:25:29.173630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:25:29.174145 [info ] [MainThread]: 
[0m03:25:29.174663 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:25:29.175848 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.33404, "process_in_blocks": "24", "process_kernel_time": 0.257524, "process_mem_max_rss": "139500", "process_out_blocks": "3440", "process_user_time": 3.675212}
[0m03:25:29.176490 [debug] [MainThread]: Command `dbt seed` succeeded at 03:25:29.176376 after 1.33 seconds
[0m03:25:29.176973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c6b72120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c68377a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7640c61ee270>]}
[0m03:25:29.177518 [debug] [MainThread]: Flushing usage events
[0m03:25:29.570286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:35:09.954313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ac8d78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ac106540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8abe85850>]}


============================== 03:35:09.958028 | ce34f488-a11c-4722-b7a9-98529ee19b8e ==============================
[0m03:35:09.958028 [info ] [MainThread]: Running with dbt=1.10.0
[0m03:35:09.958915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:35:10.185440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce34f488-a11c-4722-b7a9-98529ee19b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ab817050>]}
[0m03:35:10.253327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce34f488-a11c-4722-b7a9-98529ee19b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ac653cb0>]}
[0m03:35:10.254534 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:35:10.412930 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m03:35:10.551321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:35:10.551957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:35:10.610589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce34f488-a11c-4722-b7a9-98529ee19b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8aab43680>]}
[0m03:35:10.721643 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m03:35:10.730992 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m03:35:10.759605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce34f488-a11c-4722-b7a9-98529ee19b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8a93d0440>]}
[0m03:35:10.760314 [info ] [MainThread]: Found 1 seed, 12 models, 60 data tests, 6 sources, 550 macros
[0m03:35:10.760905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce34f488-a11c-4722-b7a9-98529ee19b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8aaba46b0>]}
[0m03:35:10.765404 [info ] [MainThread]: 
[0m03:35:10.765976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:35:10.766647 [info ] [MainThread]: 
[0m03:35:10.767420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:35:10.773828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m03:35:10.811118 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m03:35:10.811746 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m03:35:10.812231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:35:10.822233 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m03:35:10.822798 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m03:35:10.823316 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m03:35:10.827696 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m03:35:10.830531 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m03:35:10.831262 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m03:35:10.976438 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:10.977434 [debug] [MainThread]: On master: BEGIN
[0m03:35:10.978239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:35:10.986660 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m03:35:10.987194 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:10.987672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:35:10.991464 [debug] [MainThread]: SQL status: SELECT 14 in 0.003 seconds
[0m03:35:10.997011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce34f488-a11c-4722-b7a9-98529ee19b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ac078770>]}
[0m03:35:10.997655 [debug] [MainThread]: On master: ROLLBACK
[0m03:35:10.998667 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:10.999537 [debug] [MainThread]: On master: BEGIN
[0m03:35:11.000836 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m03:35:11.001769 [debug] [MainThread]: On master: COMMIT
[0m03:35:11.002877 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:11.003789 [debug] [MainThread]: On master: COMMIT
[0m03:35:11.004807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:35:11.005722 [debug] [MainThread]: On master: Close
[0m03:35:11.012525 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m03:35:11.013067 [info ] [Thread-1 (]: 1 of 60 START test accepted_values_int_sales_funnel_funnel_anmly_flg__0__1 ..... [RUN]
[0m03:35:11.013769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61)
[0m03:35:11.014291 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m03:35:11.033403 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m03:35:11.034402 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m03:35:11.052883 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m03:35:11.053733 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m03:35:11.054233 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: BEGIN
[0m03:35:11.054681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.062573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.063076 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m03:35:11.063631 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        funnel_anmly_flg as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."int_sales_funnel"
    group by funnel_anmly_flg

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m03:35:11.137694 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.074 seconds
[0m03:35:11.142323 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: ROLLBACK
[0m03:35:11.143077 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: Close
[0m03:35:11.144110 [info ] [Thread-1 (]: 1 of 60 PASS accepted_values_int_sales_funnel_funnel_anmly_flg__0__1 ........... [[32mPASS[0m in 0.13s]
[0m03:35:11.145351 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m03:35:11.146164 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m03:35:11.147001 [info ] [Thread-1 (]: 2 of 60 START test accepted_values_int_stages_anmly_anmly_flg__0__1 ............ [RUN]
[0m03:35:11.147826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61, now test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb)
[0m03:35:11.148336 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m03:35:11.154303 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m03:35:11.155050 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m03:35:11.157748 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m03:35:11.158517 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m03:35:11.158993 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: BEGIN
[0m03:35:11.159468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.166972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:11.167486 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m03:35:11.167979 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        anmly_flg as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."int_stages_anmly"
    group by anmly_flg

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m03:35:11.223042 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.054 seconds
[0m03:35:11.225114 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: ROLLBACK
[0m03:35:11.225904 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: Close
[0m03:35:11.226942 [info ] [Thread-1 (]: 2 of 60 PASS accepted_values_int_stages_anmly_anmly_flg__0__1 .................. [[32mPASS[0m in 0.08s]
[0m03:35:11.228260 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m03:35:11.229130 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m03:35:11.230062 [info ] [Thread-1 (]: 3 of 60 START test accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9  [RUN]
[0m03:35:11.231039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb, now test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef)
[0m03:35:11.231849 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m03:35:11.250666 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m03:35:11.251973 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m03:35:11.257205 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m03:35:11.258186 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m03:35:11.258695 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: BEGIN
[0m03:35:11.259163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.267288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.267796 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m03:35:11.268319 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        funnel_step as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."int_step_month_matrix"
    group by funnel_step

)

select *
from all_values
where value_field not in (
    'Step 1','Step 2','Step 2.1','Step 3','Step 3.1','Step 4','Step 5','Step 6','Step 7','Step 8','Step 9'
)



  
  
      
    ) dbt_internal_test
[0m03:35:11.343619 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.075 seconds
[0m03:35:11.345733 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: ROLLBACK
[0m03:35:11.346621 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: Close
[0m03:35:11.347717 [info ] [Thread-1 (]: 3 of 60 PASS accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9  [[32mPASS[0m in 0.12s]
[0m03:35:11.348966 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m03:35:11.349790 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m03:35:11.350623 [info ] [Thread-1 (]: 4 of 60 START test accepted_values_stg_activity_done__True__False .............. [RUN]
[0m03:35:11.351393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef, now test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052)
[0m03:35:11.351902 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m03:35:11.359743 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m03:35:11.360540 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m03:35:11.363160 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m03:35:11.363915 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m03:35:11.364433 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: BEGIN
[0m03:35:11.364887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.373189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.373697 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m03:35:11.374218 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        done as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."stg_activity"
    group by done

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m03:35:11.384420 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m03:35:11.386133 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: ROLLBACK
[0m03:35:11.386814 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: Close
[0m03:35:11.387705 [info ] [Thread-1 (]: 4 of 60 PASS accepted_values_stg_activity_done__True__False .................... [[32mPASS[0m in 0.04s]
[0m03:35:11.388819 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m03:35:11.389564 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m03:35:11.390338 [info ] [Thread-1 (]: 5 of 60 START test accepted_values_stg_activity_types_is_active__True__False ... [RUN]
[0m03:35:11.390916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052, now test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a)
[0m03:35:11.391423 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m03:35:11.397038 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m03:35:11.397917 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m03:35:11.400554 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m03:35:11.401321 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m03:35:11.401803 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: BEGIN
[0m03:35:11.402268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.409826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:11.410607 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m03:35:11.411407 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_active as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."stg_activity_types"
    group by is_active

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m03:35:11.413759 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:11.416964 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: ROLLBACK
[0m03:35:11.417674 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: Close
[0m03:35:11.418802 [info ] [Thread-1 (]: 5 of 60 PASS accepted_values_stg_activity_types_is_active__True__False ......... [[32mPASS[0m in 0.03s]
[0m03:35:11.420863 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m03:35:11.421654 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m03:35:11.422374 [info ] [Thread-1 (]: 6 of 60 START test dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id  [RUN]
[0m03:35:11.422978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c)
[0m03:35:11.423505 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m03:35:11.440706 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m03:35:11.441587 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m03:35:11.445009 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m03:35:11.445810 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m03:35:11.446314 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: BEGIN
[0m03:35:11.446765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.454361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.454875 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m03:35:11.455392 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, kpi_name, funnel_step, user_id
    from "postgres"."pipedrive_analytics"."int_sales_funnel"
    group by deal_id, change_dt, kpi_name, funnel_step, user_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m03:35:11.527980 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m03:35:11.530133 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: ROLLBACK
[0m03:35:11.531035 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: Close
[0m03:35:11.532076 [info ] [Thread-1 (]: 6 of 60 PASS dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id  [[32mPASS[0m in 0.11s]
[0m03:35:11.533407 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m03:35:11.534288 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m03:35:11.535138 [info ] [Thread-1 (]: 7 of 60 START test dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id  [RUN]
[0m03:35:11.535862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec)
[0m03:35:11.536374 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m03:35:11.543757 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m03:35:11.544580 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m03:35:11.547521 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m03:35:11.548317 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m03:35:11.548805 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: BEGIN
[0m03:35:11.549276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.556934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.557467 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m03:35:11.557957 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, stage_id
    from "postgres"."pipedrive_analytics"."int_stages"
    group by deal_id, change_dt, stage_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m03:35:11.610007 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m03:35:11.611925 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: ROLLBACK
[0m03:35:11.612718 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: Close
[0m03:35:11.613709 [info ] [Thread-1 (]: 7 of 60 PASS dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id  [[32mPASS[0m in 0.08s]
[0m03:35:11.614777 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m03:35:11.615652 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m03:35:11.616616 [info ] [Thread-1 (]: 8 of 60 START test dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step  [RUN]
[0m03:35:11.617504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586)
[0m03:35:11.618235 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m03:35:11.627718 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m03:35:11.628521 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m03:35:11.631357 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m03:35:11.632148 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m03:35:11.632642 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: BEGIN
[0m03:35:11.633114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.641251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.641838 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m03:35:11.642451 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        month, funnel_step
    from "postgres"."pipedrive_analytics"."int_step_month_matrix"
    group by month, funnel_step
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m03:35:11.713403 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.070 seconds
[0m03:35:11.716454 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: ROLLBACK
[0m03:35:11.717368 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: Close
[0m03:35:11.720369 [info ] [Thread-1 (]: 8 of 60 PASS dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step  [[32mPASS[0m in 0.10s]
[0m03:35:11.721500 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m03:35:11.723387 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m03:35:11.724364 [info ] [Thread-1 (]: 9 of 60 START test dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name  [RUN]
[0m03:35:11.725341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926)
[0m03:35:11.726195 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m03:35:11.734474 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m03:35:11.735405 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m03:35:11.738137 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m03:35:11.738908 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m03:35:11.739413 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: BEGIN
[0m03:35:11.739862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.747499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.748022 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m03:35:11.748552 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        month, kpi_name
    from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
    group by month, kpi_name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m03:35:11.750464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:11.752197 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: ROLLBACK
[0m03:35:11.752892 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: Close
[0m03:35:11.753828 [info ] [Thread-1 (]: 9 of 60 PASS dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name  [[32mPASS[0m in 0.03s]
[0m03:35:11.754873 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m03:35:11.755637 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m03:35:11.756504 [info ] [Thread-1 (]: 10 of 60 START test dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value  [RUN]
[0m03:35:11.757210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6)
[0m03:35:11.757941 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m03:35:11.766638 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m03:35:11.767693 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m03:35:11.772001 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m03:35:11.773155 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m03:35:11.773861 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: BEGIN
[0m03:35:11.774376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.782084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.782634 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m03:35:11.783171 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, changed_field_key, new_value
    from "postgres"."pipedrive_analytics"."stg_deal_changes"
    group by deal_id, change_dt, changed_field_key, new_value
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m03:35:11.855423 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m03:35:11.857541 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: ROLLBACK
[0m03:35:11.858395 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: Close
[0m03:35:11.859544 [info ] [Thread-1 (]: 10 of 60 PASS dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value  [[32mPASS[0m in 0.10s]
[0m03:35:11.860618 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m03:35:11.861454 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m03:35:11.862250 [info ] [Thread-1 (]: 11 of 60 START test dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id  [RUN]
[0m03:35:11.863181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00)
[0m03:35:11.863697 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m03:35:11.871965 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m03:35:11.872980 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m03:35:11.876788 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m03:35:11.877615 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m03:35:11.878111 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: BEGIN
[0m03:35:11.878570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.888028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:11.888796 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m03:35:11.889658 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        field_id, option_id
    from "postgres"."pipedrive_analytics"."stg_fields"
    group by field_id, option_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m03:35:11.893479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m03:35:11.895356 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: ROLLBACK
[0m03:35:11.896033 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: Close
[0m03:35:11.896974 [info ] [Thread-1 (]: 11 of 60 PASS dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id  [[32mPASS[0m in 0.03s]
[0m03:35:11.898018 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m03:35:11.898781 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m03:35:11.899650 [info ] [Thread-1 (]: 12 of 60 START test not_null_int_sales_funnel_change_dt ........................ [RUN]
[0m03:35:11.900312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00, now test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b)
[0m03:35:11.900788 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m03:35:11.909902 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m03:35:11.910987 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m03:35:11.915464 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m03:35:11.916900 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m03:35:11.917616 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: BEGIN
[0m03:35:11.918105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:11.926231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:11.926735 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m03:35:11.927227 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.003138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.075 seconds
[0m03:35:12.005285 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: ROLLBACK
[0m03:35:12.006141 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: Close
[0m03:35:12.007169 [info ] [Thread-1 (]: 12 of 60 PASS not_null_int_sales_funnel_change_dt .............................. [[32mPASS[0m in 0.11s]
[0m03:35:12.008255 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m03:35:12.009004 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m03:35:12.009822 [info ] [Thread-1 (]: 13 of 60 START test not_null_int_sales_funnel_deal_id .......................... [RUN]
[0m03:35:12.010827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b, now test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e)
[0m03:35:12.011360 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m03:35:12.017418 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m03:35:12.018164 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m03:35:12.020849 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m03:35:12.021601 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m03:35:12.022064 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: BEGIN
[0m03:35:12.022511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.030248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:12.030741 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m03:35:12.031232 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.055333 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m03:35:12.061565 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: ROLLBACK
[0m03:35:12.063373 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: Close
[0m03:35:12.067644 [info ] [Thread-1 (]: 13 of 60 PASS not_null_int_sales_funnel_deal_id ................................ [[32mPASS[0m in 0.06s]
[0m03:35:12.069133 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m03:35:12.070212 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m03:35:12.071144 [info ] [Thread-1 (]: 14 of 60 START test not_null_int_sales_funnel_funnel_anmly_flg ................. [RUN]
[0m03:35:12.072138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e, now test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70)
[0m03:35:12.072870 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m03:35:12.081000 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m03:35:12.082056 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m03:35:12.088996 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m03:35:12.090147 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m03:35:12.091034 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: BEGIN
[0m03:35:12.091838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.104797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m03:35:12.105632 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m03:35:12.106463 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_anmly_flg
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where funnel_anmly_flg is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.193959 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.087 seconds
[0m03:35:12.196119 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: ROLLBACK
[0m03:35:12.197004 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: Close
[0m03:35:12.198006 [info ] [Thread-1 (]: 14 of 60 PASS not_null_int_sales_funnel_funnel_anmly_flg ....................... [[32mPASS[0m in 0.13s]
[0m03:35:12.199318 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m03:35:12.200104 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m03:35:12.200873 [info ] [Thread-1 (]: 15 of 60 START test not_null_int_sales_funnel_funnel_step ...................... [RUN]
[0m03:35:12.201761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70, now test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738)
[0m03:35:12.202286 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m03:35:12.208745 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m03:35:12.209554 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m03:35:12.212333 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m03:35:12.213102 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m03:35:12.213588 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: BEGIN
[0m03:35:12.214031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.221722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:12.222249 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m03:35:12.222741 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.289883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.066 seconds
[0m03:35:12.292054 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: ROLLBACK
[0m03:35:12.292904 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: Close
[0m03:35:12.293976 [info ] [Thread-1 (]: 15 of 60 PASS not_null_int_sales_funnel_funnel_step ............................ [[32mPASS[0m in 0.09s]
[0m03:35:12.295359 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m03:35:12.296139 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m03:35:12.296986 [info ] [Thread-1 (]: 16 of 60 START test not_null_int_sales_funnel_kpi_name ......................... [RUN]
[0m03:35:12.297836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738, now test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e)
[0m03:35:12.298358 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m03:35:12.306901 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m03:35:12.307928 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m03:35:12.312444 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m03:35:12.313514 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m03:35:12.314339 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: BEGIN
[0m03:35:12.315122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.323248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:12.323746 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m03:35:12.324244 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.387652 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.063 seconds
[0m03:35:12.393155 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: ROLLBACK
[0m03:35:12.394824 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: Close
[0m03:35:12.396303 [info ] [Thread-1 (]: 16 of 60 PASS not_null_int_sales_funnel_kpi_name ............................... [[32mPASS[0m in 0.10s]
[0m03:35:12.397363 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m03:35:12.398062 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m03:35:12.398936 [info ] [Thread-1 (]: 17 of 60 START test not_null_int_sales_funnel_month ............................ [RUN]
[0m03:35:12.400008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e, now test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940)
[0m03:35:12.400515 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m03:35:12.406504 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m03:35:12.407281 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m03:35:12.409928 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m03:35:12.410690 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m03:35:12.411175 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: BEGIN
[0m03:35:12.411629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.420580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:12.421110 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m03:35:12.421601 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where month is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.492813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.071 seconds
[0m03:35:12.494952 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: ROLLBACK
[0m03:35:12.495836 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: Close
[0m03:35:12.496875 [info ] [Thread-1 (]: 17 of 60 PASS not_null_int_sales_funnel_month .................................. [[32mPASS[0m in 0.10s]
[0m03:35:12.497968 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m03:35:12.498741 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m03:35:12.499554 [info ] [Thread-1 (]: 18 of 60 START test not_null_int_sales_funnel_user_id .......................... [RUN]
[0m03:35:12.500416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940, now test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395)
[0m03:35:12.501107 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m03:35:12.507777 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m03:35:12.508852 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m03:35:12.513522 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m03:35:12.514387 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m03:35:12.514857 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: BEGIN
[0m03:35:12.517512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.525420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:12.525933 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m03:35:12.526450 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.596348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.069 seconds
[0m03:35:12.598476 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: ROLLBACK
[0m03:35:12.599345 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: Close
[0m03:35:12.600356 [info ] [Thread-1 (]: 18 of 60 PASS not_null_int_sales_funnel_user_id ................................ [[32mPASS[0m in 0.10s]
[0m03:35:12.601579 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m03:35:12.602328 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m03:35:12.603173 [info ] [Thread-1 (]: 19 of 60 START test not_null_int_stages_anmly_anmly_flg ........................ [RUN]
[0m03:35:12.603975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395, now test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b)
[0m03:35:12.604496 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m03:35:12.611565 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m03:35:12.612385 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m03:35:12.615040 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m03:35:12.615819 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m03:35:12.616334 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: BEGIN
[0m03:35:12.616793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.624677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:12.625215 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m03:35:12.625711 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select anmly_flg
from "postgres"."pipedrive_analytics"."int_stages_anmly"
where anmly_flg is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.683058 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.057 seconds
[0m03:35:12.685927 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: ROLLBACK
[0m03:35:12.687419 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: Close
[0m03:35:12.688692 [info ] [Thread-1 (]: 19 of 60 PASS not_null_int_stages_anmly_anmly_flg .............................. [[32mPASS[0m in 0.08s]
[0m03:35:12.689894 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m03:35:12.690649 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m03:35:12.692839 [info ] [Thread-1 (]: 20 of 60 START test not_null_int_stages_anmly_rn ............................... [RUN]
[0m03:35:12.693795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b, now test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916)
[0m03:35:12.694543 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m03:35:12.700617 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m03:35:12.701429 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m03:35:12.704169 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m03:35:12.704921 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m03:35:12.705490 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: BEGIN
[0m03:35:12.706201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.715746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m03:35:12.716295 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m03:35:12.716793 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "postgres"."pipedrive_analytics"."int_stages_anmly"
where rn is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.774284 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.057 seconds
[0m03:35:12.776442 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: ROLLBACK
[0m03:35:12.777306 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: Close
[0m03:35:12.778289 [info ] [Thread-1 (]: 20 of 60 PASS not_null_int_stages_anmly_rn ..................................... [[32mPASS[0m in 0.08s]
[0m03:35:12.779380 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m03:35:12.780232 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m03:35:12.781052 [info ] [Thread-1 (]: 21 of 60 START test not_null_int_stages_change_dt .............................. [RUN]
[0m03:35:12.782958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916, now test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e)
[0m03:35:12.784233 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m03:35:12.793020 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m03:35:12.794131 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m03:35:12.797454 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m03:35:12.798227 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m03:35:12.798719 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: BEGIN
[0m03:35:12.799171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.806946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:12.807469 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m03:35:12.807952 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."int_stages"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.814644 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m03:35:12.816428 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: ROLLBACK
[0m03:35:12.817679 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: Close
[0m03:35:12.818968 [info ] [Thread-1 (]: 21 of 60 PASS not_null_int_stages_change_dt .................................... [[32mPASS[0m in 0.04s]
[0m03:35:12.822912 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m03:35:12.824007 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m03:35:12.824987 [info ] [Thread-1 (]: 22 of 60 START test not_null_int_stages_deal_id ................................ [RUN]
[0m03:35:12.826109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e, now test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9)
[0m03:35:12.826947 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m03:35:12.833256 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m03:35:12.834020 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m03:35:12.836857 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m03:35:12.837646 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m03:35:12.838134 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: BEGIN
[0m03:35:12.838591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.847760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:12.848276 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m03:35:12.848763 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."int_stages"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.855309 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m03:35:12.857021 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: ROLLBACK
[0m03:35:12.857716 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: Close
[0m03:35:12.858602 [info ] [Thread-1 (]: 22 of 60 PASS not_null_int_stages_deal_id ...................................... [[32mPASS[0m in 0.03s]
[0m03:35:12.859785 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m03:35:12.860532 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m03:35:12.861258 [info ] [Thread-1 (]: 23 of 60 START test not_null_int_stages_funnel_step ............................ [RUN]
[0m03:35:12.862017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9, now test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54)
[0m03:35:12.862778 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m03:35:12.869817 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m03:35:12.870827 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m03:35:12.873531 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m03:35:12.874305 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m03:35:12.877782 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: BEGIN
[0m03:35:12.878613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.887216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:12.887748 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m03:35:12.888254 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."int_stages"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.924442 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.036 seconds
[0m03:35:12.926537 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: ROLLBACK
[0m03:35:12.927391 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: Close
[0m03:35:12.928456 [info ] [Thread-1 (]: 23 of 60 PASS not_null_int_stages_funnel_step .................................. [[32mPASS[0m in 0.07s]
[0m03:35:12.929534 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m03:35:12.930344 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m03:35:12.931077 [info ] [Thread-1 (]: 24 of 60 START test not_null_int_stages_month .................................. [RUN]
[0m03:35:12.931957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54, now test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9)
[0m03:35:12.932479 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m03:35:12.937892 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m03:35:12.938958 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m03:35:12.941984 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m03:35:12.942756 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m03:35:12.943261 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: BEGIN
[0m03:35:12.943709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:12.952996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:12.953802 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m03:35:12.954615 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."int_stages"
where month is null



  
  
      
    ) dbt_internal_test
[0m03:35:12.975553 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m03:35:12.978437 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: ROLLBACK
[0m03:35:12.979435 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: Close
[0m03:35:12.982758 [info ] [Thread-1 (]: 24 of 60 PASS not_null_int_stages_month ........................................ [[32mPASS[0m in 0.05s]
[0m03:35:12.983860 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m03:35:12.984638 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m03:35:12.985187 [info ] [Thread-1 (]: 25 of 60 START test not_null_int_stages_stage_id ............................... [RUN]
[0m03:35:12.985907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9, now test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4)
[0m03:35:12.986422 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m03:35:12.992309 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m03:35:12.993063 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m03:35:12.995747 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m03:35:12.996496 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m03:35:12.996980 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: BEGIN
[0m03:35:12.997461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.005439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:13.005935 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m03:35:13.006446 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."pipedrive_analytics"."int_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.015392 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m03:35:13.017061 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: ROLLBACK
[0m03:35:13.017738 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: Close
[0m03:35:13.018786 [info ] [Thread-1 (]: 25 of 60 PASS not_null_int_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m03:35:13.019831 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m03:35:13.020739 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m03:35:13.021571 [info ] [Thread-1 (]: 26 of 60 START test not_null_int_stages_stage_name ............................. [RUN]
[0m03:35:13.022696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4, now test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5)
[0m03:35:13.023659 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m03:35:13.032698 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m03:35:13.033917 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m03:35:13.041302 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m03:35:13.042651 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m03:35:13.043442 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: BEGIN
[0m03:35:13.044072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.053487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:13.053998 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m03:35:13.054504 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_name
from "postgres"."pipedrive_analytics"."int_stages"
where stage_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.088748 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m03:35:13.090539 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: ROLLBACK
[0m03:35:13.091242 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: Close
[0m03:35:13.092178 [info ] [Thread-1 (]: 26 of 60 PASS not_null_int_stages_stage_name ................................... [[32mPASS[0m in 0.07s]
[0m03:35:13.093385 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m03:35:13.094144 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m03:35:13.095043 [info ] [Thread-1 (]: 27 of 60 START test not_null_int_step_month_matrix_funnel_step ................. [RUN]
[0m03:35:13.095715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5, now test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f)
[0m03:35:13.096213 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m03:35:13.102043 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m03:35:13.103035 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m03:35:13.105750 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m03:35:13.106503 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m03:35:13.106975 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: BEGIN
[0m03:35:13.107438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.114863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:13.115460 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m03:35:13.115949 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."int_step_month_matrix"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.124062 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m03:35:13.125922 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: ROLLBACK
[0m03:35:13.126597 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: Close
[0m03:35:13.127453 [info ] [Thread-1 (]: 27 of 60 PASS not_null_int_step_month_matrix_funnel_step ....................... [[32mPASS[0m in 0.03s]
[0m03:35:13.128682 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m03:35:13.129463 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m03:35:13.130163 [info ] [Thread-1 (]: 28 of 60 START test not_null_int_step_month_matrix_kpi_name .................... [RUN]
[0m03:35:13.131343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f, now test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4)
[0m03:35:13.132304 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m03:35:13.139523 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m03:35:13.140456 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m03:35:13.144869 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m03:35:13.145926 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m03:35:13.149510 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: BEGIN
[0m03:35:13.150293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.167127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m03:35:13.167690 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m03:35:13.168209 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."pipedrive_analytics"."int_step_month_matrix"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.175209 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m03:35:13.177560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: ROLLBACK
[0m03:35:13.178573 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: Close
[0m03:35:13.179721 [info ] [Thread-1 (]: 28 of 60 PASS not_null_int_step_month_matrix_kpi_name .......................... [[32mPASS[0m in 0.05s]
[0m03:35:13.180804 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m03:35:13.181713 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m03:35:13.182525 [info ] [Thread-1 (]: 29 of 60 START test not_null_int_step_month_matrix_month ....................... [RUN]
[0m03:35:13.183457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4, now test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c)
[0m03:35:13.183929 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m03:35:13.189448 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m03:35:13.190376 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m03:35:13.192870 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m03:35:13.193626 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m03:35:13.194085 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: BEGIN
[0m03:35:13.194550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.201899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:13.202508 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m03:35:13.203025 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."int_step_month_matrix"
where month is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.267896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m03:35:13.270009 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: ROLLBACK
[0m03:35:13.271124 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: Close
[0m03:35:13.272411 [info ] [Thread-1 (]: 29 of 60 PASS not_null_int_step_month_matrix_month ............................. [[32mPASS[0m in 0.09s]
[0m03:35:13.274548 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m03:35:13.277007 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:35:13.277955 [info ] [Thread-1 (]: 30 of 60 START test not_null_rep_sales_funnel_monthly_funnel_step .............. [RUN]
[0m03:35:13.278765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61)
[0m03:35:13.279288 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:35:13.287523 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:35:13.288793 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:35:13.294472 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:35:13.296052 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:35:13.296935 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: BEGIN
[0m03:35:13.297914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.309409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:35:13.310653 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m03:35:13.311559 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.313683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:13.316824 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: ROLLBACK
[0m03:35:13.318016 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: Close
[0m03:35:13.321729 [info ] [Thread-1 (]: 30 of 60 PASS not_null_rep_sales_funnel_monthly_funnel_step .................... [[32mPASS[0m in 0.04s]
[0m03:35:13.323304 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m03:35:13.325174 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:35:13.326145 [info ] [Thread-1 (]: 31 of 60 START test not_null_rep_sales_funnel_monthly_kpi_name ................. [RUN]
[0m03:35:13.327292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0)
[0m03:35:13.328756 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:35:13.343166 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:35:13.344813 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:35:13.350072 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:35:13.351669 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:35:13.353013 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: BEGIN
[0m03:35:13.355840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.371061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m03:35:13.374592 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m03:35:13.376343 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.384425 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m03:35:13.391139 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: ROLLBACK
[0m03:35:13.392375 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: Close
[0m03:35:13.396915 [info ] [Thread-1 (]: 31 of 60 PASS not_null_rep_sales_funnel_monthly_kpi_name ....................... [[32mPASS[0m in 0.07s]
[0m03:35:13.399275 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m03:35:13.400230 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m03:35:13.401171 [info ] [Thread-1 (]: 32 of 60 START test not_null_rep_sales_funnel_monthly_month .................... [RUN]
[0m03:35:13.402258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b)
[0m03:35:13.403047 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m03:35:13.411546 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m03:35:13.412590 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m03:35:13.417254 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m03:35:13.418371 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m03:35:13.419146 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: BEGIN
[0m03:35:13.419872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.432456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m03:35:13.433328 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m03:35:13.434181 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
where month is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.436155 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:13.438985 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: ROLLBACK
[0m03:35:13.440467 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: Close
[0m03:35:13.444672 [info ] [Thread-1 (]: 32 of 60 PASS not_null_rep_sales_funnel_monthly_month .......................... [[32mPASS[0m in 0.04s]
[0m03:35:13.447888 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m03:35:13.448779 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m03:35:13.449703 [info ] [Thread-1 (]: 33 of 60 START test not_null_stg_activity_activity_id .......................... [RUN]
[0m03:35:13.450777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m03:35:13.452012 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m03:35:13.460480 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m03:35:13.461487 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m03:35:13.465999 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m03:35:13.467020 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m03:35:13.470858 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m03:35:13.471669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.481556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m03:35:13.482067 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m03:35:13.482567 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.485446 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:13.487108 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m03:35:13.487746 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m03:35:13.488593 [info ] [Thread-1 (]: 33 of 60 PASS not_null_stg_activity_activity_id ................................ [[32mPASS[0m in 0.04s]
[0m03:35:13.489641 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m03:35:13.491654 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m03:35:13.492634 [info ] [Thread-1 (]: 34 of 60 START test not_null_stg_activity_assigned_to_user ..................... [RUN]
[0m03:35:13.493454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df)
[0m03:35:13.494006 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m03:35:13.500579 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m03:35:13.501623 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m03:35:13.504749 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m03:35:13.505507 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m03:35:13.505981 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: BEGIN
[0m03:35:13.506444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.513779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:13.514323 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m03:35:13.514799 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select assigned_to_user
from "postgres"."pipedrive_analytics"."stg_activity"
where assigned_to_user is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.524581 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m03:35:13.526286 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: ROLLBACK
[0m03:35:13.526938 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: Close
[0m03:35:13.527841 [info ] [Thread-1 (]: 34 of 60 PASS not_null_stg_activity_assigned_to_user ........................... [[32mPASS[0m in 0.03s]
[0m03:35:13.528870 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m03:35:13.529635 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m03:35:13.530465 [info ] [Thread-1 (]: 35 of 60 START test not_null_stg_activity_deal_id .............................. [RUN]
[0m03:35:13.531041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m03:35:13.531537 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m03:35:13.536825 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m03:35:13.538220 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m03:35:13.542103 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m03:35:13.543341 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m03:35:13.543824 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m03:35:13.544302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.551882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:13.552400 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m03:35:13.552873 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.562534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m03:35:13.564272 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m03:35:13.564976 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m03:35:13.565881 [info ] [Thread-1 (]: 35 of 60 PASS not_null_stg_activity_deal_id .................................... [[32mPASS[0m in 0.03s]
[0m03:35:13.567038 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m03:35:13.567818 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m03:35:13.568533 [info ] [Thread-1 (]: 36 of 60 START test not_null_stg_activity_done ................................. [RUN]
[0m03:35:13.569251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1)
[0m03:35:13.569761 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m03:35:13.575315 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m03:35:13.576537 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m03:35:13.580031 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m03:35:13.580863 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m03:35:13.581729 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: BEGIN
[0m03:35:13.582526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.590257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:13.590751 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m03:35:13.591236 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select done
from "postgres"."pipedrive_analytics"."stg_activity"
where done is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.610441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m03:35:13.613853 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: ROLLBACK
[0m03:35:13.615233 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: Close
[0m03:35:13.616587 [info ] [Thread-1 (]: 36 of 60 PASS not_null_stg_activity_done ....................................... [[32mPASS[0m in 0.05s]
[0m03:35:13.619511 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m03:35:13.622071 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m03:35:13.623359 [info ] [Thread-1 (]: 37 of 60 START test not_null_stg_activity_due_to_dt ............................ [RUN]
[0m03:35:13.625185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1, now test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989)
[0m03:35:13.626147 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m03:35:13.634875 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m03:35:13.636214 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m03:35:13.640878 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m03:35:13.642145 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m03:35:13.642890 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: BEGIN
[0m03:35:13.643865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.653203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:13.653703 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m03:35:13.654210 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select due_to_dt
from "postgres"."pipedrive_analytics"."stg_activity"
where due_to_dt is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.666316 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m03:35:13.668085 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: ROLLBACK
[0m03:35:13.668771 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: Close
[0m03:35:13.669667 [info ] [Thread-1 (]: 37 of 60 PASS not_null_stg_activity_due_to_dt .................................. [[32mPASS[0m in 0.04s]
[0m03:35:13.670695 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m03:35:13.671449 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m03:35:13.672324 [info ] [Thread-1 (]: 38 of 60 START test not_null_stg_activity_type ................................. [RUN]
[0m03:35:13.673030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989, now test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d)
[0m03:35:13.673522 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m03:35:13.679349 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m03:35:13.680068 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m03:35:13.682710 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m03:35:13.683445 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m03:35:13.685820 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: BEGIN
[0m03:35:13.686328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.694966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:13.695663 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m03:35:13.696486 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "postgres"."pipedrive_analytics"."stg_activity"
where type is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.707365 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m03:35:13.709134 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: ROLLBACK
[0m03:35:13.709961 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: Close
[0m03:35:13.710857 [info ] [Thread-1 (]: 38 of 60 PASS not_null_stg_activity_type ....................................... [[32mPASS[0m in 0.04s]
[0m03:35:13.711865 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m03:35:13.712871 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:35:13.713864 [info ] [Thread-1 (]: 39 of 60 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m03:35:13.714576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m03:35:13.715104 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:35:13.721485 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:35:13.722497 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:35:13.726907 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:35:13.728003 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:35:13.728802 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m03:35:13.729540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.737704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:13.738243 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m03:35:13.738739 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.740339 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:13.742040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m03:35:13.742724 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m03:35:13.743628 [info ] [Thread-1 (]: 39 of 60 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m03:35:13.744685 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m03:35:13.745441 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m03:35:13.746203 [info ] [Thread-1 (]: 40 of 60 START test not_null_stg_activity_types_is_active ...................... [RUN]
[0m03:35:13.746899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f)
[0m03:35:13.747396 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m03:35:13.753189 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m03:35:13.754170 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m03:35:13.757046 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m03:35:13.758063 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m03:35:13.758827 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: BEGIN
[0m03:35:13.759576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.768213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m03:35:13.768719 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m03:35:13.769221 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_active
from "postgres"."pipedrive_analytics"."stg_activity_types"
where is_active is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.770860 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:13.772609 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: ROLLBACK
[0m03:35:13.773304 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: Close
[0m03:35:13.774239 [info ] [Thread-1 (]: 40 of 60 PASS not_null_stg_activity_types_is_active ............................ [[32mPASS[0m in 0.03s]
[0m03:35:13.775316 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m03:35:13.776044 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m03:35:13.776931 [info ] [Thread-1 (]: 41 of 60 START test not_null_stg_activity_types_name ........................... [RUN]
[0m03:35:13.777578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f, now test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596)
[0m03:35:13.778058 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m03:35:13.784919 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m03:35:13.785669 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m03:35:13.788254 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m03:35:13.788988 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m03:35:13.789473 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: BEGIN
[0m03:35:13.789907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.808019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m03:35:13.809061 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m03:35:13.809896 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."pipedrive_analytics"."stg_activity_types"
where name is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.813012 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:13.817396 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: ROLLBACK
[0m03:35:13.820557 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: Close
[0m03:35:13.821801 [info ] [Thread-1 (]: 41 of 60 PASS not_null_stg_activity_types_name ................................. [[32mPASS[0m in 0.04s]
[0m03:35:13.824328 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m03:35:13.825192 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m03:35:13.825887 [info ] [Thread-1 (]: 42 of 60 START test not_null_stg_activity_types_type ........................... [RUN]
[0m03:35:13.826963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596, now test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d)
[0m03:35:13.827857 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m03:35:13.842770 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m03:35:13.843921 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m03:35:13.848694 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m03:35:13.849853 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m03:35:13.850672 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: BEGIN
[0m03:35:13.851430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.862335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:35:13.862853 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m03:35:13.863367 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "postgres"."pipedrive_analytics"."stg_activity_types"
where type is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.865057 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:13.867243 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: ROLLBACK
[0m03:35:13.868255 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: Close
[0m03:35:13.869681 [info ] [Thread-1 (]: 42 of 60 PASS not_null_stg_activity_types_type ................................. [[32mPASS[0m in 0.04s]
[0m03:35:13.873420 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m03:35:13.874302 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m03:35:13.875073 [info ] [Thread-1 (]: 43 of 60 START test not_null_stg_deal_changes_change_dt ........................ [RUN]
[0m03:35:13.876639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d, now test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35)
[0m03:35:13.878653 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m03:35:13.886976 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m03:35:13.888064 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m03:35:13.891236 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m03:35:13.892011 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m03:35:13.894467 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: BEGIN
[0m03:35:13.895003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.903223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:13.903726 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m03:35:13.904226 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.909289 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m03:35:13.911030 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: ROLLBACK
[0m03:35:13.911720 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: Close
[0m03:35:13.912639 [info ] [Thread-1 (]: 43 of 60 PASS not_null_stg_deal_changes_change_dt .............................. [[32mPASS[0m in 0.04s]
[0m03:35:13.913779 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m03:35:13.914645 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m03:35:13.915470 [info ] [Thread-1 (]: 44 of 60 START test not_null_stg_deal_changes_changed_field_key ................ [RUN]
[0m03:35:13.916418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35, now test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f)
[0m03:35:13.917177 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m03:35:13.926006 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m03:35:13.927058 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m03:35:13.931785 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m03:35:13.932688 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m03:35:13.933240 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: BEGIN
[0m03:35:13.934062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.942104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:13.942626 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m03:35:13.943140 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select changed_field_key
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where changed_field_key is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.949904 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m03:35:13.951662 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: ROLLBACK
[0m03:35:13.952358 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: Close
[0m03:35:13.953282 [info ] [Thread-1 (]: 44 of 60 PASS not_null_stg_deal_changes_changed_field_key ...................... [[32mPASS[0m in 0.04s]
[0m03:35:13.954350 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m03:35:13.955065 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m03:35:13.955904 [info ] [Thread-1 (]: 45 of 60 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m03:35:13.956694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m03:35:13.957207 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m03:35:13.964753 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m03:35:13.965806 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m03:35:13.968657 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m03:35:13.969410 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m03:35:13.969886 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m03:35:13.970344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:13.977797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:13.978324 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m03:35:13.978824 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:13.986228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m03:35:13.988825 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m03:35:13.989797 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m03:35:13.990892 [info ] [Thread-1 (]: 45 of 60 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m03:35:13.991970 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m03:35:13.995531 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m03:35:13.996310 [info ] [Thread-1 (]: 46 of 60 START test not_null_stg_deal_changes_new_value ........................ [RUN]
[0m03:35:13.997085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d)
[0m03:35:13.997945 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m03:35:14.005006 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m03:35:14.005742 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m03:35:14.008421 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m03:35:14.009167 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m03:35:14.009653 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: BEGIN
[0m03:35:14.010112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.017633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:14.018156 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m03:35:14.018634 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select new_value
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where new_value is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.024653 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m03:35:14.026576 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: ROLLBACK
[0m03:35:14.027229 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: Close
[0m03:35:14.028073 [info ] [Thread-1 (]: 46 of 60 PASS not_null_stg_deal_changes_new_value .............................. [[32mPASS[0m in 0.03s]
[0m03:35:14.029078 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m03:35:14.029967 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m03:35:14.030823 [info ] [Thread-1 (]: 47 of 60 START test not_null_stg_fields_field_id ............................... [RUN]
[0m03:35:14.031440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m03:35:14.031914 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m03:35:14.038278 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m03:35:14.039486 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m03:35:14.042757 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m03:35:14.043569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m03:35:14.044082 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: BEGIN
[0m03:35:14.044577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.051915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:14.052427 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m03:35:14.052899 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_id
from "postgres"."pipedrive_analytics"."stg_fields"
where field_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.055213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.056868 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: ROLLBACK
[0m03:35:14.057532 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: Close
[0m03:35:14.058372 [info ] [Thread-1 (]: 47 of 60 PASS not_null_stg_fields_field_id ..................................... [[32mPASS[0m in 0.03s]
[0m03:35:14.059358 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m03:35:14.060082 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m03:35:14.060811 [info ] [Thread-1 (]: 48 of 60 START test not_null_stg_fields_field_key .............................. [RUN]
[0m03:35:14.061493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m03:35:14.061974 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m03:35:14.067004 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m03:35:14.068078 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m03:35:14.070655 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m03:35:14.071378 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m03:35:14.073755 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m03:35:14.074263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.082389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:14.083199 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m03:35:14.083777 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.086777 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.088428 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m03:35:14.089071 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m03:35:14.089917 [info ] [Thread-1 (]: 48 of 60 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.03s]
[0m03:35:14.091061 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m03:35:14.091838 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m03:35:14.092587 [info ] [Thread-1 (]: 49 of 60 START test not_null_stg_fields_field_name ............................. [RUN]
[0m03:35:14.093184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd)
[0m03:35:14.093638 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m03:35:14.099362 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m03:35:14.101019 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m03:35:14.104870 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m03:35:14.105967 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m03:35:14.106879 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: BEGIN
[0m03:35:14.107364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.115613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m03:35:14.116141 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m03:35:14.116632 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_name
from "postgres"."pipedrive_analytics"."stg_fields"
where field_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.119021 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.120751 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: ROLLBACK
[0m03:35:14.121432 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: Close
[0m03:35:14.122350 [info ] [Thread-1 (]: 49 of 60 PASS not_null_stg_fields_field_name ................................... [[32mPASS[0m in 0.03s]
[0m03:35:14.123378 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m03:35:14.124145 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m03:35:14.124961 [info ] [Thread-1 (]: 50 of 60 START test not_null_stg_stages_funnel_step ............................ [RUN]
[0m03:35:14.125605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd, now test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e)
[0m03:35:14.126075 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m03:35:14.136183 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m03:35:14.137395 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m03:35:14.141830 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m03:35:14.142892 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m03:35:14.143674 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: BEGIN
[0m03:35:14.144367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.157440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m03:35:14.158478 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m03:35:14.159419 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."stg_stages"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.161786 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.164454 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: ROLLBACK
[0m03:35:14.165458 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: Close
[0m03:35:14.168711 [info ] [Thread-1 (]: 50 of 60 PASS not_null_stg_stages_funnel_step .................................. [[32mPASS[0m in 0.04s]
[0m03:35:14.170875 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m03:35:14.171932 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m03:35:14.172877 [info ] [Thread-1 (]: 51 of 60 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m03:35:14.173874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m03:35:14.174848 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m03:35:14.183425 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m03:35:14.184477 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m03:35:14.188922 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m03:35:14.189999 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m03:35:14.190817 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m03:35:14.191606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.202327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:35:14.202971 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m03:35:14.203699 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.205819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:14.208390 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m03:35:14.209506 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m03:35:14.212640 [info ] [Thread-1 (]: 51 of 60 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.04s]
[0m03:35:14.216014 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m03:35:14.218237 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m03:35:14.219640 [info ] [Thread-1 (]: 52 of 60 START test not_null_stg_stages_stage_name ............................. [RUN]
[0m03:35:14.220791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25)
[0m03:35:14.221592 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m03:35:14.227603 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m03:35:14.228363 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m03:35:14.230949 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m03:35:14.231691 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m03:35:14.232167 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: BEGIN
[0m03:35:14.232623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.239756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:35:14.240273 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m03:35:14.240750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_name
from "postgres"."pipedrive_analytics"."stg_stages"
where stage_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.242330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:14.243922 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: ROLLBACK
[0m03:35:14.244606 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: Close
[0m03:35:14.245448 [info ] [Thread-1 (]: 52 of 60 PASS not_null_stg_stages_stage_name ................................... [[32mPASS[0m in 0.02s]
[0m03:35:14.247995 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m03:35:14.248794 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m03:35:14.249656 [info ] [Thread-1 (]: 53 of 60 START test not_null_stg_users_user_email .............................. [RUN]
[0m03:35:14.250586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25, now test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f)
[0m03:35:14.251512 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m03:35:14.259046 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m03:35:14.260586 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m03:35:14.265225 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m03:35:14.266525 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m03:35:14.270241 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: BEGIN
[0m03:35:14.271051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.285135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m03:35:14.285861 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m03:35:14.286577 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_email
from "postgres"."pipedrive_analytics"."stg_users"
where user_email is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.288913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:14.291487 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: ROLLBACK
[0m03:35:14.292430 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: Close
[0m03:35:14.293753 [info ] [Thread-1 (]: 53 of 60 PASS not_null_stg_users_user_email .................................... [[32mPASS[0m in 0.04s]
[0m03:35:14.295034 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m03:35:14.297952 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m03:35:14.299744 [info ] [Thread-1 (]: 54 of 60 START test not_null_stg_users_user_id ................................. [RUN]
[0m03:35:14.301769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m03:35:14.302606 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m03:35:14.310439 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m03:35:14.311518 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m03:35:14.316049 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m03:35:14.317129 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m03:35:14.317906 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m03:35:14.318669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.330170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:35:14.330977 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m03:35:14.331798 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.333928 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m03:35:14.336647 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m03:35:14.337656 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m03:35:14.338795 [info ] [Thread-1 (]: 54 of 60 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.04s]
[0m03:35:14.342211 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m03:35:14.343664 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m03:35:14.344588 [info ] [Thread-1 (]: 55 of 60 START test not_null_stg_users_user_modified_at ........................ [RUN]
[0m03:35:14.345620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0)
[0m03:35:14.346544 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m03:35:14.356901 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m03:35:14.357971 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m03:35:14.363368 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m03:35:14.364463 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m03:35:14.365303 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: BEGIN
[0m03:35:14.366058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.379309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m03:35:14.380075 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m03:35:14.383333 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_modified_at
from "postgres"."pipedrive_analytics"."stg_users"
where user_modified_at is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.387217 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m03:35:14.390722 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: ROLLBACK
[0m03:35:14.391733 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: Close
[0m03:35:14.393729 [info ] [Thread-1 (]: 55 of 60 PASS not_null_stg_users_user_modified_at .............................. [[32mPASS[0m in 0.05s]
[0m03:35:14.397494 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m03:35:14.398568 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m03:35:14.399470 [info ] [Thread-1 (]: 56 of 60 START test not_null_stg_users_user_name ............................... [RUN]
[0m03:35:14.400674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m03:35:14.401517 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m03:35:14.410400 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m03:35:14.411487 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m03:35:14.418273 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m03:35:14.419858 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m03:35:14.420688 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m03:35:14.421452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.433743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m03:35:14.434554 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m03:35:14.435593 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m03:35:14.438104 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.440916 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m03:35:14.441911 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m03:35:14.445590 [info ] [Thread-1 (]: 56 of 60 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.04s]
[0m03:35:14.447747 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m03:35:14.448671 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m03:35:14.449668 [info ] [Thread-1 (]: 57 of 60 START test unique_stg_activity_activity_id ............................ [RUN]
[0m03:35:14.450891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m03:35:14.451674 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m03:35:14.463399 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m03:35:14.464422 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m03:35:14.468836 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m03:35:14.469884 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m03:35:14.470709 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m03:35:14.471443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.483116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m03:35:14.483921 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m03:35:14.484738 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:35:14.507068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m03:35:14.510136 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m03:35:14.511165 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m03:35:14.514796 [info ] [Thread-1 (]: 57 of 60 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.06s]
[0m03:35:14.517741 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m03:35:14.518713 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:35:14.519957 [info ] [Thread-1 (]: 58 of 60 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m03:35:14.521327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m03:35:14.522177 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:35:14.530792 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:35:14.531931 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:35:14.539853 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:35:14.541028 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:35:14.541868 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m03:35:14.542642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.554896 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m03:35:14.555689 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m03:35:14.556534 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:35:14.559379 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.563535 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m03:35:14.564791 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m03:35:14.567750 [info ] [Thread-1 (]: 58 of 60 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.05s]
[0m03:35:14.570521 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m03:35:14.571521 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m03:35:14.572417 [info ] [Thread-1 (]: 59 of 60 START test unique_stg_stages_stage_id ................................. [RUN]
[0m03:35:14.573442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m03:35:14.574471 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m03:35:14.582641 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m03:35:14.583754 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m03:35:14.588343 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m03:35:14.589449 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m03:35:14.590219 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m03:35:14.590925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.602687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m03:35:14.603502 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m03:35:14.604305 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:35:14.607078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m03:35:14.609869 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m03:35:14.611473 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m03:35:14.614926 [info ] [Thread-1 (]: 59 of 60 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.04s]
[0m03:35:14.617477 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m03:35:14.618408 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m03:35:14.619327 [info ] [Thread-1 (]: 60 of 60 START test unique_stg_users_user_id ................................... [RUN]
[0m03:35:14.620421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m03:35:14.621229 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m03:35:14.629416 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m03:35:14.630567 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m03:35:14.635901 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m03:35:14.643902 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m03:35:14.647320 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m03:35:14.648118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:35:14.664866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m03:35:14.665836 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m03:35:14.666670 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m03:35:14.670324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m03:35:14.673295 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m03:35:14.674306 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m03:35:14.677762 [info ] [Thread-1 (]: 60 of 60 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.06s]
[0m03:35:14.680122 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m03:35:14.682778 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:14.683553 [debug] [MainThread]: On master: BEGIN
[0m03:35:14.685327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:35:14.699645 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m03:35:14.700876 [debug] [MainThread]: On master: COMMIT
[0m03:35:14.701623 [debug] [MainThread]: Using postgres connection "master"
[0m03:35:14.702351 [debug] [MainThread]: On master: COMMIT
[0m03:35:14.703214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:35:14.703903 [debug] [MainThread]: On master: Close
[0m03:35:14.707261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:35:14.708177 [debug] [MainThread]: Connection 'test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m03:35:14.709070 [info ] [MainThread]: 
[0m03:35:14.710014 [info ] [MainThread]: Finished running 60 data tests in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m03:35:14.726207 [debug] [MainThread]: Command end result
[0m03:35:14.796627 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m03:35:14.801245 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m03:35:14.818476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m03:35:14.819451 [info ] [MainThread]: 
[0m03:35:14.820514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:35:14.821416 [info ] [MainThread]: 
[0m03:35:14.822278 [info ] [MainThread]: Done. PASS=60 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=60
[0m03:35:14.824333 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.9427347, "process_in_blocks": "0", "process_kernel_time": 0.354044, "process_mem_max_rss": "142020", "process_out_blocks": "4976", "process_user_time": 5.471331}
[0m03:35:14.825521 [debug] [MainThread]: Command `dbt test` succeeded at 03:35:14.825355 after 4.94 seconds
[0m03:35:14.826511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ac2275c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8ac276180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac8abe85850>]}
[0m03:35:14.827355 [debug] [MainThread]: Flushing usage events
[0m03:35:15.216307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:30:53.306171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa283c2aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa28392d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa284e13560>]}


============================== 04:30:53.309761 | 8013d3e6-efa0-4934-8c8f-4344e959774a ==============================
[0m04:30:53.309761 [info ] [MainThread]: Running with dbt=1.10.0
[0m04:30:53.310628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:30:53.445069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8013d3e6-efa0-4934-8c8f-4344e959774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa285662900>]}
[0m04:30:53.474288 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lql9unr2'
[0m04:30:53.475249 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:30:53.565063 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:30:53.567223 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:30:53.625705 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:30:53.631304 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:30:53.865275 [info ] [MainThread]: Installed from version 1.3.3
[0m04:30:53.866455 [info ] [MainThread]: Up to date!
[0m04:30:53.867467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8013d3e6-efa0-4934-8c8f-4344e959774a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2839b5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa282de5490>]}
[0m04:30:53.869881 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6369159, "process_in_blocks": "0", "process_kernel_time": 0.172021, "process_mem_max_rss": "118604", "process_out_blocks": "2296", "process_user_time": 2.824934}
[0m04:30:53.871536 [debug] [MainThread]: Command `dbt deps` succeeded at 04:30:53.871296 after 0.64 seconds
[0m04:30:53.875388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa282daf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa282ec98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2833fca40>]}
[0m04:30:53.876183 [debug] [MainThread]: Flushing usage events
[0m04:30:54.281018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:31:03.124672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e543ad95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e54410d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e54410c110>]}


============================== 04:31:03.129226 | 2683c012-db17-4293-97ac-1fe95a1a8911 ==============================
[0m04:31:03.129226 [info ] [MainThread]: Running with dbt=1.10.0
[0m04:31:03.130264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m04:31:03.312075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e543a3b9b0>]}
[0m04:31:03.394452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e54419b2c0>]}
[0m04:31:03.395641 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m04:31:03.555233 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m04:31:03.702824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:03.703436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:03.762215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e543a39070>]}
[0m04:31:03.874410 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m04:31:03.884125 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m04:31:03.912219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e54197c6b0>]}
[0m04:31:03.913359 [info ] [MainThread]: Found 1 seed, 12 models, 60 data tests, 6 sources, 550 macros
[0m04:31:03.914194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e54259fb30>]}
[0m04:31:03.919564 [info ] [MainThread]: 
[0m04:31:03.921503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:31:03.924941 [info ] [MainThread]: 
[0m04:31:03.926872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:31:03.930747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:31:04.004266 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:31:04.005274 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:31:04.005893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:04.025910 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m04:31:04.028573 [debug] [ThreadPool]: On list_postgres: Close
[0m04:31:04.037968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_pipedrive_analytics)
[0m04:31:04.049219 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m04:31:04.049979 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m04:31:04.050720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:04.065200 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m04:31:04.065950 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m04:31:04.066780 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m04:31:04.071373 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m04:31:04.074178 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m04:31:04.075009 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m04:31:04.094462 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:04.095407 [debug] [MainThread]: On master: BEGIN
[0m04:31:04.096075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:04.111789 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m04:31:04.112667 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:04.113540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m04:31:04.118638 [debug] [MainThread]: SQL status: SELECT 14 in 0.004 seconds
[0m04:31:04.126223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e542904c50>]}
[0m04:31:04.127312 [debug] [MainThread]: On master: ROLLBACK
[0m04:31:04.128288 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:04.129626 [debug] [MainThread]: On master: BEGIN
[0m04:31:04.131343 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:31:04.132054 [debug] [MainThread]: On master: COMMIT
[0m04:31:04.132799 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:04.133618 [debug] [MainThread]: On master: COMMIT
[0m04:31:04.135362 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:31:04.135945 [debug] [MainThread]: On master: Close
[0m04:31:04.139788 [debug] [Thread-1 (]: Began running node seed.enpal_assessment_project.funnel_steps
[0m04:31:04.140695 [info ] [Thread-1 (]: 1 of 1 START seed file pipedrive_analytics.funnel_steps ........................ [RUN]
[0m04:31:04.141661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now seed.enpal_assessment_project.funnel_steps)
[0m04:31:04.142228 [debug] [Thread-1 (]: Began compiling node seed.enpal_assessment_project.funnel_steps
[0m04:31:04.142735 [debug] [Thread-1 (]: Began executing node seed.enpal_assessment_project.funnel_steps
[0m04:31:04.284812 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:04.285528 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: BEGIN
[0m04:31:04.286028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:04.294230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:04.294781 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:04.295292 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "seed.enpal_assessment_project.funnel_steps"} */
truncate table "postgres"."pipedrive_analytics"."funnel_steps"
[0m04:31:04.297013 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m04:31:04.322730 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:04.323264 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: 
          insert into "postgres"."pipedrive_analytics"."funnel_steps" ("kpi_name", "funnel_step", "step_order") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m04:31:04.324480 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.001 seconds
[0m04:31:04.333128 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.enpal_assessment_project.funnel_steps"
[0m04:31:04.347991 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: COMMIT
[0m04:31:04.348741 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:04.349483 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: COMMIT
[0m04:31:04.351350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:04.353320 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: Close
[0m04:31:04.355781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2683c012-db17-4293-97ac-1fe95a1a8911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e546257320>]}
[0m04:31:04.356807 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file pipedrive_analytics.funnel_steps .................... [[32mINSERT 11[0m in 0.21s]
[0m04:31:04.357691 [debug] [Thread-1 (]: Finished running node seed.enpal_assessment_project.funnel_steps
[0m04:31:04.359149 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:04.359603 [debug] [MainThread]: On master: BEGIN
[0m04:31:04.360001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:04.369098 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m04:31:04.369554 [debug] [MainThread]: On master: COMMIT
[0m04:31:04.370033 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:04.370443 [debug] [MainThread]: On master: COMMIT
[0m04:31:04.371004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:31:04.371457 [debug] [MainThread]: On master: Close
[0m04:31:04.372007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:04.372653 [debug] [MainThread]: Connection 'seed.enpal_assessment_project.funnel_steps' was properly closed.
[0m04:31:04.373308 [info ] [MainThread]: 
[0m04:31:04.373954 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m04:31:04.374942 [debug] [MainThread]: Command end result
[0m04:31:04.421604 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m04:31:04.426926 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m04:31:04.436514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m04:31:04.437303 [info ] [MainThread]: 
[0m04:31:04.438343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:04.439167 [info ] [MainThread]: 
[0m04:31:04.440016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:31:04.444417 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.3747838, "process_in_blocks": "0", "process_kernel_time": 0.266507, "process_mem_max_rss": "140100", "process_out_blocks": "3488", "process_user_time": 3.704248}
[0m04:31:04.445741 [debug] [MainThread]: Command `dbt seed` succeeded at 04:31:04.445578 after 1.38 seconds
[0m04:31:04.446862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e5444d8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e544699460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e544824950>]}
[0m04:31:04.448201 [debug] [MainThread]: Flushing usage events
[0m04:31:04.816738 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:31:11.742229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa1470ecb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa146cd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa146550860>]}


============================== 04:31:11.746060 | 24ae818a-9062-4a3c-a34e-7631d8b171a5 ==============================
[0m04:31:11.746060 [info ] [MainThread]: Running with dbt=1.10.0
[0m04:31:11.746879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m04:31:11.949794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa146474650>]}
[0m04:31:12.056742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa1489c7500>]}
[0m04:31:12.058636 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m04:31:12.253487 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m04:31:12.389294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:12.389880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:12.446876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa145544bc0>]}
[0m04:31:12.556003 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m04:31:12.565181 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m04:31:12.599394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa144131520>]}
[0m04:31:12.600160 [info ] [MainThread]: Found 1 seed, 12 models, 60 data tests, 6 sources, 550 macros
[0m04:31:12.606269 [info ] [MainThread]: 
[0m04:31:12.606927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:31:12.607501 [info ] [MainThread]: 
[0m04:31:12.608462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:31:12.614479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m04:31:12.651010 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m04:31:12.651690 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m04:31:12.652399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:12.664237 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m04:31:12.665730 [debug] [ThreadPool]: On list_postgres: Close
[0m04:31:12.668695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m04:31:12.831015 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m04:31:12.831740 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m04:31:12.832222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:12.840335 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m04:31:12.840846 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m04:31:12.841324 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m04:31:12.845059 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m04:31:12.848039 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m04:31:12.848980 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m04:31:12.858267 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:12.858761 [debug] [MainThread]: On master: BEGIN
[0m04:31:12.859192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:12.867005 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m04:31:12.867494 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:12.867963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m04:31:12.871669 [debug] [MainThread]: SQL status: SELECT 14 in 0.003 seconds
[0m04:31:12.874586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa14411dc70>]}
[0m04:31:12.875212 [debug] [MainThread]: On master: ROLLBACK
[0m04:31:12.875857 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:12.876305 [debug] [MainThread]: On master: BEGIN
[0m04:31:12.877011 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:31:12.877476 [debug] [MainThread]: On master: COMMIT
[0m04:31:12.877892 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:12.878306 [debug] [MainThread]: On master: COMMIT
[0m04:31:12.878858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:31:12.879299 [debug] [MainThread]: On master: Close
[0m04:31:12.882409 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m04:31:12.883140 [info ] [Thread-1 (]: 1 of 73 START sql view model pipedrive_analytics.stg_activity .................. [RUN]
[0m04:31:12.883840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m04:31:12.884363 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m04:31:12.895378 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m04:31:12.896309 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m04:31:12.930679 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m04:31:12.931785 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m04:31:12.932355 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: BEGIN
[0m04:31:12.932815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:12.943680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m04:31:12.944779 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m04:31:12.945344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            activity_id,
                            type,
                            assigned_to_user,
                            deal_id,
                            done,
                            CAST(due_to AS TIMESTAMP) AS due_to_dt,
                            ROW_NUMBER() OVER (PARTITION BY activity_id ORDER BY due_to) AS row_num 

                    FROM "postgres"."public"."activity"
)

SELECT 
       activity_id,
       type,
       assigned_to_user,
       deal_id,
       done,
       due_to_dt
FROM transformed
WHERE row_num = 1
  );
[0m04:31:12.948014 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:31:12.955211 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m04:31:12.955738 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m04:31:12.956742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:12.960009 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m04:31:12.960513 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m04:31:12.961533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:31:12.977984 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m04:31:12.978587 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m04:31:12.979063 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m04:31:12.989397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m04:31:12.997636 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity__dbt_backup"
[0m04:31:13.002972 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m04:31:13.003517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m04:31:13.006940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m04:31:13.009631 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m04:31:13.012136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa147302030>]}
[0m04:31:13.013241 [info ] [Thread-1 (]: 1 of 73 OK created sql view model pipedrive_analytics.stg_activity ............. [[32mCREATE VIEW[0m in 0.13s]
[0m04:31:13.014106 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m04:31:13.014675 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m04:31:13.015419 [info ] [Thread-1 (]: 2 of 73 START sql view model pipedrive_analytics.stg_activity_types ............ [RUN]
[0m04:31:13.016306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m04:31:13.016802 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m04:31:13.020611 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.021637 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m04:31:13.026576 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.027364 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.027835 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: BEGIN
[0m04:31:13.028302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.036270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.036778 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.037300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                 SELECT 
                         id   AS activity_type_id,
                         name,
                         type,
                         CASE 
                       		 WHEN name= 'Sales Call 1' THEN 'Step 2.1'
                       		 WHEN name= 'Sales Call 2' THEN 'Step 3.1'
                  	     END 				AS funnel_step,
                         CASE WHEN active= 'Yes' THEN TRUE ELSE FALSE END AS is_active
                            
                  FROM "postgres"."public"."activity_types"
)

SELECT *
FROM transformed
  );
[0m04:31:13.042501 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m04:31:13.046175 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.046668 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m04:31:13.047583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.050684 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.051196 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m04:31:13.052065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.053982 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m04:31:13.054482 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.054946 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m04:31:13.056688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:13.060529 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m04:31:13.062263 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m04:31:13.063223 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m04:31:13.065084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:31:13.066598 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m04:31:13.067524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa14550a5d0>]}
[0m04:31:13.068668 [info ] [Thread-1 (]: 2 of 73 OK created sql view model pipedrive_analytics.stg_activity_types ....... [[32mCREATE VIEW[0m in 0.05s]
[0m04:31:13.070004 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m04:31:13.070646 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m04:31:13.071561 [info ] [Thread-1 (]: 3 of 73 START sql view model pipedrive_analytics.stg_deal_changes .............. [RUN]
[0m04:31:13.072270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m04:31:13.072752 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m04:31:13.076440 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.077703 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m04:31:13.082405 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.083203 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.083694 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: BEGIN
[0m04:31:13.084161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.091847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.092360 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.092848 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            deal_id,
                            CAST(change_time AS TIMESTAMP) change_dt,
                            changed_field_key,
                            new_value,
                            row_number() OVER (
                                PARTITION BY deal_id, changed_field_key, new_value,  change_time) AS rn

                    FROM "postgres"."public"."deal_changes"
)

SELECT 
      deal_id,
      change_dt,
      changed_field_key,
      new_value

FROM transformed
WHERE rn = 1
  );
[0m04:31:13.095192 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:31:13.098563 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.099328 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m04:31:13.101000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:31:13.104005 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.104517 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m04:31:13.105336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.107225 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m04:31:13.107720 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.108195 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m04:31:13.109707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:13.114939 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m04:31:13.116126 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:13.116757 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m04:31:13.120256 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m04:31:13.122421 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m04:31:13.123509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa1418188c0>]}
[0m04:31:13.124719 [info ] [Thread-1 (]: 3 of 73 OK created sql view model pipedrive_analytics.stg_deal_changes ......... [[32mCREATE VIEW[0m in 0.05s]
[0m04:31:13.125708 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m04:31:13.127227 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m04:31:13.128438 [info ] [Thread-1 (]: 4 of 73 START sql view model pipedrive_analytics.stg_fields .................... [RUN]
[0m04:31:13.129148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m04:31:13.129617 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m04:31:13.133208 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m04:31:13.134299 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m04:31:13.138804 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_fields"
[0m04:31:13.139587 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m04:31:13.140055 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: BEGIN
[0m04:31:13.140530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.147955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.148522 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m04:31:13.149043 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */

  create view "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp"
    
    
  as (
    

WITH

raw AS (
        SELECT 
              id          AS field_id,
              field_key,
              name        AS field_name,
              field_value_options

        FROM "postgres"."public"."fields"
)

, base AS (
            SELECT
                  field_id,
                  field_key,
                  field_value_options
                  
            FROM raw
            WHERE field_value_options IS NOT NULL
)

, exploded AS (
                SELECT
                      b.field_id,
                      b.field_key,
                      e.elem->>'id'    AS option_id,
                      e.elem->>'label' AS option_label

                FROM base b
                CROSS JOIN lateral
                    jsonb_array_elements(b.field_value_options) WITH ordinality AS e(elem, ord)
)

, transformed AS (
                    SELECT
                          r.field_id,
                          r.field_key,
                          r.field_name,
                          CASE
                              WHEN e.option_id ~ '^\d+$' THEN e.option_id::int
                              ELSE NULL
                          END AS option_id,
                          e.option_label
                        
                    FROM raw r
                    LEFT JOIN exploded e    USING (field_id)
)
SELECT
        *
FROM transformed
ORDER BY field_id, 
         option_id
  );
[0m04:31:13.151700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:31:13.154851 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m04:31:13.155363 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields" rename to "stg_fields__dbt_backup"
[0m04:31:13.156322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.159285 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m04:31:13.159773 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
alter table "postgres"."pipedrive_analytics"."stg_fields__dbt_tmp" rename to "stg_fields"
[0m04:31:13.160677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.162586 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m04:31:13.163072 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m04:31:13.163555 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: COMMIT
[0m04:31:13.164981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:13.167700 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_fields__dbt_backup"
[0m04:31:13.168758 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_fields"
[0m04:31:13.169575 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_fields"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_fields__dbt_backup" cascade
[0m04:31:13.172351 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m04:31:13.174446 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_fields: Close
[0m04:31:13.175556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa143c359a0>]}
[0m04:31:13.176672 [info ] [Thread-1 (]: 4 of 73 OK created sql view model pipedrive_analytics.stg_fields ............... [[32mCREATE VIEW[0m in 0.05s]
[0m04:31:13.177686 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m04:31:13.178489 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m04:31:13.179212 [info ] [Thread-1 (]: 5 of 73 START sql view model pipedrive_analytics.stg_stages .................... [RUN]
[0m04:31:13.180035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m04:31:13.180540 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m04:31:13.184398 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m04:31:13.185635 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m04:31:13.189816 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m04:31:13.190613 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m04:31:13.191396 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: BEGIN
[0m04:31:13.192130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.200764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:13.201288 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m04:31:13.201783 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

WITH 

transformed AS (
                    SELECT 
                            stage_id,
                            stage_name,
                            CASE 
	                            WHEN stage_name= 'Lead Generation'              THEN 'Step 1'
	                            WHEN stage_name= 'Qualified lead'               THEN 'Step 2'
	                            WHEN stage_name= 'Needs Assessment'             THEN 'Step 3'
	                            WHEN stage_name= 'Proposal/Quote Preparation'   THEN 'Step 4'
	                            WHEN stage_name= 'Negotiation'                  THEN 'Step 5'
	                            WHEN stage_name= 'Closing'                      THEN 'Step 6'
	                            WHEN stage_name= 'Implementation/Onboarding'    THEN 'Step 7'
	                            WHEN stage_name= 'Follow-up/Customer Success'   THEN 'Step 8'
	                            WHEN stage_name= 'Renewal/Expansion'            THEN 'Step 9'
                            END AS funnel_step

                    FROM "postgres"."public"."stages"
)

SELECT *
FROM transformed
  );
[0m04:31:13.204209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:31:13.207303 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m04:31:13.207791 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m04:31:13.208694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.213257 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m04:31:13.213755 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m04:31:13.214636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.216481 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m04:31:13.216973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m04:31:13.217452 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m04:31:13.218838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:13.221215 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_stages__dbt_backup"
[0m04:31:13.222333 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m04:31:13.222853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m04:31:13.224593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:31:13.226682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m04:31:13.227792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa141823800>]}
[0m04:31:13.229103 [info ] [Thread-1 (]: 5 of 73 OK created sql view model pipedrive_analytics.stg_stages ............... [[32mCREATE VIEW[0m in 0.05s]
[0m04:31:13.230555 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m04:31:13.231307 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m04:31:13.232134 [info ] [Thread-1 (]: 6 of 73 START sql view model pipedrive_analytics.stg_users ..................... [RUN]
[0m04:31:13.233406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m04:31:13.234251 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m04:31:13.238447 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m04:31:13.239433 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m04:31:13.243207 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m04:31:13.243973 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m04:31:13.244482 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: BEGIN
[0m04:31:13.244937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.252395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.252896 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m04:31:13.253397 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with 

transformed as (

                SELECT 
                      id          as user_id,
                      name        as user_name,
                      email       as user_email,
                      modified    as user_modified_at

                FROM "postgres"."public"."users"
)

SELECT 
      *
FROM transformed
  );
[0m04:31:13.255168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m04:31:13.258136 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m04:31:13.258627 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m04:31:13.259453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.262331 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m04:31:13.262817 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m04:31:13.263624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:13.265443 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m04:31:13.265928 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m04:31:13.266419 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m04:31:13.267808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:13.270305 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."stg_users__dbt_backup"
[0m04:31:13.271295 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m04:31:13.271799 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m04:31:13.273473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:31:13.275663 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m04:31:13.276590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa1449f86e0>]}
[0m04:31:13.277724 [info ] [Thread-1 (]: 6 of 73 OK created sql view model pipedrive_analytics.stg_users ................ [[32mCREATE VIEW[0m in 0.04s]
[0m04:31:13.278838 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m04:31:13.279716 [debug] [Thread-1 (]: Began running node seed.enpal_assessment_project.funnel_steps
[0m04:31:13.280698 [info ] [Thread-1 (]: 7 of 73 START seed file pipedrive_analytics.funnel_steps ....................... [RUN]
[0m04:31:13.282224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now seed.enpal_assessment_project.funnel_steps)
[0m04:31:13.283079 [debug] [Thread-1 (]: Began compiling node seed.enpal_assessment_project.funnel_steps
[0m04:31:13.283984 [debug] [Thread-1 (]: Began executing node seed.enpal_assessment_project.funnel_steps
[0m04:31:13.314729 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:13.315307 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: BEGIN
[0m04:31:13.315790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.323551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.324059 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:13.324555 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "seed.enpal_assessment_project.funnel_steps"} */
truncate table "postgres"."pipedrive_analytics"."funnel_steps"
[0m04:31:13.326597 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.001 seconds
[0m04:31:13.357591 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:13.358165 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: 
          insert into "postgres"."pipedrive_analytics"."funnel_steps" ("kpi_name", "funnel_step", "step_order") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)
      ...
[0m04:31:13.359320 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.001 seconds
[0m04:31:13.364999 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.enpal_assessment_project.funnel_steps"
[0m04:31:13.367193 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: COMMIT
[0m04:31:13.367723 [debug] [Thread-1 (]: Using postgres connection "seed.enpal_assessment_project.funnel_steps"
[0m04:31:13.368206 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: COMMIT
[0m04:31:13.369889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:13.370791 [debug] [Thread-1 (]: On seed.enpal_assessment_project.funnel_steps: Close
[0m04:31:13.371703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa14189f7d0>]}
[0m04:31:13.372702 [info ] [Thread-1 (]: 7 of 73 OK loaded seed file pipedrive_analytics.funnel_steps ................... [[32mINSERT 11[0m in 0.09s]
[0m04:31:13.374407 [debug] [Thread-1 (]: Finished running node seed.enpal_assessment_project.funnel_steps
[0m04:31:13.375532 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:13.376425 [info ] [Thread-1 (]: 8 of 73 START test accepted_values_stg_activity_done__True__False .............. [RUN]
[0m04:31:13.377063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.enpal_assessment_project.funnel_steps, now test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052)
[0m04:31:13.377653 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:13.391761 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m04:31:13.392546 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:13.418449 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m04:31:13.420024 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m04:31:13.420933 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: BEGIN
[0m04:31:13.421756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.434520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m04:31:13.435320 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m04:31:13.436197 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        done as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."stg_activity"
    group by done

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m04:31:13.449704 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m04:31:13.453207 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: ROLLBACK
[0m04:31:13.453890 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052: Close
[0m04:31:13.454828 [info ] [Thread-1 (]: 8 of 73 PASS accepted_values_stg_activity_done__True__False .................... [[32mPASS[0m in 0.08s]
[0m04:31:13.455855 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:13.456617 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:13.457331 [info ] [Thread-1 (]: 9 of 73 START test not_null_stg_activity_activity_id ........................... [RUN]
[0m04:31:13.458157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m04:31:13.458637 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:13.467241 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m04:31:13.468019 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:13.470751 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m04:31:13.471541 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m04:31:13.472029 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: BEGIN
[0m04:31:13.472487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.479976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.480486 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m04:31:13.480961 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_id
from "postgres"."pipedrive_analytics"."stg_activity"
where activity_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.483830 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:31:13.485516 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: ROLLBACK
[0m04:31:13.486183 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5: Close
[0m04:31:13.487035 [info ] [Thread-1 (]: 9 of 73 PASS not_null_stg_activity_activity_id ................................. [[32mPASS[0m in 0.03s]
[0m04:31:13.488249 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:13.488968 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:13.489740 [info ] [Thread-1 (]: 10 of 73 START test not_null_stg_activity_assigned_to_user ..................... [RUN]
[0m04:31:13.490347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df)
[0m04:31:13.490814 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:13.495871 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m04:31:13.497143 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:13.499846 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m04:31:13.500696 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m04:31:13.501466 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: BEGIN
[0m04:31:13.502218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.510793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:13.511316 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m04:31:13.511801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select assigned_to_user
from "postgres"."pipedrive_analytics"."stg_activity"
where assigned_to_user is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.523698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m04:31:13.525407 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: ROLLBACK
[0m04:31:13.526078 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df: Close
[0m04:31:13.527000 [info ] [Thread-1 (]: 10 of 73 PASS not_null_stg_activity_assigned_to_user ........................... [[32mPASS[0m in 0.04s]
[0m04:31:13.528050 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:13.528808 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:13.529517 [info ] [Thread-1 (]: 11 of 73 START test not_null_stg_activity_deal_id .............................. [RUN]
[0m04:31:13.530211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m04:31:13.530673 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:13.536701 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m04:31:13.538157 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:13.541774 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m04:31:13.542576 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m04:31:13.543062 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: BEGIN
[0m04:31:13.543526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.550914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.551412 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m04:31:13.553563 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."stg_activity"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.562948 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m04:31:13.564598 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: ROLLBACK
[0m04:31:13.565243 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252: Close
[0m04:31:13.566063 [info ] [Thread-1 (]: 11 of 73 PASS not_null_stg_activity_deal_id .................................... [[32mPASS[0m in 0.04s]
[0m04:31:13.567364 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:13.568188 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:13.568813 [info ] [Thread-1 (]: 12 of 73 START test not_null_stg_activity_done ................................. [RUN]
[0m04:31:13.569426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1)
[0m04:31:13.569902 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:13.575197 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m04:31:13.576319 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:13.578976 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m04:31:13.579763 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m04:31:13.580251 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: BEGIN
[0m04:31:13.580723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.588005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.588498 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m04:31:13.588960 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select done
from "postgres"."pipedrive_analytics"."stg_activity"
where done is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.602999 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m04:31:13.605073 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: ROLLBACK
[0m04:31:13.605770 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1: Close
[0m04:31:13.606664 [info ] [Thread-1 (]: 12 of 73 PASS not_null_stg_activity_done ....................................... [[32mPASS[0m in 0.04s]
[0m04:31:13.607840 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:13.608608 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:13.609381 [info ] [Thread-1 (]: 13 of 73 START test not_null_stg_activity_due_to_dt ............................ [RUN]
[0m04:31:13.610012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1, now test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989)
[0m04:31:13.610544 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:13.616397 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m04:31:13.617689 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:13.621963 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m04:31:13.622816 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m04:31:13.623318 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: BEGIN
[0m04:31:13.623778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.631807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.632602 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m04:31:13.633249 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select due_to_dt
from "postgres"."pipedrive_analytics"."stg_activity"
where due_to_dt is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.643638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m04:31:13.645376 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: ROLLBACK
[0m04:31:13.646117 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989: Close
[0m04:31:13.647045 [info ] [Thread-1 (]: 13 of 73 PASS not_null_stg_activity_due_to_dt .................................. [[32mPASS[0m in 0.04s]
[0m04:31:13.648106 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:13.648846 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:13.649753 [info ] [Thread-1 (]: 14 of 73 START test not_null_stg_activity_type ................................. [RUN]
[0m04:31:13.650384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989, now test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d)
[0m04:31:13.650856 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:13.656728 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m04:31:13.657575 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:13.660282 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m04:31:13.661049 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m04:31:13.661533 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: BEGIN
[0m04:31:13.661958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.669616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.670137 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m04:31:13.670625 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "postgres"."pipedrive_analytics"."stg_activity"
where type is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.683231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m04:31:13.684959 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: ROLLBACK
[0m04:31:13.685651 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d: Close
[0m04:31:13.686568 [info ] [Thread-1 (]: 14 of 73 PASS not_null_stg_activity_type ....................................... [[32mPASS[0m in 0.04s]
[0m04:31:13.687649 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:13.688509 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:13.689390 [info ] [Thread-1 (]: 15 of 73 START test unique_stg_activity_activity_id ............................ [RUN]
[0m04:31:13.690256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m04:31:13.690968 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:13.701296 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m04:31:13.702113 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:13.705688 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m04:31:13.706466 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m04:31:13.706928 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: BEGIN
[0m04:31:13.707385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.714562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.715048 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m04:31:13.715541 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_activity"
where activity_id is not null
group by activity_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:31:13.726818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m04:31:13.728632 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: ROLLBACK
[0m04:31:13.729318 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9: Close
[0m04:31:13.730173 [info ] [Thread-1 (]: 15 of 73 PASS unique_stg_activity_activity_id .................................. [[32mPASS[0m in 0.04s]
[0m04:31:13.731186 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:13.731919 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:13.732745 [info ] [Thread-1 (]: 16 of 73 START test accepted_values_stg_activity_types_is_active__True__False .. [RUN]
[0m04:31:13.733486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a)
[0m04:31:13.733955 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:13.739653 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m04:31:13.740457 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:13.744943 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m04:31:13.745743 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m04:31:13.746267 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: BEGIN
[0m04:31:13.746767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.755778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:13.756276 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m04:31:13.756747 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_active as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."stg_activity_types"
    group by is_active

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m04:31:13.760036 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:31:13.762840 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: ROLLBACK
[0m04:31:13.763886 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a: Close
[0m04:31:13.764958 [info ] [Thread-1 (]: 16 of 73 PASS accepted_values_stg_activity_types_is_active__True__False ........ [[32mPASS[0m in 0.03s]
[0m04:31:13.766006 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:13.769003 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:13.769934 [info ] [Thread-1 (]: 17 of 73 START test not_null_stg_activity_types_activity_type_id ............... [RUN]
[0m04:31:13.770881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m04:31:13.771759 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:13.777585 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m04:31:13.778665 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:13.781439 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m04:31:13.782530 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m04:31:13.783311 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: BEGIN
[0m04:31:13.784010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.792255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.792764 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m04:31:13.793267 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select activity_type_id
from "postgres"."pipedrive_analytics"."stg_activity_types"
where activity_type_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.794884 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:13.796545 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: ROLLBACK
[0m04:31:13.797242 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169: Close
[0m04:31:13.798123 [info ] [Thread-1 (]: 17 of 73 PASS not_null_stg_activity_types_activity_type_id ..................... [[32mPASS[0m in 0.03s]
[0m04:31:13.799346 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:13.800174 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:13.800762 [info ] [Thread-1 (]: 18 of 73 START test not_null_stg_activity_types_is_active ...................... [RUN]
[0m04:31:13.801388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f)
[0m04:31:13.801884 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:13.807925 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m04:31:13.808972 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:13.812679 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m04:31:13.813710 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m04:31:13.814399 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: BEGIN
[0m04:31:13.814881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.822800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.823317 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m04:31:13.823792 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_active
from "postgres"."pipedrive_analytics"."stg_activity_types"
where is_active is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.825414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:13.827077 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: ROLLBACK
[0m04:31:13.827771 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f: Close
[0m04:31:13.828636 [info ] [Thread-1 (]: 18 of 73 PASS not_null_stg_activity_types_is_active ............................ [[32mPASS[0m in 0.03s]
[0m04:31:13.829659 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:13.830408 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:13.831286 [info ] [Thread-1 (]: 19 of 73 START test not_null_stg_activity_types_name ........................... [RUN]
[0m04:31:13.831898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f, now test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596)
[0m04:31:13.832406 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:13.838398 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m04:31:13.839213 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:13.841832 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m04:31:13.842643 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m04:31:13.843136 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: BEGIN
[0m04:31:13.843585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.854512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m04:31:13.855305 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m04:31:13.856071 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select name
from "postgres"."pipedrive_analytics"."stg_activity_types"
where name is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.858959 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:31:13.861343 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: ROLLBACK
[0m04:31:13.862035 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596: Close
[0m04:31:13.862917 [info ] [Thread-1 (]: 19 of 73 PASS not_null_stg_activity_types_name ................................. [[32mPASS[0m in 0.03s]
[0m04:31:13.863968 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:13.864738 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:13.865528 [info ] [Thread-1 (]: 20 of 73 START test not_null_stg_activity_types_type ........................... [RUN]
[0m04:31:13.866156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596, now test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d)
[0m04:31:13.866648 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:13.872264 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m04:31:13.873162 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:13.876826 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m04:31:13.877882 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m04:31:13.878673 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: BEGIN
[0m04:31:13.879346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.886668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.887188 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m04:31:13.887666 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select type
from "postgres"."pipedrive_analytics"."stg_activity_types"
where type is null



  
  
      
    ) dbt_internal_test
[0m04:31:13.889271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:13.890879 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: ROLLBACK
[0m04:31:13.891549 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d: Close
[0m04:31:13.892367 [info ] [Thread-1 (]: 20 of 73 PASS not_null_stg_activity_types_type ................................. [[32mPASS[0m in 0.03s]
[0m04:31:13.893502 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:13.894263 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:13.894954 [info ] [Thread-1 (]: 21 of 73 START test unique_stg_activity_types_activity_type_id ................. [RUN]
[0m04:31:13.895594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m04:31:13.896082 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:13.901494 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m04:31:13.902248 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:13.904860 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m04:31:13.905635 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m04:31:13.906118 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: BEGIN
[0m04:31:13.906560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.914110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:13.914600 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m04:31:13.915081 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    activity_type_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_activity_types"
where activity_type_id is not null
group by activity_type_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:31:13.916939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:13.920593 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: ROLLBACK
[0m04:31:13.921258 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd: Close
[0m04:31:13.922130 [info ] [Thread-1 (]: 21 of 73 PASS unique_stg_activity_types_activity_type_id ....................... [[32mPASS[0m in 0.03s]
[0m04:31:13.923271 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:13.924004 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:13.924700 [info ] [Thread-1 (]: 22 of 73 START test dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value  [RUN]
[0m04:31:13.925455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6)
[0m04:31:13.925959 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:13.941511 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m04:31:13.942661 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:13.945803 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m04:31:13.946610 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m04:31:13.947142 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: BEGIN
[0m04:31:13.947600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:13.955215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:13.955718 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m04:31:13.956235 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, changed_field_key, new_value
    from "postgres"."pipedrive_analytics"."stg_deal_changes"
    group by deal_id, change_dt, changed_field_key, new_value
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m04:31:14.028331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.071 seconds
[0m04:31:14.031445 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: ROLLBACK
[0m04:31:14.032391 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6: Close
[0m04:31:14.033395 [info ] [Thread-1 (]: 22 of 73 PASS dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value  [[32mPASS[0m in 0.11s]
[0m04:31:14.034477 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:14.035228 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:14.036027 [info ] [Thread-1 (]: 23 of 73 START test not_null_stg_deal_changes_change_dt ........................ [RUN]
[0m04:31:14.036999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6, now test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35)
[0m04:31:14.037518 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:14.043626 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m04:31:14.044450 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:14.047353 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m04:31:14.048166 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m04:31:14.048652 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: BEGIN
[0m04:31:14.049161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.057484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:14.057986 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m04:31:14.058499 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.063523 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m04:31:14.065271 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: ROLLBACK
[0m04:31:14.065960 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35: Close
[0m04:31:14.066902 [info ] [Thread-1 (]: 23 of 73 PASS not_null_stg_deal_changes_change_dt .............................. [[32mPASS[0m in 0.03s]
[0m04:31:14.067925 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:14.068645 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:14.069399 [info ] [Thread-1 (]: 24 of 73 START test not_null_stg_deal_changes_changed_field_key ................ [RUN]
[0m04:31:14.070305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35, now test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f)
[0m04:31:14.070812 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:14.076053 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m04:31:14.077106 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:14.080910 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m04:31:14.081954 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m04:31:14.082750 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: BEGIN
[0m04:31:14.083518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.092460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:14.092962 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m04:31:14.093489 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select changed_field_key
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where changed_field_key is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.098426 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m04:31:14.100121 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: ROLLBACK
[0m04:31:14.100794 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f: Close
[0m04:31:14.101677 [info ] [Thread-1 (]: 24 of 73 PASS not_null_stg_deal_changes_changed_field_key ...................... [[32mPASS[0m in 0.03s]
[0m04:31:14.102721 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:14.103485 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:14.104248 [info ] [Thread-1 (]: 25 of 73 START test not_null_stg_deal_changes_deal_id .......................... [RUN]
[0m04:31:14.106925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m04:31:14.108182 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:14.115018 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m04:31:14.115859 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:14.118566 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m04:31:14.119370 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m04:31:14.119845 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: BEGIN
[0m04:31:14.120315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.127923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:14.128453 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m04:31:14.128925 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.133756 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m04:31:14.135445 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: ROLLBACK
[0m04:31:14.136169 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e: Close
[0m04:31:14.137043 [info ] [Thread-1 (]: 25 of 73 PASS not_null_stg_deal_changes_deal_id ................................ [[32mPASS[0m in 0.03s]
[0m04:31:14.138307 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:14.139083 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:14.139890 [info ] [Thread-1 (]: 26 of 73 START test not_null_stg_deal_changes_new_value ........................ [RUN]
[0m04:31:14.141500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d)
[0m04:31:14.142300 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:14.150916 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m04:31:14.152196 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:14.159650 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m04:31:14.160738 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m04:31:14.161555 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: BEGIN
[0m04:31:14.162390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.174530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m04:31:14.175360 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m04:31:14.176353 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select new_value
from "postgres"."pipedrive_analytics"."stg_deal_changes"
where new_value is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.186748 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m04:31:14.189801 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: ROLLBACK
[0m04:31:14.191040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d: Close
[0m04:31:14.192464 [info ] [Thread-1 (]: 26 of 73 PASS not_null_stg_deal_changes_new_value .............................. [[32mPASS[0m in 0.05s]
[0m04:31:14.194275 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:14.195066 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:14.195871 [info ] [Thread-1 (]: 27 of 73 START test dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id  [RUN]
[0m04:31:14.197309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00)
[0m04:31:14.198271 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:14.209991 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m04:31:14.211498 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:14.216786 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m04:31:14.218515 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m04:31:14.219413 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: BEGIN
[0m04:31:14.220237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.237025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m04:31:14.238036 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m04:31:14.239113 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        field_id, option_id
    from "postgres"."pipedrive_analytics"."stg_fields"
    group by field_id, option_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m04:31:14.243527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:31:14.246319 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: ROLLBACK
[0m04:31:14.247373 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00: Close
[0m04:31:14.250722 [info ] [Thread-1 (]: 27 of 73 PASS dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id  [[32mPASS[0m in 0.05s]
[0m04:31:14.252484 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:14.253354 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:14.254175 [info ] [Thread-1 (]: 28 of 73 START test not_null_stg_fields_field_id ............................... [RUN]
[0m04:31:14.255400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m04:31:14.256317 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:14.268120 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m04:31:14.270367 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:14.276521 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m04:31:14.277669 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m04:31:14.278528 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: BEGIN
[0m04:31:14.279345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.291979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m04:31:14.292825 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m04:31:14.293692 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_id
from "postgres"."pipedrive_analytics"."stg_fields"
where field_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.296981 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m04:31:14.300056 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: ROLLBACK
[0m04:31:14.301202 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5: Close
[0m04:31:14.304966 [info ] [Thread-1 (]: 28 of 73 PASS not_null_stg_fields_field_id ..................................... [[32mPASS[0m in 0.05s]
[0m04:31:14.310252 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:14.312820 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:14.316204 [info ] [Thread-1 (]: 29 of 73 START test not_null_stg_fields_field_key .............................. [RUN]
[0m04:31:14.320150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m04:31:14.321023 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:14.331211 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m04:31:14.332470 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:14.337649 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m04:31:14.338707 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m04:31:14.339520 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: BEGIN
[0m04:31:14.340267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.353320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m04:31:14.354070 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m04:31:14.354940 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_key
from "postgres"."pipedrive_analytics"."stg_fields"
where field_key is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.358276 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:31:14.361163 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: ROLLBACK
[0m04:31:14.362229 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe: Close
[0m04:31:14.363679 [info ] [Thread-1 (]: 29 of 73 PASS not_null_stg_fields_field_key .................................... [[32mPASS[0m in 0.04s]
[0m04:31:14.367051 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:14.368141 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:14.369067 [info ] [Thread-1 (]: 30 of 73 START test not_null_stg_fields_field_name ............................. [RUN]
[0m04:31:14.370889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd)
[0m04:31:14.371763 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:14.380066 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m04:31:14.381607 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:14.387673 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m04:31:14.388934 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m04:31:14.390015 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: BEGIN
[0m04:31:14.390833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.402715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m04:31:14.403257 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m04:31:14.403826 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select field_name
from "postgres"."pipedrive_analytics"."stg_fields"
where field_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.406150 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:31:14.407823 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: ROLLBACK
[0m04:31:14.408497 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd: Close
[0m04:31:14.409387 [info ] [Thread-1 (]: 30 of 73 PASS not_null_stg_fields_field_name ................................... [[32mPASS[0m in 0.04s]
[0m04:31:14.410568 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:14.411420 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:14.412311 [info ] [Thread-1 (]: 31 of 73 START test not_null_stg_stages_funnel_step ............................ [RUN]
[0m04:31:14.413412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd, now test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e)
[0m04:31:14.414204 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:14.422553 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m04:31:14.423681 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:14.431118 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m04:31:14.432062 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m04:31:14.432662 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: BEGIN
[0m04:31:14.433433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.441375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:14.441884 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m04:31:14.442394 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."stg_stages"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.444049 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:14.445710 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: ROLLBACK
[0m04:31:14.446383 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e: Close
[0m04:31:14.447257 [info ] [Thread-1 (]: 31 of 73 PASS not_null_stg_stages_funnel_step .................................. [[32mPASS[0m in 0.03s]
[0m04:31:14.448284 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:14.449314 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:14.449998 [info ] [Thread-1 (]: 32 of 73 START test not_null_stg_stages_stage_id ............................... [RUN]
[0m04:31:14.450611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m04:31:14.451069 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:14.457124 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m04:31:14.458170 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:14.461768 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m04:31:14.462550 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m04:31:14.463048 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: BEGIN
[0m04:31:14.463508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.472335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:14.472939 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m04:31:14.473714 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."pipedrive_analytics"."stg_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.476331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:31:14.478782 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: ROLLBACK
[0m04:31:14.479478 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378: Close
[0m04:31:14.480397 [info ] [Thread-1 (]: 32 of 73 PASS not_null_stg_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m04:31:14.481547 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:14.482376 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:14.483062 [info ] [Thread-1 (]: 33 of 73 START test not_null_stg_stages_stage_name ............................. [RUN]
[0m04:31:14.483712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25)
[0m04:31:14.484214 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:14.490739 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m04:31:14.492203 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:14.495436 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m04:31:14.496248 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m04:31:14.496738 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: BEGIN
[0m04:31:14.497208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.504656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:14.505176 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m04:31:14.505665 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_name
from "postgres"."pipedrive_analytics"."stg_stages"
where stage_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.507299 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:14.509112 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: ROLLBACK
[0m04:31:14.509776 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25: Close
[0m04:31:14.510662 [info ] [Thread-1 (]: 33 of 73 PASS not_null_stg_stages_stage_name ................................... [[32mPASS[0m in 0.03s]
[0m04:31:14.511730 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:14.512456 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:14.513235 [info ] [Thread-1 (]: 34 of 73 START test unique_stg_stages_stage_id ................................. [RUN]
[0m04:31:14.513848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m04:31:14.514377 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:14.520081 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m04:31:14.521135 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:14.524067 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m04:31:14.524861 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m04:31:14.525357 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: BEGIN
[0m04:31:14.525791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.533052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:14.533557 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m04:31:14.534227 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    stage_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_stages"
where stage_id is not null
group by stage_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:31:14.536916 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m04:31:14.539341 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: ROLLBACK
[0m04:31:14.539989 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3: Close
[0m04:31:14.540914 [info ] [Thread-1 (]: 34 of 73 PASS unique_stg_stages_stage_id ....................................... [[32mPASS[0m in 0.03s]
[0m04:31:14.541949 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:14.542808 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:14.543623 [info ] [Thread-1 (]: 35 of 73 START test not_null_stg_users_user_email .............................. [RUN]
[0m04:31:14.544290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f)
[0m04:31:14.544775 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:14.549630 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m04:31:14.550684 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:14.553853 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m04:31:14.554622 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m04:31:14.555099 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: BEGIN
[0m04:31:14.555559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.563071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:14.563568 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m04:31:14.564023 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_email
from "postgres"."pipedrive_analytics"."stg_users"
where user_email is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.565655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:14.567282 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: ROLLBACK
[0m04:31:14.567934 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f: Close
[0m04:31:14.568776 [info ] [Thread-1 (]: 35 of 73 PASS not_null_stg_users_user_email .................................... [[32mPASS[0m in 0.02s]
[0m04:31:14.569809 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:14.570591 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:14.571278 [info ] [Thread-1 (]: 36 of 73 START test not_null_stg_users_user_id ................................. [RUN]
[0m04:31:14.571972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m04:31:14.572530 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:14.579566 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m04:31:14.580877 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:14.586024 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m04:31:14.587283 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m04:31:14.588028 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m04:31:14.588731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.598210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:14.598703 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m04:31:14.599203 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."pipedrive_analytics"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.600654 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:14.602298 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m04:31:14.602952 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77: Close
[0m04:31:14.603801 [info ] [Thread-1 (]: 36 of 73 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.03s]
[0m04:31:14.604837 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:14.605594 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:14.606447 [info ] [Thread-1 (]: 37 of 73 START test not_null_stg_users_user_modified_at ........................ [RUN]
[0m04:31:14.607046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0)
[0m04:31:14.607538 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:14.612882 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m04:31:14.614203 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:14.617986 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m04:31:14.619184 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m04:31:14.619691 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: BEGIN
[0m04:31:14.620163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.629006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:14.629858 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m04:31:14.630586 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_modified_at
from "postgres"."pipedrive_analytics"."stg_users"
where user_modified_at is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.632220 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:14.633850 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: ROLLBACK
[0m04:31:14.634524 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0: Close
[0m04:31:14.635354 [info ] [Thread-1 (]: 37 of 73 PASS not_null_stg_users_user_modified_at .............................. [[32mPASS[0m in 0.03s]
[0m04:31:14.636435 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:14.637166 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:14.637857 [info ] [Thread-1 (]: 38 of 73 START test not_null_stg_users_user_name ............................... [RUN]
[0m04:31:14.638559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m04:31:14.639064 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:14.645697 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m04:31:14.646889 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:14.651489 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m04:31:14.652704 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m04:31:14.653467 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: BEGIN
[0m04:31:14.655959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.683655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m04:31:14.684607 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m04:31:14.693458 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_name
from "postgres"."pipedrive_analytics"."stg_users"
where user_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:14.703360 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m04:31:14.708399 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: ROLLBACK
[0m04:31:14.720404 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53: Close
[0m04:31:14.723752 [info ] [Thread-1 (]: 38 of 73 PASS not_null_stg_users_user_name ..................................... [[32mPASS[0m in 0.09s]
[0m04:31:14.730536 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:14.736470 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:14.737330 [info ] [Thread-1 (]: 39 of 73 START test unique_stg_users_user_id ................................... [RUN]
[0m04:31:14.743717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m04:31:14.745936 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:14.780815 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m04:31:14.789192 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:14.812885 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m04:31:14.818448 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m04:31:14.819239 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m04:31:14.819934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:14.848138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m04:31:14.849605 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m04:31:14.854275 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "postgres"."pipedrive_analytics"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:31:14.869281 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m04:31:14.878714 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m04:31:14.888348 [debug] [Thread-1 (]: On test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b: Close
[0m04:31:14.889607 [info ] [Thread-1 (]: 39 of 73 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.15s]
[0m04:31:14.897503 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:14.898378 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m04:31:14.914418 [info ] [Thread-1 (]: 40 of 73 START sql view model pipedrive_analytics.int_activites ................ [RUN]
[0m04:31:14.915496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.int_activites)
[0m04:31:14.924653 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m04:31:14.951152 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m04:31:14.956784 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m04:31:14.989344 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_activites"
[0m04:31:14.992449 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m04:31:14.997281 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: BEGIN
[0m04:31:14.998039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.025234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m04:31:15.026254 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m04:31:15.027073 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */

  create view "postgres"."pipedrive_analytics"."int_activites__dbt_tmp"
    
    
  as (
    

WITH 
base AS (
          SELECT 
                ac.activity_id,
                ac.deal_id,
                ac.type,
                act.name,
                act.funnel_step,
                ac.assigned_to_user,
                ac.due_to_dt,
                CAST(DATE_TRUNC('month', DATE(ac.due_to_dt)) AS DATE) AS month
                
          FROM "postgres"."pipedrive_analytics"."stg_activity" ac
          LEFT JOIN "postgres"."pipedrive_analytics"."stg_activity_types" act ON ac.type = act.type
          WHERE TRUE 
              AND ac.done
              AND act.name IN ('Sales Call 1', 'Sales Call 2')
)

SELECT *
FROM base
  );
[0m04:31:15.031084 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m04:31:15.036954 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m04:31:15.037719 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
alter table "postgres"."pipedrive_analytics"."int_activites__dbt_tmp" rename to "int_activites"
[0m04:31:15.039054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:31:15.041776 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m04:31:15.042756 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m04:31:15.043481 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: COMMIT
[0m04:31:15.053324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m04:31:15.072753 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_activites__dbt_backup"
[0m04:31:15.078746 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_activites"
[0m04:31:15.083483 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_activites"} */
drop view if exists "postgres"."pipedrive_analytics"."int_activites__dbt_backup" cascade
[0m04:31:15.084841 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m04:31:15.091003 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_activites: Close
[0m04:31:15.097020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa14182c5c0>]}
[0m04:31:15.102834 [info ] [Thread-1 (]: 40 of 73 OK created sql view model pipedrive_analytics.int_activites ........... [[32mCREATE VIEW[0m in 0.18s]
[0m04:31:15.109264 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m04:31:15.116148 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m04:31:15.121320 [info ] [Thread-1 (]: 41 of 73 START sql view model pipedrive_analytics.int_stages ................... [RUN]
[0m04:31:15.122539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activites, now model.enpal_assessment_project.int_stages)
[0m04:31:15.123416 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m04:31:15.132798 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m04:31:15.134216 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m04:31:15.140993 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages"
[0m04:31:15.142305 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m04:31:15.143034 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: BEGIN
[0m04:31:15.143705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.158802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m04:31:15.160191 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m04:31:15.161408 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */

  create view "postgres"."pipedrive_analytics"."int_stages__dbt_tmp"
    
    
  as (
    

WITH
users AS (
			SELECT 
				  deal_id,
				   new_value :: INT AS user_id,
				   change_dt AS assigned_user_start,
				   LEAD(change_dt) OVER(PARTITION BY deal_id,changed_field_key ORDER BY change_dt) AS assigned_user_end
			FROM "postgres"."pipedrive_analytics"."stg_deal_changes"
			WHERE TRUE 
				AND  changed_field_key= 'user_id'
) 
, 
base AS (
         SELECT 
                dc.deal_id,
                dc.change_dt,
                CAST(DATE_TRUNC('month', DATE(dc.change_dt)) AS DATE) AS month,
                dc.new_value :: INT AS stage_id,
                s.stage_name,
                s.funnel_step,
                u.user_id,
                u.assigned_user_start,
                u.assigned_user_end
                   
         FROM "postgres"."pipedrive_analytics"."stg_deal_changes" dc
         LEFT JOIN "postgres"."pipedrive_analytics"."stg_stages" s       ON dc.new_value = CAST(s.stage_id AS TEXT)
         LEFT JOIN users u                       ON dc.deal_id = u.deal_id 
					                                AND dc.change_dt >= u.assigned_user_start
					                                AND dc.change_dt <= COALESCE(assigned_user_end, CURRENT_DATE)
         WHERE TRUE 
            AND dc.changed_field_key= 'stage_id'
)

SELECT 
      *
FROM base
  );
[0m04:31:15.166758 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m04:31:15.171844 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m04:31:15.172655 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
alter table "postgres"."pipedrive_analytics"."int_stages__dbt_tmp" rename to "int_stages"
[0m04:31:15.174349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:31:15.176361 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m04:31:15.176893 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m04:31:15.177391 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: COMMIT
[0m04:31:15.178906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:15.181678 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages__dbt_backup"
[0m04:31:15.182697 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages"
[0m04:31:15.183243 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages__dbt_backup" cascade
[0m04:31:15.183982 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:31:15.185467 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages: Close
[0m04:31:15.186385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa146467e90>]}
[0m04:31:15.187609 [info ] [Thread-1 (]: 41 of 73 OK created sql view model pipedrive_analytics.int_stages .............. [[32mCREATE VIEW[0m in 0.06s]
[0m04:31:15.188826 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m04:31:15.190154 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:15.191030 [info ] [Thread-1 (]: 42 of 73 START test dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id  [RUN]
[0m04:31:15.192376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_stages, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec)
[0m04:31:15.193279 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:15.202511 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m04:31:15.203448 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:15.206388 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m04:31:15.207281 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m04:31:15.207788 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: BEGIN
[0m04:31:15.208270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.216369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.216883 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m04:31:15.217405 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, stage_id
    from "postgres"."pipedrive_analytics"."int_stages"
    group by deal_id, change_dt, stage_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m04:31:15.271603 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.054 seconds
[0m04:31:15.273651 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: ROLLBACK
[0m04:31:15.274468 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec: Close
[0m04:31:15.275476 [info ] [Thread-1 (]: 42 of 73 PASS dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id  [[32mPASS[0m in 0.08s]
[0m04:31:15.276581 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:15.277433 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:15.278275 [info ] [Thread-1 (]: 43 of 73 START test not_null_int_stages_change_dt .............................. [RUN]
[0m04:31:15.279073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec, now test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e)
[0m04:31:15.279843 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:15.286288 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m04:31:15.287141 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:15.289791 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m04:31:15.290691 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m04:31:15.291286 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: BEGIN
[0m04:31:15.292030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.301040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:15.301595 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m04:31:15.302077 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."int_stages"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.308843 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m04:31:15.310541 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: ROLLBACK
[0m04:31:15.311245 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e: Close
[0m04:31:15.312115 [info ] [Thread-1 (]: 43 of 73 PASS not_null_int_stages_change_dt .................................... [[32mPASS[0m in 0.03s]
[0m04:31:15.313300 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:15.314118 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:15.314811 [info ] [Thread-1 (]: 44 of 73 START test not_null_int_stages_deal_id ................................ [RUN]
[0m04:31:15.315813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e, now test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9)
[0m04:31:15.316580 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:15.323663 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m04:31:15.324504 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:15.329106 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m04:31:15.329896 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m04:31:15.330415 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: BEGIN
[0m04:31:15.330896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.338682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.339199 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m04:31:15.339683 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."int_stages"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.347232 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m04:31:15.348902 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: ROLLBACK
[0m04:31:15.349582 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9: Close
[0m04:31:15.350421 [info ] [Thread-1 (]: 44 of 73 PASS not_null_int_stages_deal_id ...................................... [[32mPASS[0m in 0.03s]
[0m04:31:15.351497 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:15.352258 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:15.353157 [info ] [Thread-1 (]: 45 of 73 START test not_null_int_stages_funnel_step ............................ [RUN]
[0m04:31:15.354014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9, now test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54)
[0m04:31:15.355284 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:15.361853 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m04:31:15.362677 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:15.365255 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m04:31:15.366028 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m04:31:15.366521 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: BEGIN
[0m04:31:15.366963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.375064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.375844 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m04:31:15.376709 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."int_stages"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.412861 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.035 seconds
[0m04:31:15.414733 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: ROLLBACK
[0m04:31:15.415481 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54: Close
[0m04:31:15.416421 [info ] [Thread-1 (]: 45 of 73 PASS not_null_int_stages_funnel_step .................................. [[32mPASS[0m in 0.06s]
[0m04:31:15.417516 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:15.418275 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:15.419107 [info ] [Thread-1 (]: 46 of 73 START test not_null_int_stages_month .................................. [RUN]
[0m04:31:15.419805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54, now test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9)
[0m04:31:15.420324 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:15.426250 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m04:31:15.426994 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:15.429666 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m04:31:15.430452 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m04:31:15.430939 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: BEGIN
[0m04:31:15.431409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.439079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.439895 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m04:31:15.440667 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."int_stages"
where month is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.462436 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m04:31:15.464372 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: ROLLBACK
[0m04:31:15.465057 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9: Close
[0m04:31:15.465975 [info ] [Thread-1 (]: 46 of 73 PASS not_null_int_stages_month ........................................ [[32mPASS[0m in 0.05s]
[0m04:31:15.467014 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:15.467788 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:15.468698 [info ] [Thread-1 (]: 47 of 73 START test not_null_int_stages_stage_id ............................... [RUN]
[0m04:31:15.469366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9, now test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4)
[0m04:31:15.469890 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:15.475836 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m04:31:15.476652 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:15.479348 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m04:31:15.480146 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m04:31:15.480616 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: BEGIN
[0m04:31:15.481047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.488745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.489269 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m04:31:15.489752 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_id
from "postgres"."pipedrive_analytics"."int_stages"
where stage_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.498780 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m04:31:15.500464 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: ROLLBACK
[0m04:31:15.501151 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4: Close
[0m04:31:15.502029 [info ] [Thread-1 (]: 47 of 73 PASS not_null_int_stages_stage_id ..................................... [[32mPASS[0m in 0.03s]
[0m04:31:15.503285 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:15.504825 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:15.505752 [info ] [Thread-1 (]: 48 of 73 START test not_null_int_stages_stage_name ............................. [RUN]
[0m04:31:15.506798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4, now test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5)
[0m04:31:15.507596 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:15.518816 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m04:31:15.519922 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:15.522757 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m04:31:15.523562 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m04:31:15.524055 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: BEGIN
[0m04:31:15.524551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.532335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.532854 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m04:31:15.533353 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_name
from "postgres"."pipedrive_analytics"."int_stages"
where stage_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.568329 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m04:31:15.570374 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: ROLLBACK
[0m04:31:15.571273 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5: Close
[0m04:31:15.572305 [info ] [Thread-1 (]: 48 of 73 PASS not_null_int_stages_stage_name ................................... [[32mPASS[0m in 0.07s]
[0m04:31:15.573366 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:15.574485 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m04:31:15.575528 [info ] [Thread-1 (]: 49 of 73 START sql view model pipedrive_analytics.int_stages_anmly ............. [RUN]
[0m04:31:15.576380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5, now model.enpal_assessment_project.int_stages_anmly)
[0m04:31:15.576872 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m04:31:15.581550 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.582601 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m04:31:15.588616 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.589446 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.589933 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: BEGIN
[0m04:31:15.590451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.598321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.598852 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.599378 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */

  create view "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp"
    
    
  as (
    

WITH 
stages AS (
			SELECT 
				  *,
				  LAG(stage_id) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
				  LAG(user_id)  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user,
				  ROW_NUMBER()  OVER(PARTITION BY deal_id ORDER BY change_dt ASC) rn
				  
			FROM "postgres"."pipedrive_analytics"."int_stages" 			
)

, stages_anmly AS (
					SELECT 
						   *,
						   CASE WHEN stage_id <= prev_step AND user_id = prev_user  THEN 1 ELSE 0 END AS anmly_flg
								
					FROM stages
)

SELECT *
FROM stages_anmly
  );
[0m04:31:15.602159 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:31:15.605637 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.606154 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
alter table "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_tmp" rename to "int_stages_anmly"
[0m04:31:15.607101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:15.609954 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m04:31:15.610687 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.611194 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: COMMIT
[0m04:31:15.613909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:31:15.617906 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup"
[0m04:31:15.618978 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:15.619539 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_stages_anmly"} */
drop view if exists "postgres"."pipedrive_analytics"."int_stages_anmly__dbt_backup" cascade
[0m04:31:15.620258 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:31:15.621723 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_stages_anmly: Close
[0m04:31:15.622544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa141763680>]}
[0m04:31:15.623681 [info ] [Thread-1 (]: 49 of 73 OK created sql view model pipedrive_analytics.int_stages_anmly ........ [[32mCREATE VIEW[0m in 0.05s]
[0m04:31:15.624834 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m04:31:15.626118 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:15.626884 [info ] [Thread-1 (]: 50 of 73 START test accepted_values_int_stages_anmly_anmly_flg__0__1 ........... [RUN]
[0m04:31:15.627780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_stages_anmly, now test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb)
[0m04:31:15.628503 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:15.636597 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m04:31:15.637438 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:15.640200 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m04:31:15.641008 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m04:31:15.641507 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: BEGIN
[0m04:31:15.641999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.649760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.650289 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m04:31:15.650781 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        anmly_flg as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."int_stages_anmly"
    group by anmly_flg

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m04:31:15.723449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m04:31:15.725620 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: ROLLBACK
[0m04:31:15.726545 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb: Close
[0m04:31:15.727601 [info ] [Thread-1 (]: 50 of 73 PASS accepted_values_int_stages_anmly_anmly_flg__0__1 ................. [[32mPASS[0m in 0.10s]
[0m04:31:15.728755 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:15.729516 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:15.730429 [info ] [Thread-1 (]: 51 of 73 START test not_null_int_stages_anmly_anmly_flg ........................ [RUN]
[0m04:31:15.731324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb, now test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b)
[0m04:31:15.731831 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:15.737045 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m04:31:15.738006 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:15.741678 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m04:31:15.742499 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m04:31:15.742984 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: BEGIN
[0m04:31:15.743442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.751493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:15.751975 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m04:31:15.752471 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select anmly_flg
from "postgres"."pipedrive_analytics"."int_stages_anmly"
where anmly_flg is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.821246 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m04:31:15.823507 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: ROLLBACK
[0m04:31:15.824411 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b: Close
[0m04:31:15.825607 [info ] [Thread-1 (]: 51 of 73 PASS not_null_int_stages_anmly_anmly_flg .............................. [[32mPASS[0m in 0.09s]
[0m04:31:15.827376 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:15.828457 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:15.830519 [info ] [Thread-1 (]: 52 of 73 START test not_null_int_stages_anmly_rn ............................... [RUN]
[0m04:31:15.831363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b, now test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916)
[0m04:31:15.831851 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:15.837883 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m04:31:15.838711 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:15.841396 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m04:31:15.842259 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m04:31:15.842749 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: BEGIN
[0m04:31:15.843197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.851841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:15.852343 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m04:31:15.852811 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rn
from "postgres"."pipedrive_analytics"."int_stages_anmly"
where rn is null



  
  
      
    ) dbt_internal_test
[0m04:31:15.909688 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.056 seconds
[0m04:31:15.912823 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: ROLLBACK
[0m04:31:15.914209 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916: Close
[0m04:31:15.919231 [info ] [Thread-1 (]: 52 of 73 PASS not_null_int_stages_anmly_rn ..................................... [[32mPASS[0m in 0.09s]
[0m04:31:15.920345 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:15.923708 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_sales_funnel
[0m04:31:15.924837 [info ] [Thread-1 (]: 53 of 73 START sql view model pipedrive_analytics.int_sales_funnel ............. [RUN]
[0m04:31:15.925783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916, now model.enpal_assessment_project.int_sales_funnel)
[0m04:31:15.926650 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_sales_funnel
[0m04:31:15.934121 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.935230 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_sales_funnel
[0m04:31:15.943238 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.944359 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.945145 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: BEGIN
[0m04:31:15.945889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:15.956725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m04:31:15.957239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.957758 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */

  create view "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp"
    
    
  as (
    

WITH 
activities AS (
		   		SELECT 
				   	   deal_id,
					   name				AS kpi_name,
					   funnel_step,
					   assigned_to_user AS user_id,
					   due_to_dt		AS change_dt,
					   month,
					   0 				AS anmly_flg
		   		
				FROM "postgres"."pipedrive_analytics"."int_activites"
)
, stages AS (
			  SELECT 
			  		 deal_id,
			  		 stage_name			AS kpi_name,
					 funnel_step,
					 user_id,
					 change_dt,
					 month,
					 anmly_flg
			  FROM "postgres"."pipedrive_analytics"."int_stages_anmly"
)

,stg_funnel AS ( 
			    SELECT * FROM activities 
			    UNION ALL
			    SELECT * FROM stages
)

, int_funnel AS (
				  SELECT *,
						 LAG(funnel_step) OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_step,
						 LAG(user_id)     OVER(PARTITION BY deal_id ORDER BY change_dt ASC) prev_user
						   
				  FROM stg_funnel
)

, final_funnel AS (
					SELECT *,
						   CASE 
						   		WHEN funnel_step= 'Step 2.1' AND COALESCE(prev_step, 'n') <> 'Step 2' AND user_id = prev_user THEN 1
						   		WHEN funnel_step= 'Step 3.1' AND COALESCE(prev_step, 'n') <> 'Step 3' AND user_id = prev_user THEN 1
								ELSE anmly_flg
						   END AS funnel_anmly_flg
					FROM int_funnel 
)

SELECT *
FROM final_funnel
  );
[0m04:31:15.961647 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m04:31:15.965930 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.966512 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
alter table "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_tmp" rename to "int_sales_funnel"
[0m04:31:15.967532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:31:15.969956 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m04:31:15.970749 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.971276 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: COMMIT
[0m04:31:15.972969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:15.976029 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup"
[0m04:31:15.977128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:15.977658 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_sales_funnel"} */
drop view if exists "postgres"."pipedrive_analytics"."int_sales_funnel__dbt_backup" cascade
[0m04:31:15.978405 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:31:15.980078 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_sales_funnel: Close
[0m04:31:15.980986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa14173ff20>]}
[0m04:31:15.982236 [info ] [Thread-1 (]: 53 of 73 OK created sql view model pipedrive_analytics.int_sales_funnel ........ [[32mCREATE VIEW[0m in 0.06s]
[0m04:31:15.983560 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_sales_funnel
[0m04:31:15.984783 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:15.985786 [info ] [Thread-1 (]: 54 of 73 START test accepted_values_int_sales_funnel_funnel_anmly_flg__0__1 .... [RUN]
[0m04:31:15.986464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_sales_funnel, now test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61)
[0m04:31:15.986945 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:15.992472 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m04:31:15.993226 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:15.995808 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m04:31:15.996588 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m04:31:15.997076 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: BEGIN
[0m04:31:15.997541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.005296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.005778 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m04:31:16.006273 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        funnel_anmly_flg as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."int_sales_funnel"
    group by funnel_anmly_flg

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  
      
    ) dbt_internal_test
[0m04:31:16.087731 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.081 seconds
[0m04:31:16.089851 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: ROLLBACK
[0m04:31:16.090749 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61: Close
[0m04:31:16.091768 [info ] [Thread-1 (]: 54 of 73 PASS accepted_values_int_sales_funnel_funnel_anmly_flg__0__1 .......... [[32mPASS[0m in 0.11s]
[0m04:31:16.092852 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:16.093631 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:16.094446 [info ] [Thread-1 (]: 55 of 73 START test dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id  [RUN]
[0m04:31:16.095396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c)
[0m04:31:16.095899 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:16.103934 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m04:31:16.104799 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:16.107594 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m04:31:16.108416 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m04:31:16.108928 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: BEGIN
[0m04:31:16.109450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.117505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.118009 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m04:31:16.118545 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        deal_id, change_dt, kpi_name, funnel_step, user_id
    from "postgres"."pipedrive_analytics"."int_sales_funnel"
    group by deal_id, change_dt, kpi_name, funnel_step, user_id
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m04:31:16.193400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.074 seconds
[0m04:31:16.198019 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: ROLLBACK
[0m04:31:16.198988 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c: Close
[0m04:31:16.199987 [info ] [Thread-1 (]: 55 of 73 PASS dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id  [[32mPASS[0m in 0.10s]
[0m04:31:16.201065 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:16.201849 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:16.202651 [info ] [Thread-1 (]: 56 of 73 START test not_null_int_sales_funnel_change_dt ........................ [RUN]
[0m04:31:16.203562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c, now test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b)
[0m04:31:16.204061 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:16.210147 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m04:31:16.210989 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:16.213783 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m04:31:16.214573 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m04:31:16.215053 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: BEGIN
[0m04:31:16.215515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.223109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.223619 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m04:31:16.224111 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select change_dt
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where change_dt is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.290699 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.066 seconds
[0m04:31:16.293787 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: ROLLBACK
[0m04:31:16.294904 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b: Close
[0m04:31:16.296252 [info ] [Thread-1 (]: 56 of 73 PASS not_null_int_sales_funnel_change_dt .............................. [[32mPASS[0m in 0.09s]
[0m04:31:16.297378 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:16.298340 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:16.299181 [info ] [Thread-1 (]: 57 of 73 START test not_null_int_sales_funnel_deal_id .......................... [RUN]
[0m04:31:16.300131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b, now test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e)
[0m04:31:16.300651 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:16.309201 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m04:31:16.310176 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:16.312910 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m04:31:16.313819 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m04:31:16.314362 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: BEGIN
[0m04:31:16.314840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.322966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.323537 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m04:31:16.324029 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select deal_id
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where deal_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.344498 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m04:31:16.346344 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: ROLLBACK
[0m04:31:16.347040 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e: Close
[0m04:31:16.348005 [info ] [Thread-1 (]: 57 of 73 PASS not_null_int_sales_funnel_deal_id ................................ [[32mPASS[0m in 0.05s]
[0m04:31:16.349233 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:16.349995 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:16.351337 [info ] [Thread-1 (]: 58 of 73 START test not_null_int_sales_funnel_funnel_anmly_flg ................. [RUN]
[0m04:31:16.351969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e, now test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70)
[0m04:31:16.352670 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:16.359475 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m04:31:16.360280 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:16.363024 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m04:31:16.363826 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m04:31:16.364354 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: BEGIN
[0m04:31:16.364832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.372231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:16.372744 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m04:31:16.373251 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_anmly_flg
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where funnel_anmly_flg is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.455654 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.082 seconds
[0m04:31:16.457800 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: ROLLBACK
[0m04:31:16.458655 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70: Close
[0m04:31:16.459638 [info ] [Thread-1 (]: 58 of 73 PASS not_null_int_sales_funnel_funnel_anmly_flg ....................... [[32mPASS[0m in 0.11s]
[0m04:31:16.460737 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:16.461489 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:16.462289 [info ] [Thread-1 (]: 59 of 73 START test not_null_int_sales_funnel_funnel_step ...................... [RUN]
[0m04:31:16.463359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70, now test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738)
[0m04:31:16.463851 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:16.470217 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m04:31:16.471025 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:16.473932 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m04:31:16.474787 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m04:31:16.475308 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: BEGIN
[0m04:31:16.475791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.483474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.483983 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m04:31:16.484509 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.552148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.067 seconds
[0m04:31:16.554236 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: ROLLBACK
[0m04:31:16.555121 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738: Close
[0m04:31:16.556118 [info ] [Thread-1 (]: 59 of 73 PASS not_null_int_sales_funnel_funnel_step ............................ [[32mPASS[0m in 0.09s]
[0m04:31:16.557373 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:16.558189 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:16.558897 [info ] [Thread-1 (]: 60 of 73 START test not_null_int_sales_funnel_kpi_name ......................... [RUN]
[0m04:31:16.559852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738, now test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e)
[0m04:31:16.560682 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:16.568933 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m04:31:16.570026 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:16.572750 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m04:31:16.573544 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m04:31:16.574016 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: BEGIN
[0m04:31:16.574504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.582403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.582899 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m04:31:16.583394 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.651230 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.067 seconds
[0m04:31:16.653309 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: ROLLBACK
[0m04:31:16.654154 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e: Close
[0m04:31:16.655153 [info ] [Thread-1 (]: 60 of 73 PASS not_null_int_sales_funnel_kpi_name ............................... [[32mPASS[0m in 0.10s]
[0m04:31:16.657283 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:16.658571 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:16.659604 [info ] [Thread-1 (]: 61 of 73 START test not_null_int_sales_funnel_month ............................ [RUN]
[0m04:31:16.660304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e, now test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940)
[0m04:31:16.660838 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:16.667661 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m04:31:16.668519 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:16.671172 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m04:31:16.672226 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m04:31:16.672985 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: BEGIN
[0m04:31:16.673737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.682802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:16.683628 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m04:31:16.684457 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where month is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.756929 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.071 seconds
[0m04:31:16.759608 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: ROLLBACK
[0m04:31:16.760968 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940: Close
[0m04:31:16.762165 [info ] [Thread-1 (]: 61 of 73 PASS not_null_int_sales_funnel_month .................................. [[32mPASS[0m in 0.10s]
[0m04:31:16.763303 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:16.764046 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:16.764830 [info ] [Thread-1 (]: 62 of 73 START test not_null_int_sales_funnel_user_id .......................... [RUN]
[0m04:31:16.765893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940, now test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395)
[0m04:31:16.766407 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:16.774797 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m04:31:16.775657 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:16.778415 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m04:31:16.779269 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m04:31:16.779763 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: BEGIN
[0m04:31:16.780222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.787980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.788489 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m04:31:16.788968 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "postgres"."pipedrive_analytics"."int_sales_funnel"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m04:31:16.860536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.071 seconds
[0m04:31:16.862678 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: ROLLBACK
[0m04:31:16.863550 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395: Close
[0m04:31:16.864588 [info ] [Thread-1 (]: 62 of 73 PASS not_null_int_sales_funnel_user_id ................................ [[32mPASS[0m in 0.10s]
[0m04:31:16.865646 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:16.868156 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:16.869441 [info ] [Thread-1 (]: 63 of 73 START sql view model pipedrive_analytics.int_step_month_matrix ........ [RUN]
[0m04:31:16.870390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395, now model.enpal_assessment_project.int_step_month_matrix)
[0m04:31:16.871357 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:16.878502 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.879435 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:16.883674 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.884532 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.885050 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: BEGIN
[0m04:31:16.885530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.893467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.893985 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.894507 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */

  create view "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp"
    
    
  as (
    

WITH
all_unique_steps AS (
                      SELECT
                          kpi_name,
                          funnel_step,
                          step_order
                      FROM "postgres"."pipedrive_analytics"."funnel_steps"
)

, all_months AS (
                    SELECT DISTINCT month 
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                )

, month_step_matrix AS (
                         SELECT
                               m.month,
                               s.kpi_name,
                               s.funnel_step
                         FROM all_months m
                         CROSS JOIN all_unique_steps s
                       )

SELECT *
FROM month_step_matrix
  );
[0m04:31:16.897036 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:31:16.902239 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.903108 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
alter table "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_tmp" rename to "int_step_month_matrix"
[0m04:31:16.904083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:16.905909 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m04:31:16.906429 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.906915 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: COMMIT
[0m04:31:16.909518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:31:16.913462 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup"
[0m04:31:16.914627 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:16.915264 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_step_month_matrix"} */
drop view if exists "postgres"."pipedrive_analytics"."int_step_month_matrix__dbt_backup" cascade
[0m04:31:16.916175 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:31:16.918523 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_step_month_matrix: Close
[0m04:31:16.919615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa1431fb350>]}
[0m04:31:16.920738 [info ] [Thread-1 (]: 63 of 73 OK created sql view model pipedrive_analytics.int_step_month_matrix ... [[32mCREATE VIEW[0m in 0.05s]
[0m04:31:16.921848 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:16.923119 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:16.923707 [info ] [Thread-1 (]: 64 of 73 START test accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9  [RUN]
[0m04:31:16.924361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_step_month_matrix, now test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef)
[0m04:31:16.924866 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:16.936876 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m04:31:16.937708 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:16.940417 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m04:31:16.941233 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m04:31:16.941741 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: BEGIN
[0m04:31:16.942238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.950288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:16.950800 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m04:31:16.951331 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        funnel_step as value_field,
        count(*) as n_records

    from "postgres"."pipedrive_analytics"."int_step_month_matrix"
    group by funnel_step

)

select *
from all_values
where value_field not in (
    'Step 1','Step 2','Step 2.1','Step 3','Step 3.1','Step 4','Step 5','Step 6','Step 7','Step 8','Step 9'
)



  
  
      
    ) dbt_internal_test
[0m04:31:16.962973 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m04:31:16.965410 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: ROLLBACK
[0m04:31:16.966707 [debug] [Thread-1 (]: On test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef: Close
[0m04:31:16.968255 [info ] [Thread-1 (]: 64 of 73 PASS accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9  [[32mPASS[0m in 0.04s]
[0m04:31:16.969362 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:16.971245 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:16.972210 [info ] [Thread-1 (]: 65 of 73 START test dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step  [RUN]
[0m04:31:16.973003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586)
[0m04:31:16.973744 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:16.982170 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m04:31:16.983249 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:16.986021 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m04:31:16.986839 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m04:31:16.987346 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: BEGIN
[0m04:31:16.987818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:16.996787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:16.997305 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m04:31:16.997803 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        month, funnel_step
    from "postgres"."pipedrive_analytics"."int_step_month_matrix"
    group by month, funnel_step
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m04:31:17.072037 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.073 seconds
[0m04:31:17.075484 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: ROLLBACK
[0m04:31:17.076597 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586: Close
[0m04:31:17.079764 [info ] [Thread-1 (]: 65 of 73 PASS dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step  [[32mPASS[0m in 0.11s]
[0m04:31:17.080938 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:17.083407 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:17.084273 [info ] [Thread-1 (]: 66 of 73 START test not_null_int_step_month_matrix_funnel_step ................. [RUN]
[0m04:31:17.085638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586, now test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f)
[0m04:31:17.086665 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:17.100148 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m04:31:17.101292 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:17.105917 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m04:31:17.107018 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m04:31:17.107976 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: BEGIN
[0m04:31:17.108763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.120596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m04:31:17.121421 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m04:31:17.122413 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."int_step_month_matrix"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m04:31:17.271893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.148 seconds
[0m04:31:17.275699 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: ROLLBACK
[0m04:31:17.276979 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f: Close
[0m04:31:17.279006 [info ] [Thread-1 (]: 66 of 73 PASS not_null_int_step_month_matrix_funnel_step ....................... [[32mPASS[0m in 0.19s]
[0m04:31:17.283056 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:17.283858 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:17.284751 [info ] [Thread-1 (]: 67 of 73 START test not_null_int_step_month_matrix_kpi_name .................... [RUN]
[0m04:31:17.286182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f, now test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4)
[0m04:31:17.286904 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:17.293777 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m04:31:17.294587 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:17.297268 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m04:31:17.298035 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m04:31:17.298599 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: BEGIN
[0m04:31:17.299046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.306781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:17.307315 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m04:31:17.307813 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."pipedrive_analytics"."int_step_month_matrix"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:17.377462 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.069 seconds
[0m04:31:17.379660 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: ROLLBACK
[0m04:31:17.380521 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4: Close
[0m04:31:17.381509 [info ] [Thread-1 (]: 67 of 73 PASS not_null_int_step_month_matrix_kpi_name .......................... [[32mPASS[0m in 0.10s]
[0m04:31:17.384692 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:17.385655 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:17.386364 [info ] [Thread-1 (]: 68 of 73 START test not_null_int_step_month_matrix_month ....................... [RUN]
[0m04:31:17.387080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4, now test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c)
[0m04:31:17.387641 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:17.393481 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m04:31:17.394272 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:17.396981 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m04:31:17.397777 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m04:31:17.398271 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: BEGIN
[0m04:31:17.398794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.406379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:17.406887 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m04:31:17.407406 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."int_step_month_matrix"
where month is null



  
  
      
    ) dbt_internal_test
[0m04:31:17.477180 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.069 seconds
[0m04:31:17.480300 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: ROLLBACK
[0m04:31:17.481190 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c: Close
[0m04:31:17.482210 [info ] [Thread-1 (]: 68 of 73 PASS not_null_int_step_month_matrix_month ............................. [[32mPASS[0m in 0.10s]
[0m04:31:17.483428 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:17.484666 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:17.485598 [info ] [Thread-1 (]: 69 of 73 START sql table model pipedrive_analytics.rep_sales_funnel_monthly .... [RUN]
[0m04:31:17.486439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m04:31:17.487225 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:17.495884 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.497186 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:17.538313 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.539494 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.540030 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: BEGIN
[0m04:31:17.540536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.548375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:17.548873 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.549404 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

WITH
monthly_data AS (
                    SELECT
                           month,
                           kpi_name,
                           funnel_step,
                           COUNT(DISTINCT deal_id) AS deals_count
                           
                    FROM "postgres"."pipedrive_analytics"."int_sales_funnel"
                    WHERE funnel_anmly_flg = 0
                    GROUP BY 
                             month, 
                             kpi_name, 
                             funnel_step
)

, final AS (
             SELECT
                    ms.month,
                    ms.kpi_name,
                    ms.funnel_step,
                    COALESCE(a.deals_count, 0) AS deals_count

             FROM "postgres"."pipedrive_analytics"."int_step_month_matrix" ms
             LEFT JOIN monthly_data a            ON ms.month = a.month
                                                    AND ms.kpi_name = a.kpi_name
                                                    AND ms.funnel_step = a.funnel_step

                               
           )
SELECT 
        month,
        kpi_name,
        funnel_step,
        deals_count
        
FROM final
  );
  
[0m04:31:17.730188 [debug] [Thread-1 (]: SQL status: SELECT 154 in 0.180 seconds
[0m04:31:17.743736 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.744642 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m04:31:17.746263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:31:17.754344 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.754872 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m04:31:17.755884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:31:17.757822 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m04:31:17.758338 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.758794 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m04:31:17.760554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:31:17.763147 [debug] [Thread-1 (]: Applying DROP to: "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m04:31:17.766612 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:17.767132 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m04:31:17.769308 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:31:17.770761 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m04:31:17.771618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae818a-9062-4a3c-a34e-7631d8b171a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa1418c1550>]}
[0m04:31:17.773014 [info ] [Thread-1 (]: 69 of 73 OK created sql table model pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 154[0m in 0.29s]
[0m04:31:17.774061 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:17.775732 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:17.776512 [info ] [Thread-1 (]: 70 of 73 START test dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name  [RUN]
[0m04:31:17.777555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926)
[0m04:31:17.778035 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:17.783991 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m04:31:17.784870 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:17.787474 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m04:31:17.788285 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m04:31:17.788766 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: BEGIN
[0m04:31:17.789232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.796780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m04:31:17.797294 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m04:31:17.797785 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        month, kpi_name
    from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
    group by month, kpi_name
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m04:31:17.799606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:17.801311 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: ROLLBACK
[0m04:31:17.801977 [debug] [Thread-1 (]: On test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926: Close
[0m04:31:17.802852 [info ] [Thread-1 (]: 70 of 73 PASS dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name  [[32mPASS[0m in 0.03s]
[0m04:31:17.804004 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:17.804770 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:17.805613 [info ] [Thread-1 (]: 71 of 73 START test not_null_rep_sales_funnel_monthly_funnel_step .............. [RUN]
[0m04:31:17.806250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61)
[0m04:31:17.806746 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:17.811991 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m04:31:17.813005 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:17.815932 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m04:31:17.816727 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m04:31:17.817717 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: BEGIN
[0m04:31:17.818484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.829791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m04:31:17.830718 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m04:31:17.831560 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select funnel_step
from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
where funnel_step is null



  
  
      
    ) dbt_internal_test
[0m04:31:17.833047 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:17.835666 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: ROLLBACK
[0m04:31:17.836348 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61: Close
[0m04:31:17.837268 [info ] [Thread-1 (]: 71 of 73 PASS not_null_rep_sales_funnel_monthly_funnel_step .................... [[32mPASS[0m in 0.03s]
[0m04:31:17.838437 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:17.839235 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:17.840002 [info ] [Thread-1 (]: 72 of 73 START test not_null_rep_sales_funnel_monthly_kpi_name ................. [RUN]
[0m04:31:17.840658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0)
[0m04:31:17.841166 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:17.847262 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m04:31:17.848059 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:17.850778 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m04:31:17.851569 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m04:31:17.852033 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: BEGIN
[0m04:31:17.852742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.861823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:31:17.862335 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m04:31:17.862810 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select kpi_name
from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
where kpi_name is null



  
  
      
    ) dbt_internal_test
[0m04:31:17.864198 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:17.865806 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: ROLLBACK
[0m04:31:17.866494 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0: Close
[0m04:31:17.867371 [info ] [Thread-1 (]: 72 of 73 PASS not_null_rep_sales_funnel_monthly_kpi_name ....................... [[32mPASS[0m in 0.03s]
[0m04:31:17.868504 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:17.869275 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:17.869999 [info ] [Thread-1 (]: 73 of 73 START test not_null_rep_sales_funnel_monthly_month .................... [RUN]
[0m04:31:17.870631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b)
[0m04:31:17.871143 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:17.876753 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m04:31:17.877539 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:17.881337 [debug] [Thread-1 (]: Writing runtime sql for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m04:31:17.882367 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m04:31:17.883146 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: BEGIN
[0m04:31:17.883918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:17.891500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:31:17.891984 [debug] [Thread-1 (]: Using postgres connection "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m04:31:17.892470 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "postgres"."pipedrive_analytics"."rep_sales_funnel_monthly"
where month is null



  
  
      
    ) dbt_internal_test
[0m04:31:17.893839 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:31:17.895519 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: ROLLBACK
[0m04:31:17.896182 [debug] [Thread-1 (]: On test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b: Close
[0m04:31:17.897056 [info ] [Thread-1 (]: 73 of 73 PASS not_null_rep_sales_funnel_monthly_month .......................... [[32mPASS[0m in 0.03s]
[0m04:31:17.898079 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:17.900146 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:17.900617 [debug] [MainThread]: On master: BEGIN
[0m04:31:17.901033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:17.909810 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m04:31:17.910328 [debug] [MainThread]: On master: COMMIT
[0m04:31:17.910769 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:17.911193 [debug] [MainThread]: On master: COMMIT
[0m04:31:17.911750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:31:17.912201 [debug] [MainThread]: On master: Close
[0m04:31:17.912961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:17.915412 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m04:31:17.916051 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b' was properly closed.
[0m04:31:17.916883 [info ] [MainThread]: 
[0m04:31:17.917835 [info ] [MainThread]: Finished running 1 seed, 1 table model, 60 data tests, 11 view models in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m04:31:17.929330 [debug] [MainThread]: Command end result
[0m04:31:17.980291 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m04:31:17.983058 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m04:31:17.991806 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m04:31:17.992338 [info ] [MainThread]: 
[0m04:31:17.992939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:17.993500 [info ] [MainThread]: 
[0m04:31:17.994033 [info ] [MainThread]: Done. PASS=73 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=73
[0m04:31:17.995393 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.331471, "process_in_blocks": "24", "process_kernel_time": 0.350283, "process_mem_max_rss": "144776", "process_out_blocks": "5384", "process_user_time": 5.983686}
[0m04:31:17.996030 [debug] [MainThread]: Command `dbt build` succeeded at 04:31:17.995920 after 6.33 seconds
[0m04:31:17.996553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa14172af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa146c5be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa147132cf0>]}
[0m04:31:17.997067 [debug] [MainThread]: Flushing usage events
[0m04:31:18.455957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:31:31.121001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e2dbb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e4f16660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e32ad100>]}


============================== 04:31:31.124631 | f88db288-db60-45ba-b53e-8355463cbc77 ==============================
[0m04:31:31.124631 [info ] [MainThread]: Running with dbt=1.10.0
[0m04:31:31.125508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:31:31.310109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f88db288-db60-45ba-b53e-8355463cbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e397c590>]}
[0m04:31:31.375580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f88db288-db60-45ba-b53e-8355463cbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e3d40f50>]}
[0m04:31:31.376785 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m04:31:31.531324 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m04:31:31.700414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:31.701018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:31.758070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f88db288-db60-45ba-b53e-8355463cbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e2354170>]}
[0m04:31:31.778815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f88db288-db60-45ba-b53e-8355463cbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e0f5cd40>]}
[0m04:31:31.779533 [info ] [MainThread]: Found 1 seed, 12 models, 60 data tests, 6 sources, 550 macros
[0m04:31:31.780146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88db288-db60-45ba-b53e-8355463cbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e1300830>]}
[0m04:31:31.784063 [info ] [MainThread]: 
[0m04:31:31.784676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:31:31.785340 [info ] [MainThread]: 
[0m04:31:31.786077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:31:31.792732 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_pipedrive_analytics'
[0m04:31:31.832572 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m04:31:31.833180 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: BEGIN
[0m04:31:31.833636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:31.843142 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m04:31:31.843655 [debug] [ThreadPool]: Using postgres connection "list_postgres_pipedrive_analytics"
[0m04:31:31.844126 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pipedrive_analytics'
  
[0m04:31:31.847273 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m04:31:31.848991 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: ROLLBACK
[0m04:31:31.849679 [debug] [ThreadPool]: On list_postgres_pipedrive_analytics: Close
[0m04:31:31.857549 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:31.858001 [debug] [MainThread]: On master: BEGIN
[0m04:31:31.858492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:31.868218 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m04:31:31.868885 [debug] [MainThread]: Using postgres connection "master"
[0m04:31:31.869665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m04:31:31.874950 [debug] [MainThread]: SQL status: SELECT 15 in 0.004 seconds
[0m04:31:31.878026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f88db288-db60-45ba-b53e-8355463cbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e2297350>]}
[0m04:31:31.878589 [debug] [MainThread]: On master: ROLLBACK
[0m04:31:31.879196 [debug] [MainThread]: On master: Close
[0m04:31:31.882180 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m04:31:31.882801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m04:31:31.883346 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m04:31:31.893740 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m04:31:31.894571 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m04:31:31.895426 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m04:31:31.895960 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m04:31:31.896636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m04:31:31.897297 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m04:31:31.902169 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m04:31:31.902944 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m04:31:31.903743 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m04:31:31.904262 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m04:31:31.904845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m04:31:31.905490 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m04:31:31.908584 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m04:31:31.909307 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m04:31:31.910059 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m04:31:31.910570 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_fields
[0m04:31:31.911147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_fields)
[0m04:31:31.911752 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_fields
[0m04:31:31.914823 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_fields"
[0m04:31:31.915520 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_fields
[0m04:31:31.916266 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_fields
[0m04:31:31.916833 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m04:31:31.917710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_fields, now model.enpal_assessment_project.stg_stages)
[0m04:31:31.918637 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m04:31:31.922846 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m04:31:31.923654 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m04:31:31.924415 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m04:31:31.924912 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m04:31:31.925474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m04:31:31.926059 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m04:31:31.928982 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m04:31:31.929687 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m04:31:31.930447 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m04:31:31.930940 [debug] [Thread-1 (]: Began running node seed.enpal_assessment_project.funnel_steps
[0m04:31:31.931529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now seed.enpal_assessment_project.funnel_steps)
[0m04:31:31.932116 [debug] [Thread-1 (]: Began compiling node seed.enpal_assessment_project.funnel_steps
[0m04:31:31.934006 [debug] [Thread-1 (]: Began executing node seed.enpal_assessment_project.funnel_steps
[0m04:31:31.934765 [debug] [Thread-1 (]: Finished running node seed.enpal_assessment_project.funnel_steps
[0m04:31:31.935270 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:31.935792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.enpal_assessment_project.funnel_steps, now test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052)
[0m04:31:31.936278 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:31.946981 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052"
[0m04:31:31.947769 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:31.948543 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052
[0m04:31:31.949055 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:31.949589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_done__True__False.40d6610052, now test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5)
[0m04:31:31.950045 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:31.958016 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5"
[0m04:31:31.958766 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:31.959518 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5
[0m04:31:31.960025 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:31.960616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5, now test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df)
[0m04:31:31.961105 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:31.964913 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df"
[0m04:31:31.965629 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:31.966370 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df
[0m04:31:31.966853 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:31.967482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_assigned_to_user.44840c23df, now test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252)
[0m04:31:31.967940 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:31.973255 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252"
[0m04:31:31.974216 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:31.975293 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252
[0m04:31:31.976040 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:31.979306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_deal_id.f78c16f252, now test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1)
[0m04:31:31.980120 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:31.985923 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1"
[0m04:31:31.986664 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:31.987422 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1
[0m04:31:31.987904 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:31.988474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1, now test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989)
[0m04:31:31.988921 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:31.992591 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989"
[0m04:31:31.993300 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:31.994027 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989
[0m04:31:31.994565 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:31.995080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_due_to_dt.fff6cc9989, now test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d)
[0m04:31:31.995556 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:31.999376 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d"
[0m04:31:32.000055 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:32.000798 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d
[0m04:31:32.001326 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:32.001839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d, now test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9)
[0m04:31:32.002333 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:32.008300 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9"
[0m04:31:32.009001 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:32.009755 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9
[0m04:31:32.010262 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_activites
[0m04:31:32.010818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_activity_id.6483ff34a9, now model.enpal_assessment_project.int_activites)
[0m04:31:32.011306 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_activites
[0m04:31:32.014324 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_activites"
[0m04:31:32.015000 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_activites
[0m04:31:32.015746 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_activites
[0m04:31:32.016240 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:32.016768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_activites, now test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a)
[0m04:31:32.017263 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:32.020949 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a"
[0m04:31:32.021656 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:32.022421 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a
[0m04:31:32.022914 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:32.023472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_stg_activity_types_is_active__True__False.23d1f97e3a, now test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169)
[0m04:31:32.023933 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:32.027604 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169"
[0m04:31:32.028316 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:32.029056 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169
[0m04:31:32.029575 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:32.030075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_activity_type_id.10b3776169, now test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f)
[0m04:31:32.030560 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:32.034322 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f"
[0m04:31:32.035007 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:32.035756 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f
[0m04:31:32.036256 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:32.036796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_is_active.53c8125a5f, now test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596)
[0m04:31:32.037282 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:32.041170 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596"
[0m04:31:32.041859 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:32.042612 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596
[0m04:31:32.043112 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:32.043639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_name.174a326596, now test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d)
[0m04:31:32.044108 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:32.049140 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d"
[0m04:31:32.049822 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:32.050558 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d
[0m04:31:32.051041 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:32.051618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_activity_types_type.fafbaa483d, now test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd)
[0m04:31:32.052117 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:32.169687 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd"
[0m04:31:32.170729 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:32.171639 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd
[0m04:31:32.172186 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:32.172779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_activity_types_activity_type_id.065efcc0bd, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6)
[0m04:31:32.173310 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:32.186675 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6"
[0m04:31:32.187649 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:32.188529 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6
[0m04:31:32.189065 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:32.189681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_deal_changes_deal_id__change_dt__changed_field_key__new_value.00e4bec3d6, now test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35)
[0m04:31:32.190169 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:32.194388 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35"
[0m04:31:32.195185 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:32.196013 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35
[0m04:31:32.196516 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:32.197082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_change_dt.55eeffcb35, now test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f)
[0m04:31:32.197681 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:32.201886 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f"
[0m04:31:32.202679 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:32.203450 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f
[0m04:31:32.203969 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:32.204539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f, now test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e)
[0m04:31:32.205011 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:32.209289 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e"
[0m04:31:32.210031 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:32.210832 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e
[0m04:31:32.211327 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:32.211865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e, now test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d)
[0m04:31:32.212358 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:32.222352 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d"
[0m04:31:32.223371 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:32.224928 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d
[0m04:31:32.225721 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:32.226457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_deal_changes_new_value.e8575a546d, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00)
[0m04:31:32.226927 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:32.232070 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00"
[0m04:31:32.232847 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:32.233618 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00
[0m04:31:32.234128 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:32.234688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_stg_fields_field_id__option_id.0d3be68c00, now test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5)
[0m04:31:32.235159 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:32.239010 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5"
[0m04:31:32.239723 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:32.240458 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5
[0m04:31:32.240959 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:32.241535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_id.84b07fccf5, now test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe)
[0m04:31:32.242002 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:32.245953 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe"
[0m04:31:32.246667 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:32.247411 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe
[0m04:31:32.247915 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:32.248480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_key.f981d3affe, now test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd)
[0m04:31:32.248945 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:32.255886 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd"
[0m04:31:32.256929 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:32.257730 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd
[0m04:31:32.258264 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages
[0m04:31:32.258834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_fields_field_name.0230fcaacd, now model.enpal_assessment_project.int_stages)
[0m04:31:32.259323 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages
[0m04:31:32.262996 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages"
[0m04:31:32.263751 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages
[0m04:31:32.264526 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages
[0m04:31:32.265013 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:32.265620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_stages, now test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e)
[0m04:31:32.266314 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:32.270865 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e"
[0m04:31:32.271842 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:32.272938 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e
[0m04:31:32.273760 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:32.274745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_funnel_step.2289d0bc1e, now test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378)
[0m04:31:32.275515 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:32.282366 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378"
[0m04:31:32.283341 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:32.284526 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378
[0m04:31:32.285353 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:32.286175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_id.6a7c0c8378, now test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25)
[0m04:31:32.286904 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:32.293430 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25"
[0m04:31:32.294373 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:32.295548 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25
[0m04:31:32.296314 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:32.297145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_stages_stage_name.d8c326ee25, now test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3)
[0m04:31:32.297908 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:32.304696 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3"
[0m04:31:32.305819 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:32.307135 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3
[0m04:31:32.307922 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:32.308772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_stages_stage_id.7d330989f3, now test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f)
[0m04:31:32.309557 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:32.316353 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f"
[0m04:31:32.317351 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:32.318545 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f
[0m04:31:32.319324 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:32.320082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_email.bc60b2d98f, now test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77)
[0m04:31:32.320932 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:32.327755 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77"
[0m04:31:32.328738 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:32.329902 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77
[0m04:31:32.330687 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:32.331545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_id.980dfc1b77, now test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0)
[0m04:31:32.332314 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:32.338989 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0"
[0m04:31:32.340013 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:32.341210 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0
[0m04:31:32.342005 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:32.342850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_modified_at.e683c009f0, now test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53)
[0m04:31:32.343628 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:32.350014 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53"
[0m04:31:32.350973 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:32.352155 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53
[0m04:31:32.352941 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:32.353779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_stg_users_user_name.226879cc53, now test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b)
[0m04:31:32.354534 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:32.363611 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b"
[0m04:31:32.364580 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:32.365742 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b
[0m04:31:32.366595 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_stages_anmly
[0m04:31:32.367418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.unique_stg_users_user_id.c2ff477e6b, now model.enpal_assessment_project.int_stages_anmly)
[0m04:31:32.368181 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_stages_anmly
[0m04:31:32.373196 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_stages_anmly"
[0m04:31:32.374192 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_stages_anmly
[0m04:31:32.375377 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_stages_anmly
[0m04:31:32.376185 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:32.377346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_stages_anmly, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec)
[0m04:31:32.378123 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:32.383287 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec"
[0m04:31:32.383990 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:32.384760 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec
[0m04:31:32.385263 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:32.385777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_stages_deal_id__change_dt__stage_id.efa6a65bec, now test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e)
[0m04:31:32.386280 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:32.389938 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e"
[0m04:31:32.390647 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:32.391394 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e
[0m04:31:32.391881 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:32.392416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_change_dt.025ef3e47e, now test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9)
[0m04:31:32.392885 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:32.396583 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9"
[0m04:31:32.397300 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:32.398079 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9
[0m04:31:32.398651 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:32.399181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_deal_id.f2a53c54e9, now test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54)
[0m04:31:32.399638 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:32.403557 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54"
[0m04:31:32.404240 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:32.404996 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54
[0m04:31:32.405498 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:32.406042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_funnel_step.d5134cfb54, now test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9)
[0m04:31:32.406521 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:32.410204 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9"
[0m04:31:32.410862 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:32.411630 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9
[0m04:31:32.412140 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:32.412681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_month.cc8b6580c9, now test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4)
[0m04:31:32.413141 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:32.416821 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4"
[0m04:31:32.417494 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:32.418241 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4
[0m04:31:32.418719 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:32.419230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_stage_id.bcffac9da4, now test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5)
[0m04:31:32.419690 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:32.423458 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5"
[0m04:31:32.424132 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:32.424876 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5
[0m04:31:32.425392 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_sales_funnel
[0m04:31:32.425927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_stage_name.4ebdc589b5, now model.enpal_assessment_project.int_sales_funnel)
[0m04:31:32.426393 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_sales_funnel
[0m04:31:32.429607 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_sales_funnel"
[0m04:31:32.430292 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_sales_funnel
[0m04:31:32.431026 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_sales_funnel
[0m04:31:32.431547 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:32.432154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_sales_funnel, now test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb)
[0m04:31:32.434349 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:32.438068 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb"
[0m04:31:32.438756 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:32.439549 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb
[0m04:31:32.440029 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:32.440569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_stages_anmly_anmly_flg__0__1.cdcb29a3eb, now test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b)
[0m04:31:32.441024 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:32.444741 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b"
[0m04:31:32.445438 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:32.446215 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b
[0m04:31:32.446714 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:32.447251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_anmly_anmly_flg.cce7b7755b, now test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916)
[0m04:31:32.447711 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:32.451648 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916"
[0m04:31:32.452335 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:32.453071 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916
[0m04:31:32.453592 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:32.454136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_stages_anmly_rn.2cbe3a3916, now model.enpal_assessment_project.int_step_month_matrix)
[0m04:31:32.454632 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:32.457697 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_step_month_matrix"
[0m04:31:32.458390 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:32.459152 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_step_month_matrix
[0m04:31:32.459652 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:32.460289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_step_month_matrix, now test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61)
[0m04:31:32.460872 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:32.464752 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61"
[0m04:31:32.465465 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:32.466228 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61
[0m04:31:32.466712 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:32.467251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_sales_funnel_funnel_anmly_flg__0__1.73652c5c61, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c)
[0m04:31:32.467743 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:32.476033 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c"
[0m04:31:32.477068 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:32.477864 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c
[0m04:31:32.478403 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:32.478970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_sales_funnel_deal_id__change_dt__kpi_name__funnel_step__user_id.babc93831c, now test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b)
[0m04:31:32.479464 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:32.483288 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b"
[0m04:31:32.483970 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:32.484728 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b
[0m04:31:32.485224 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:32.485736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_change_dt.99fd59ec2b, now test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e)
[0m04:31:32.486218 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:32.489972 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e"
[0m04:31:32.490652 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:32.491421 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e
[0m04:31:32.491909 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:32.492484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_deal_id.d472edf43e, now test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70)
[0m04:31:32.492925 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:32.496807 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70"
[0m04:31:32.497618 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:32.498404 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70
[0m04:31:32.498896 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:32.499463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_funnel_anmly_flg.c5b6ee5a70, now test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738)
[0m04:31:32.499943 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:32.505062 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738"
[0m04:31:32.505750 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:32.506519 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738
[0m04:31:32.507001 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:32.507523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_funnel_step.2221f5d738, now test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e)
[0m04:31:32.507995 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:32.511707 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e"
[0m04:31:32.512398 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:32.513186 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e
[0m04:31:32.513672 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:32.514237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_kpi_name.2caa575b9e, now test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940)
[0m04:31:32.514693 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:32.518443 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940"
[0m04:31:32.519159 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:32.519902 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940
[0m04:31:32.520430 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:32.521023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_month.cdd0f59940, now test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395)
[0m04:31:32.521547 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:32.525528 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395"
[0m04:31:32.526661 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:32.527894 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395
[0m04:31:32.528778 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:32.529732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_sales_funnel_user_id.5246c42395, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m04:31:32.530613 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:32.534469 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m04:31:32.535163 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:32.535911 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m04:31:32.536429 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:32.537037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.rep_sales_funnel_monthly, now test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef)
[0m04:31:32.537670 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:32.547071 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef"
[0m04:31:32.547861 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:32.548668 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef
[0m04:31:32.549196 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:32.549765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.accepted_values_int_step_month_matrix_funnel_step__Step_1__Step_2__Step_2_1__Step_3__Step_3_1__Step_4__Step_5__Step_6__Step_7__Step_8__Step_9.a8925587ef, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586)
[0m04:31:32.550238 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:32.554955 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586"
[0m04:31:32.555658 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:32.556450 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586
[0m04:31:32.556971 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:32.557530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_int_step_month_matrix_month__funnel_step.eeefe82586, now test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f)
[0m04:31:32.557980 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:32.561807 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f"
[0m04:31:32.562499 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:32.563289 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f
[0m04:31:32.563790 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:32.564339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_funnel_step.2934dbc60f, now test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4)
[0m04:31:32.564818 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:32.568614 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4"
[0m04:31:32.569297 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:32.570066 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4
[0m04:31:32.570594 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:32.571138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_kpi_name.18d33a5eb4, now test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c)
[0m04:31:32.571605 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:32.575433 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c"
[0m04:31:32.576112 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:32.576874 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c
[0m04:31:32.577410 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:32.577959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_int_step_month_matrix_month.84be68b73c, now test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926)
[0m04:31:32.578438 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:32.584149 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926"
[0m04:31:32.584830 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:32.585628 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926
[0m04:31:32.586126 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:32.586674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.dbt_utils_unique_combination_of_columns_rep_sales_funnel_monthly_month__kpi_name.7472c7f926, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61)
[0m04:31:32.587142 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:32.590840 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61"
[0m04:31:32.591547 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:32.592356 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61
[0m04:31:32.592862 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:32.593414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_funnel_step.9afb8dfa61, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0)
[0m04:31:32.593867 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:32.597720 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0"
[0m04:31:32.598424 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:32.599237 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0
[0m04:31:32.599743 [debug] [Thread-1 (]: Began running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:32.600280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_kpi_name.8e933976f0, now test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b)
[0m04:31:32.600744 [debug] [Thread-1 (]: Began compiling node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:32.604662 [debug] [Thread-1 (]: Writing injected SQL for node "test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b"
[0m04:31:32.605352 [debug] [Thread-1 (]: Began executing node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:32.606362 [debug] [Thread-1 (]: Finished running node test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b
[0m04:31:32.607621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:32.608061 [debug] [MainThread]: Connection 'test.enpal_assessment_project.not_null_rep_sales_funnel_monthly_month.d7af6eff7b' was properly closed.
[0m04:31:32.616870 [debug] [MainThread]: Command end result
[0m04:31:32.727736 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m04:31:32.740206 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m04:31:32.749733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/dbt_enpal_assessment_mahmoud/target/run_results.json
[0m04:31:32.760401 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m04:31:32.761137 [info ] [MainThread]: Building catalog
[0m04:31:32.776578 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m04:31:32.784630 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m04:31:32.785155 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m04:31:32.785593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:32.793712 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m04:31:32.794211 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m04:31:32.794739 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('stg_activity_types')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('deal_changes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fields')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('stg_activity')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('int_activites')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('funnel_steps')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('stg_fields')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('int_sales_funnel')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('activity_types')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('rep_sales_funnel_monthly')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('stg_stages')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('int_stages_anmly')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('activity')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('int_stages')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('users')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('int_step_month_matrix')) or (upper(sch.nspname) = upper('pipedrive_analytics') and
           upper(tbl.relname) = upper('stg_deal_changes')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m04:31:32.811204 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.016 seconds
[0m04:31:32.818335 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m04:31:32.819105 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m04:31:32.835118 [debug] [MainThread]: Wrote artifact CatalogArtifact to /workspaces/dbt_enpal_assessment_mahmoud/target/catalog.json
[0m04:31:32.876885 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/manifest.json
[0m04:31:32.879589 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/dbt_enpal_assessment_mahmoud/target/semantic_manifest.json
[0m04:31:32.880114 [info ] [MainThread]: Catalog written to /workspaces/dbt_enpal_assessment_mahmoud/target/catalog.json
[0m04:31:32.881589 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.8159784, "process_in_blocks": "3392", "process_kernel_time": 0.27215, "process_mem_max_rss": "140520", "process_out_blocks": "7856", "process_user_time": 4.16899}
[0m04:31:32.882311 [debug] [MainThread]: Command `dbt docs generate` succeeded at 04:31:32.882187 after 1.82 seconds
[0m04:31:32.882772 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m04:31:32.883221 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m04:31:32.883673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e4d20920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e32af230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c9e32ad100>]}
[0m04:31:32.884173 [debug] [MainThread]: Flushing usage events
[0m04:31:33.261972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:32:11.126623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b550982c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b553365c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b55325d430>]}


============================== 04:32:11.130290 | 7ec8a81b-99a5-4dc8-9970-350b99e885c8 ==============================
[0m04:32:11.130290 [info ] [MainThread]: Running with dbt=1.10.0
[0m04:32:11.131216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspaces/dbt_enpal_assessment_mahmoud', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/dbt_enpal_assessment_mahmoud/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m04:32:11.317197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ec8a81b-99a5-4dc8-9970-350b99e885c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b550982fc0>]}
[0m04:32:11.393790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ec8a81b-99a5-4dc8-9970-350b99e885c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b552efc560>]}
[0m04:35:46.184236 [error] [MainThread]: Encountered an error:

[0m04:35:46.260977 [error] [MainThread]: Traceback (most recent call last):
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/codespace/.python/current/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m04:35:46.262843 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 215.19148, "process_in_blocks": "664", "process_kernel_time": 0.18172, "process_mem_max_rss": "123804", "process_out_blocks": "3368", "process_user_time": 2.860598}
[0m04:35:46.264123 [debug] [MainThread]: Command `dbt docs serve` failed at 04:35:46.263920 after 215.19 seconds
[0m04:35:46.264863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b550de1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b54f10e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b54f521010>]}
[0m04:35:46.265403 [debug] [MainThread]: Flushing usage events
[0m04:35:46.647477 [debug] [MainThread]: An error was encountered while trying to flush usage events
